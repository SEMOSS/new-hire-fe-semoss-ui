/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(t){var s,p,w,b,r,u,o,h,c,l,y,a;t.feature("tableSlicer",["core.common","core.sheet_action","floatingObject"]);var i=undefined,f=null,e="normal 11pt calibri",v=function(r){function u(n){r.call(this);this.CONTAINER_NAME="slicer-container";this.HEADER_NAME="slicer-header";this.HEADER_BORDERDIV_NAME="slicer-header-borderDiv";this.CAPTION_NAME="slicer-caption";this.CLEARFILTER_NAME="slicer-clearfilter";this.SPLITLINE_NAME="slicer-splitline";this.BODY_NAME="slicer-body";this.TABLE_NAME="slicer-table";this.TR_NAME="slicer-tr";this.TD1_NAME="slicer-td1";this.TD2_NAME="slicer-td2";this.ITEMSCONTAINER_NAME="slicer-itemscontainer";this.ITEM_NAME="slicer-item";this.SCROLLBAR_NAME="slicer-scrollbar";this.NO_USER_SELECT="no-user-select";var t=this;t._name=n;t._captionName="";t._width=180;t._height=210;t._showHeader=!0;t._sortState=1;t._disableResizingAndMoving=!1;t._showNoDataItems=!0;t._showNoDataItemsInLast=!0;t._visuallyNoDataItems=!0;t._isLocked=!0;t._container=null;t._containerPadding=6;t._containerBorderWidth=1;t._fontSize=14;t._zoomFactor=1;t._header=null;t._headerHeight=27;t._headerMarginBottom=5;t._caption=null;t._clearFilter=null;t._clearFilterWidth=28;t._clearFilterHeight=25;t._clearFilterTop=3;t._clearFilterRight=0;t._isFiltered=!1;t._captionTop=3;t._body=null;t._tb=null;t._tr=null;t._td1=null;t._td2=null;t._itemsContainer=null;t._itemsContainerWidth=0;t._itemsContainerHeight=0;t._scrollbar=null;t._tableBorderSpacing=2;t._items=[];t._itemsSet={};t._itemHeight=21;t._itemBorderWidth=1;t._itemVerticalPadding=1;t._itemHorizontalPadding=6;t._columnCount=1;t._itemMargin=2;t._scrollbarWidth=17;t._scrollbarValue=0;t._clearFilterNormalBackColor="white";t._clearFilterHoveredBackColor="#F9E578";t._clearFilterActivedForeColor="red";t._clearFilterNonActivedForeColor="#B0ADB0";t._isMouseDownOnItem=!1;t._isMouseDownOnScrollbar=!1;t._selectingItemIndexes=[];t._filteringItemIndexes=[];t._activeItemIndex=0;t._sortedItems=[];t._unSelectedItemIndexes=[];t._noDataItemIndexes=[];t._style=t.defaultStyle();t._exclusiveDataTexts=[];t._dataTexts=[]}return __extends(u,r),u.prototype.name=function(n){var t=this;return arguments.length===0?t._name:(t._name!==n&&(t._name=n),t)},u.prototype.width=function(n){var t=this;return arguments.length===0?t._width:(n!==t._width&&(t._width=n,t.refresh()),t)},u.prototype.height=function(n){var t=this;return arguments.length===0?t._height:(n!==t._height&&(t._height=n,t.refresh()),t)},u.prototype.captionName=function(n){var t=this;return arguments.length===0?t._captionName:(n!==t._captionName&&(t._captionName=n,t.refresh()),t)},u.prototype.columnCount=function(n){var t=this;return arguments.length===0?t._columnCount:(n>0&&n!==t._columnCount&&(t._columnCount=n,t.refresh()),t)},u.prototype.itemHeight=function(n){var t=this;return arguments.length===0?t._itemHeight:(n>0&&n!==t._itemHeight&&(t._itemHeight=n,t.refresh()),t)},u.prototype.showHeader=function(n){var t=this;return arguments.length===0?t._showHeader:(n!==t._showHeader&&(t._showHeader=n,t.refresh()),t)},u.prototype.sortState=function(n){var t=this;return arguments.length===0?t._sortState:(n!==t._sortState&&(t._sortState=n,t._sortedItems=t.getSortedItems(),t.refresh()),t)},u.prototype.showNoDataItems=function(n){var t=this;return arguments.length===0?t._showNoDataItems:(n!==t._showNoDataItems&&(t._showNoDataItems=n,t._sortedItems=t.getSortedItems(),t.refresh()),t)},u.prototype.showNoDataItemsInLast=function(n){var t=this;return arguments.length===0?t._showNoDataItemsInLast:(n!==t._showNoDataItemsInLast&&(t._showNoDataItemsInLast=n,t._sortedItems=t.getSortedItems(),t.refresh()),t)},u.prototype.visuallyNoDataItems=function(n){var t=this;return arguments.length===0?t._visuallyNoDataItems:(n!==t._visuallyNoDataItems&&(t._visuallyNoDataItems=n,t._sortedItems=t.getSortedItems(),t.refresh()),t)},u.prototype.style=function(n){var t=this;return arguments.length===0?t._style:(n&&t._style!==n&&(t._style=n,t.applyStyle(t._style),t.refresh()),t)},u.prototype.zoomFactor=function(n){var t=this;return arguments.length===0?t._zoomFactor:(n>0&&n!==t._zoomFactor&&(t._zoomFactor=n,t.refresh()),t)},u.prototype.isLocked=function(n){var t=this;return arguments.length===0?t._isLocked:(n!==t._isLocked&&(t._isLocked=n,t.refresh()),t)},u.prototype.disableResizingAndMoving=function(n){var t=this;return arguments.length===0?t._disableResizingAndMoving:(n!==t._disableResizingAndMoving&&(t._disableResizingAndMoving=n,t.refresh()),t)},u.prototype.setData=function(n,t){r.prototype.setData.call(this,n,t)},u.prototype.onDataLoaded=function(){var n=this;n._dataTexts=n.getDataTexts(n.data);n._exclusiveDataTexts=n.getDataTexts(n.exclusiveDatas);n._container=n.createContainer();n._captionName=n.columnName;n.attachEvents();n.onFiltered(null);n.applyStyle(n._style);n.refresh()},u.prototype.getDOMElement=function(){return this._container},u.prototype.getDataTexts=function(n){var u,r,e;if(!n||n.length===0)return[];for(u=[],r=0,e=n.length;r<e;r++)n[r]===i||n[r]===f||n[r]===""?u.push(t.SR.Blank):u.push(String(n[r]));return u},u.prototype.createContainer=function(){var n=this,i=document.createElement("div"),r,u;return t.GC$(i).css({position:"absolute",padding:6*n._zoomFactor,"box-sizing":"content-box",overflow:"hidden"}).addClass(n.CONTAINER_NAME),n.adjustContainerSize(),r=n.createHeader(),u=n.createBody(),t.GC$(i).append(r).append(u),i},u.prototype.createHeader=function(){var n=this,i=document.createElement("div"),r=document.createElement("div"),u,f;return t.GC$(i).css({width:"auto",position:"absolute",top:0,left:0,right:0,"box-sizing":"content-box",overflow:"hidden"}).addClass(n.HEADER_NAME),t.GC$(r).css({width:"auto",position:"absolute",left:n._containerPadding*n._zoomFactor,right:n._containerPadding*n._zoomFactor,"box-sizing":"content-box",overflow:"hidden"}).addClass(n.HEADER_BORDERDIV_NAME),n._header=i,n._headerBorderDiv=r,t.GC$(i).append(r),u=document.createElement("span"),t.GC$(u).css({"box-sizing":"content-box",position:"absolute",top:n._captionTop*n.getHeaderFontFactor()*n._zoomFactor,overflow:"hidden",width:n.getCaptionWidth()*n._zoomFactor,"text-overflow":"ellipsis","white-space":"nowrap"}).text(n._captionName).attr("unselectable","on").addClass(n.CAPTION_NAME+" "+n.NO_USER_SELECT),n._caption=u,f=document.createElement("div"),t.GC$(f).css({width:n._clearFilterWidth*n._zoomFactor,height:n._clearFilterHeight*n._zoomFactor,cursor:"default",position:"absolute",top:n._clearFilterTop*n.getHeaderFontFactor()*n._zoomFactor,right:n._clearFilterRight*n._zoomFactor,"text-align":"center","box-sizing":"content-box","font-weight":"normal","border-radius":2,overflow:"hidden","font-size":n._fontSize*n._zoomFactor+"px"}).attr("title","Clear Filter (Alt+C)").attr("unselectable","on").text("\u2717").addClass(n.CLEARFILTER_NAME+" "+n.NO_USER_SELECT),n._clearFilter=f,n.adjustHeaderSize(),t.GC$(r).append(u).append(f),i},u.prototype.createBody=function(){var n=this,e=document.createElement("div"),i,r,u,f,s,o;return t.GC$(e).css({width:"auto",height:"auto",overflow:"hidden","margin-top":(n._headerHeight-n._containerPadding+n._headerMarginBottom)*n.getHeaderFontFactor()*n._zoomFactor,"box-sizing":"content-box"}).attr("unselectable","on").addClass(n.BODY_NAME+" "+n.NO_USER_SELECT),n._body=e,i=document.createElement("table"),t.GC$(i).css("box-sizing","content-box").css("border-spacing","0px").attr("unselectable","on").addClass(n.TABLE_NAME+" "+n.NO_USER_SELECT),n._tb=i,r=document.createElement("tr"),t.GC$(r).css("box-sizing","content-box").addClass(n.TR_NAME),n._tr=r,u=document.createElement("td"),t.GC$(u).css({padding:0,"box-sizing":"content-box"}).addClass(n.TD1_NAME),n._td1=u,f=document.createElement("td"),t.GC$(f).css({padding:0,"box-sizing":"content-box",cursor:"default"}).addClass(n.TD2_NAME),n._td2=f,s=n.createItemsContainer(),t.GC$(u).append(s),o=n.createScrollbar(),t.GC$(f).append(o),n._scrollbar=o,t.GC$(r).append(u).append(f),t.GC$(i).append(r),t.GC$(e).append(i),e},u.prototype.createItemsContainer=function(){var n=this,u=document.createElement("div"),e,o,i,h,r,s,f;if(n._itemsContainer=u,e=n.getItemsContainerHeight(),n._itemsContainerHeight=e,o=n.getItemsContainerWidth(),n._itemsContainerWidth=o,t.GC$(u).css({width:o*n._zoomFactor,height:e*n._zoomFactor,"font-size":n._fontSize*n._zoomFactor+"px"}).attr("unselectable","on").addClass(n.ITEMSCONTAINER_NAME+" "+n.NO_USER_SELECT),i=n.getSortedItems(),n._sortedItems=i,i&&i.length!==0){for(h=Math.min(n.getMaxVisibleItemsCount(),i.length),r=0;r<h;r++)s=i[r],f=n.createItem(s,r),t.GC$(u).append(f),n._items.push(f),n._itemsSet[n._exclusiveDataTexts.indexOf(s)]=f;return u}},u.prototype.createItem=function(n,i){var r=this,f=n,u=document.createElement("button");return t.GC$(u).css({"text-align":"left","white-space":"nowrap","margin-bottom":r._itemMargin*r._zoomFactor+"px",cursor:"default","box-sizing":"content-box","border-radius":5,padding:"1px 6px",overflow:"hidden","text-overflow":"ellipsis","background-color":"white"}).attr("type","button").attr("unselectable","on").text(f).addClass(r.ITEM_NAME+" "+r.NO_USER_SELECT),(i+1)%r._columnCount!=0&&t.GC$(u).css("margin-right",r._itemMargin*r._zoomFactor+"px"),r.adjustItemSize(u),u},u.prototype.getHeaderFontFactor=function(){var u=this,i=u._style,n,h,r;if(!i||(n=u.getMergedStyleInfo(i.wholeSlicerStyle,i.headerStyle),!n||!n.font))return 1;var c=n.font,f=1,o=t.StyleHelper.splitFont(t.StyleHelper.normalizeFont(e)).fontSize,s=t.StyleHelper.splitFont(t.StyleHelper.normalizeFont(c)).fontSize;return o&&s&&(h=parseFloat(o),r=parseFloat(s),isNaN(r)||(f=r/h)),f},u.prototype.getCaptionWidth=function(){var n=this,o,t=n._container,i=n._header,r=1,u=1,f=0,e=0;return n._container&&(r=n.stringStyle2Number(t.style.borderLeftWidth),u=n.stringStyle2Number(t.style.borderRightWidth)),n._header&&(f=n.stringStyle2Number(i.style.borderLeftWidth),e=n.stringStyle2Number(i.style.borderRightWidth)),n._width-(r+u)-2*n._containerPadding-(f+e)-n._clearFilterWidth},u.prototype.stringStyle2Number=function(n){return n?parseFloat(n):0},u.prototype.getItemsContainerHeight=function(){var n=this,i=n.getSizeOffset(n._container),t=n.height()-2*n._containerPadding-i.heightOffset;return n._showHeader?t-n._headerHeight*n.getHeaderFontFactor()-n._headerMarginBottom:t},u.prototype.getItemsContainerWidth=function(){var n=this,i=n.getSizeOffset(n._container),t=n.width()-2*n._containerPadding-i.widthOffset-1;return n.needShowScrollbar()?t-n._scrollbarWidth:t},u.prototype.getItemWidth=function(n){var t=this;return(n-(t._columnCount-1)*t._itemMargin)/t._columnCount},u.prototype.getMaxVisibleItemsCount=function(){var n=this;return Math.ceil(n._itemsContainerHeight/(n._itemHeight+2*(n._itemVerticalPadding+n._itemBorderWidth)+n._itemMargin))*n._columnCount},u.prototype.getSortedItems=function(){var i=this,r,e,u,o,n,f;if(!i._exclusiveDataTexts||i._exclusiveDataTexts.length===0)return[];if(r=i.orderBySortState(i._exclusiveDataTexts.slice(0),i._sortState),e=i.slicerData.getFilteredOutIndexes(this.columnName,2),i._showNoDataItems){if(i._visuallyNoDataItems&&i._showNoDataItemsInLast){for(u=[],n=0;n<r.length;n++)f=r[n],t.ArrayHelper.contains(e,i._exclusiveDataTexts.indexOf(f))||u.push(f);for(n=0;n<r.length;n++)f=r[n],t.ArrayHelper.contains(e,i._exclusiveDataTexts.indexOf(f))&&u.push(f);r=u}}else for(u=r.concat(),n=0,o=u.length;n<o;n++)t.ArrayHelper.contains(e,i._exclusiveDataTexts.indexOf(u[n]))&&t.ArrayHelper.remove(r,u[n]);return t.ArrayHelper.contains(r,t.SR.Blank)&&(t.ArrayHelper.remove(r,t.SR.Blank),r.push(t.SR.Blank)),r},u.prototype.orderBySortState=function(t,i){var u=[],f,r;if(i!==0){for(f=n.Slicer.SortHelper.quickSort(t),r=0;r<f.length;r++)u[r]=f[r].value;return i===2&&u.reverse(),u}},u.prototype.createScrollbar=function(){var n=this,r=new t.Scrollbar(!1),i;return n._scrollbarObj=r,i=r.getScrollbar(),t.GC$(i).bind("scroll.gcScrollbar",function(t,i){var r=i.scrollEventType,u=i.scrollOrientation;if(t.data=n,u===1)switch(r){case 0:case 1:case 2:case 3:case 5:n.doScroll(t,i);break;default:break}}),i},u.prototype.needShowScrollbar=function(){var n=this,t=n._noDataItemIndexes,i=n._showNoDataItems?n._exclusiveDataTexts.length:n._exclusiveDataTexts.length-t.length,r=Math.ceil(i/n._columnCount)*(n._itemHeight+2*(n._itemBorderWidth+n._itemVerticalPadding)+n._itemMargin);return r>n._itemsContainerHeight},u.prototype.doScroll=function(n,t){this.scrollTo(n,t)},u.prototype.scrollTo=function(n,t){var i=this,r=t.newValue;r===i._scrollbarValue||r>i._scrollbarObj.maximum()||(i._scrollbarValue=r,i.refreshScrollbar(),i.refreshItems())},u.prototype.getScrollbarObj=function(){return this._scrollbarObj},u.prototype.applyStyle=function(n){var t=this,r,i,u,e,o,s;if(n){n.wholeSlicerStyle&&(t.setStyleInfo(t._container,n.wholeSlicerStyle),t.adjustContainerSize());r=t._headerBorderDiv;i=t.getMergedStyleInfo(n.wholeSlicerStyle,n.headerStyle);t.isDarwingInnerBorder(n)?(u=i.borderBottom,e=u&&u.borderWidth?u.borderWidth:0,r.style.height=(t._headerHeight-e)*t.getHeaderFontFactor()*t._zoomFactor+"px",t.setBorder(r,u,"borderBottom"),i.borderLeft=i.borderTop=i.borderRight=i.borderBottom=f):(r.style.borderBottomWidth="0px",r.style.height=t._header.style.height);t.setStyleInfo(t._header,i);t.adjustHeaderSize();for(o in t._itemsSet)s=parseInt(o),t.refreshItemStyle(s)}},u.prototype.isDarwingInnerBorder=function(n){var r=this,i=n.headerStyle,t;return!i||!(i.borderLeft||i.borderTop||i.borderRight||i.borderBottom)?!0:(t=r.getMergedStyleInfo(n.wholeSlicerStyle,i),t.borderBottom&&t.borderBottom.borderWidth>0&&(!t.borderLeft||t.borderLeft.borderWidth===0)&&(!t.borderTop||t.borderTop.borderWidth===0)&&(!t.borderRight||t.borderRight.borderWidth===0))?!0:!1},u.prototype.setStyleInfo=function(n,i){var u;if(n&&i){var r=this,f=this.getTheme(),o=i.foreColor||"black",s=i.backColor||"white",h=i.font||e,c=i.textDecoration||"";n.style.backgroundColor=r.getNormalizeColor(s,f);n.style.color=r.getNormalizeColor(o,f);n.style.font=t.StyleHelper._scaleFont(h,r._zoomFactor).font;r.setBorder(n,i.borderLeft,"borderLeft");r.setBorder(n,i.borderTop,"borderTop");r.setBorder(n,i.borderRight,"borderRight");r.setBorder(n,i.borderBottom,"borderBottom");u=t.StyleHelper.composeTextDecoration(i.textDecoration);t.StringHelper.Contains(n.className,r.HEADER_NAME)?r._caption.style.textDecoration=u:t.StringHelper.Contains(n.className,r.ITEM_NAME)&&(n.style.textDecoration=u)}},u.prototype.getMergedStyleInfo=function(n,t){var u={},r;if(t)for(r in t)u[r]=t[r];if(n)for(r in n)u[r]===i&&n[r]!==i&&(u[r]=n[r]);return u},u.prototype.setBorder=function(n,t,i){if(n){var r=t&&t.borderWidth?t.borderWidth:0,u=t&&t.borderStyle?t.borderStyle:"",f=t&&t.borderColor?t.borderColor:"";n.style[i+"Width"]=r+"px";n.style[i+"Style"]=u;n.style[i+"Color"]=this.getNormalizeColor(f,this.getTheme())}},u.prototype.getTheme=function(){var n=this.slicerData,t=n.getSheet&&n.getSheet();return t&&t.currentTheme()},u.prototype.getNormalizeColor=function(n,t){if(!t)return n;var r=this,i;return n&&t&&t.getColor&&(i=t.getColor(n)),i},u.prototype.defaultStyle=function(){var i=e,s="bold 11pt calibri",r={borderWidth:1,borderStyle:"solid",borderColor:"#808080"},o={borderWidth:0,borderStyle:"",borderColor:""},n={borderWidth:1,borderStyle:"solid",borderColor:"#999999"},t={borderWidth:1,borderStyle:"solid",borderColor:"#CCCCCC"},u={borderWidth:1,borderStyle:"solid",borderColor:"#E0E0E0"},f={backColor:"#F9E36F",foreColor:"black",font:i,borderLeft:n,borderTop:n,borderRight:n,borderBottom:n};return{wholeSlicerStyle:{backColor:"white",foreColor:"black",font:i,borderLeft:r,borderTop:r,borderRight:r,borderBottom:r},headerStyle:{backColor:"white",foreColor:"black",font:s,borderLeft:o,borderTop:o,borderRight:o,borderBottom:{borderWidth:1,borderStyle:"solid",borderColor:"#A6A6A6"}},selectedItemWithDataStyle:{backColor:"#BFBFBF",foreColor:"black",font:i,borderLeft:n,borderTop:n,borderRight:n,borderBottom:n},selectedItemWithNoDataStyle:{backColor:"#D9D9D9",foreColor:"black",font:i,borderLeft:t,borderTop:t,borderRight:t,borderBottom:t},unSelectedItemWithDataStyle:{backColor:"white",foreColor:"black",font:i,borderLeft:t,borderTop:t,borderRight:t,borderBottom:t},unSelectedItemWithNoDataStyle:{backColor:"white",foreColor:"#959595",font:i,borderLeft:u,borderTop:u,borderRight:u,borderBottom:u},hoveredSelectedItemWithDataStyle:f,hoveredSelectedItemWithNoDataStyle:f,hoveredUnSelectedItemWithDataStyle:f,hoveredUnSelectedItemWithNoDataStyle:f}},u.prototype.onFiltered=function(n){var t=this;t._sortedItems=t.getSortedItems();t._noDataItemIndexes=t.slicerData.getFilteredOutIndexes(t.columnName,2);t._unSelectedItemIndexes=t.slicerData.getFilteredOutIndexes(t.columnName,1);t.refresh()},u.prototype.onDataChanged=function(n){this.reset()},u.prototype.onRowsChanged=function(n,t,i){this.reset()},u.prototype.reset=function(){var n=this;n.data=n.slicerData.getData(n.columnName);n.exclusiveDatas=n.slicerData.getExclusiveData(n.columnName);n._dataTexts=n.getDataTexts(n.data);n._exclusiveDataTexts=n.getDataTexts(n.exclusiveDatas);n._sortedItems=n.getSortedItems();n.refreshScrollbar();n.refreshItems()},u.prototype.onColumnNameChanged=function(n,i){var r=this;r.columnName===n&&r._caption&&(r.columnName=i,r._captionName=i,t.GC$(r._caption).text(i))},u.prototype.onColumnRemoved=function(n){var i=this;n===i.columnName&&(i.slicerData.doUnfilter(n),i.detachEvents(),t.GC$(i._container).remove(),i._container=null)},u.prototype.refresh=function(n){var r=this,f=r._style,u;r._container&&(n!==i&&n!==r._zoomFactor&&(r._zoomFactor=n,r.applyStyle(r._style)),t.GC$(r._container).css({padding:6*r._zoomFactor}),r.adjustContainerSize(),r.refreshHeader(),u=r._showHeader?(r._headerHeight+r._headerMarginBottom-r._containerPadding)*r.getHeaderFontFactor()*r._zoomFactor:0,t.GC$(r._body).css("margin-top",u),r.refreshItemsContainer(),r.refreshScrollbar())},u.prototype.refreshHeader=function(){var n=this,f=n._style,i=n._zoomFactor,r,u;n._showHeader?(n._container.firstChild!==n._header&&(t.GC$(n._header).insertBefore(n._body),t.GC$(n._body).css("margin-top",(n._headerHeight+n._headerMarginBottom)*n.getHeaderFontFactor()*i)),t.GC$(n._header).css("height",n._headerHeight*n.getHeaderFontFactor()*i),t.GC$(n._headerBorderDiv).css({left:n._containerPadding*i,right:n._containerPadding*i}),n._caption.innerHTML!==n._captionName&&t.GC$(n._caption).text(n._captionName),t.GC$(n._caption).css({top:n._captionTop*n.getHeaderFontFactor()*i,width:n.getCaptionWidth()*i,"font-weight":"bold"}),r=n._unSelectedItemIndexes,u=r&&r.length>0?1:0,n.changeClearFilterColor(u),t.GC$(n._clearFilter).css({width:n._clearFilterWidth*i,height:n._clearFilterHeight*i,top:n._clearFilterTop*n.getHeaderFontFactor()*i,right:n._clearFilterRight*i}),n.adjustHeaderSize()):t.GC$(n._header).remove()},u.prototype.refreshItemsContainer=function(){var n=this,r=n.getItemsContainerHeight(),i;n._itemsContainerHeight=r;i=n.getItemsContainerWidth();n._itemsContainerWidth=i;t.GC$(n._itemsContainer).css({width:i*n._zoomFactor,height:r*n._zoomFactor,"font-size":n._fontSize*n._zoomFactor});n.refreshItems()},u.prototype.refreshItems=function(){var n=this,r=n._sortedItems,i,f,u,o;if(r){n._items&&n._items.length>0&&t.GC$(n._items).remove();n._items=[];n._itemsSet={};var s=Math.min(n.getMaxVisibleItemsCount(),r.length),e=n.needShowScrollbar()?n._scrollbarObj.value()*n._columnCount:0,h=Math.min(e+s,r.length);for(i=e;i<h;i++)f=r[i],u=n.createItem(f,i),t.GC$(n._itemsContainer).append(u),n._items.push(u),n._itemsSet[n._exclusiveDataTexts.indexOf(f)]=u;if(n._items.length!==0)for(o in n._itemsSet)n.refreshItemStyle(parseInt(o))}},u.prototype.refreshItemStyle=function(n){var i=this,u=i._hitInfo?this._exclusiveDataTexts.indexOf(i._hitInfo.itemValue):-1,f=i._unSelectedItemIndexes,e=i._noDataItemIndexes,o=i._itemsSet[n],r=0;n===u&&(r|=1);r|=t.ArrayHelper.contains(f,n)?4:2;r|=t.ArrayHelper.contains(e,n)&&i._visuallyNoDataItems?16:8;i.changeItemStyle(o,r)},u.prototype.changeItemStyle=function(n,t){if(n&&this._style){var i=this,r=i._style,u=i.getTheme();switch(t){case 10:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.selectedItemWithDataStyle));break;case 18:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.selectedItemWithNoDataStyle));break;case 12:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.unSelectedItemWithDataStyle));break;case 20:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.unSelectedItemWithNoDataStyle));break;case 11:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.hoveredSelectedItemWithDataStyle));break;case 19:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.hoveredSelectedItemWithNoDataStyle));break;case 13:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.hoveredUnSelectedItemWithDataStyle));break;case 21:i.setStyleInfo(n,i.getMergedStyleInfo(r.wholeSlicerStyle,r.hoveredUnSelectedItemWithNoDataStyle));break}i.adjustItemSize(n)}},u.prototype.adjustContainerSize=function(){var n=this,i=n.getSizeOffset(n._container);t.GC$(n._container).css({width:(n.width()-2*n._containerPadding)*n._zoomFactor-i.widthOffset,height:(n.height()-2*n._containerPadding)*n._zoomFactor-i.heightOffset})},u.prototype.adjustHeaderSize=function(){var n=this,i=n._zoomFactor,r=n.getSizeOffset(n._header),u=n._headerHeight*n.getHeaderFontFactor()*i-r.heightOffset;t.GC$(n._header).css("height",u);t.GC$(n._clearFilter).css({width:n._clearFilterWidth*i,height:n._clearFilterHeight*i})},u.prototype.adjustItemSize=function(n){var i=this,r=i.getSizeOffset(n);t.GC$(n).css({width:i.getItemWidth(i._itemsContainerWidth)*i._zoomFactor-2*i._itemHorizontalPadding-r.widthOffset,height:i._itemHeight*i._zoomFactor-r.heightOffset})},u.prototype.getSizeOffset=function(n){var s=this,i=0,r=0;if(n){var t=n.style,u=t.borderLeftWidth,f=t.borderTopWidth,e=t.borderRightWidth,o=t.borderBottomWidth;u&&(i+=parseFloat(u));f&&(r+=parseFloat(f));e&&(i+=parseFloat(e));o&&(r+=parseFloat(o))}return{widthOffset:i,heightOffset:r}},u.prototype.refreshScrollbar=function(){var n=this,r,i;n.needShowScrollbar()?(n._scrollbar||(n._scrollbar=n.createScrollbar()),n._td2.firstChild!==n._scrollbar&&(t.GC$(n._td2).append(n._scrollbar),n.refreshItemsContainer()),r=Math.floor(n._itemsContainerHeight/(n._itemHeight+2*n._itemVerticalPadding+n._itemMargin)),i=n._scrollbarObj,i.value(n._scrollbarValue),i.width(n._scrollbarWidth*n._zoomFactor),i.height(n._itemsContainerHeight*n._zoomFactor),i.minimum(0),i.maximum(Math.ceil(n._exclusiveDataTexts.length/n._columnCount)-r),i.pageValue(r),i.smallChange(1),i.largeChange(r-1),i.refreshLayout()):(n._td2.firstChild===n._scrollbar&&(n._scrollbar.parentElement&&n._scrollbar.parentElement.removeChild(n._scrollbar),n.refreshItemsContainer()),n._scrollbarValue=0)},u.prototype.attachEvents=function(){var n=this,r=t.GC$(n._container),i=".slicer";r&&(r.bind("mousedown"+i,function(t){n.doMouseDown(t)}).bind("mouseup"+i,function(t){n.doMouseUp(t)}).bind("mousemove"+i,function(t){n.doMouseMove(t)}).bind("mouseleave"+i,function(t){n.doMouseLeave(t)}),n._container.addEventListener("mousewheel",function(t){n.doMouseWheel(t)},!1),n._container.addEventListener("DOMMouseScroll",function(t){n.doMouseWheel(t)},!1),t.GC$(document).bind("mouseup"+i,function(t){n.doDocumentMouseUp(t)}).bind("keydown"+i,function(t){n.doKeyDown(t)}).bind("keyup"+i,function(t){n.doKeyUp(t)}),document.addEventListener("mousewheel",function(t){n.doMouseWheel(t)},!1),document.addEventListener("DOMMouseScroll",function(t){n.doMouseWheel(t)},!1))},u.prototype.detachEvents=function(){var i=this,n=i._container,r=".slicer";n&&t.GC$(n).unbind(r)},u.prototype.doMouseDown=function(n){var t=this,i=t.hitTest(n);i&&(i.mark===8&&(t._isMouseDownOnScrollbar=!0),i.mark===5&&(t._filteringItemIndexes=[],t._isMouseDownOnItem=!0,n.ctrlKey?t.mouseDownOnItemWithCtrl(i):n.shiftKey?t.mouseDownOnItemWithShift(i):t.mouseDownOnItemWithoutKeyDown(i)),t.preRefreshItemsStyle(t._selectingItemIndexes),(i.mark===5||i.mark===6||i.mark===8||i.mark===4&&t._isFiltered)&&n.stopPropagation())},u.prototype.mouseDownOnItemWithCtrl=function(n){var i=this,c=i.slicerData,s=i.exclusiveDatas,h=i._unSelectedItemIndexes,e=i.getExclusiveRowIndex(n.itemValue),u=i._selectingItemIndexes,f,r,o;for(t.ArrayHelper.contains(u,e)?t.ArrayHelper.remove(u,e):u.push(e),r=0,o=s.length;r<o;r++)t.ArrayHelper.contains(h,r)||i._filteringItemIndexes.push(r);for(f=0;f<i._selectingItemIndexes.length;f++)t.ArrayHelper.contains(i._filteringItemIndexes,u[f])?t.ArrayHelper.remove(i._filteringItemIndexes,u[f]):i._filteringItemIndexes.push(u[f]);if(i._filteringItemIndexes.length===0)for(r=0,o=i._exclusiveDataTexts.length;r<o;r++)i._filteringItemIndexes.push(r);i._activeItemIndex=e},u.prototype.mouseDownOnItemWithShift=function(n){var t=this,i=t._sortedItems,f=t._exclusiveDataTexts[t._activeItemIndex],e,o,u,r;for(t.clearItemsStyle(),e=Math.min(i.indexOf(f),i.indexOf(n.itemValue)),o=Math.max(i.indexOf(f),i.indexOf(n.itemValue)),u=e;u<=o;u++)r=t._exclusiveDataTexts.indexOf(i[u]),t._selectingItemIndexes.indexOf(r)===-1&&t._selectingItemIndexes.push(r),t._filteringItemIndexes.indexOf(r)===-1&&t._filteringItemIndexes.push(r)},u.prototype.mouseDownOnItemWithoutKeyDown=function(n){var t=this,i;t.clearItemsStyle();i=t.getExclusiveRowIndex(n.itemValue);t.refreshItemStyle(i);t._selectingItemIndexes.push(i);t._filteringItemIndexes.push(i);t._activeItemIndex=i},u.prototype.clearItemsStyle=function(){var r=this,n=r._items,f,i,e,u,o;if(n&&n.length!==0)for(f=r._noDataItemIndexes,i=0,e=n.length;i<e;i++)u=n[i],o=this._exclusiveDataTexts.indexOf(n[i].innerHTML),t.ArrayHelper.contains(f,o)?r.changeItemStyle(u,20):r.changeItemStyle(u,12)},u.prototype.getExclusiveRowIndex=function(n){var u=this,i=u._exclusiveDataTexts,t,r;if(!i||i.length===0)return-1;for(t=0,r=i.length;t<r;t++)if(i[t]===n)return t;return-1},u.prototype.doMouseUp=function(n){var t=this,r=t.hitTest(n);if(r){var u=t.slicerData,f=t._selectingItemIndexes,i=!1;r.mark===4?t._isFiltered&&(u.doUnfilter(t.columnName),t.changeClearFilterColor(0),i=!0):f&&f.length>0&&(t._isCtrlKeyDown||t._isShiftKeyDown||(u.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),i=!0));t._isMouseDownOnItem=!1;t._isMouseDownOnScrollbar=!1;i&&(t._selectingItemIndexes=[],t._filteringItemIndexes=[])}},u.prototype.preRefreshItemsStyle=function(n){for(var u,i=this,o=i.slicerData,f=i._unSelectedItemIndexes,e=i._noDataItemIndexes,r=0;r<n.length;r++)u=0,u|=i._isCtrlKeyDown?t.ArrayHelper.contains(f,n[r])?2:4:2,u|=t.ArrayHelper.contains(e,n[r])&&i._visuallyNoDataItems?16:8,i.changeItemStyle(i._itemsSet[n[r]],u)},u.prototype.doDocumentMouseUp=function(n){var t=this,i;t.doMouseUp(n);i=t._hitInfo?new s(t._hitInfo.mark,t._hitInfo.itemValue):f;t._hitInfo=null;t.clearOldHover(i)},u.prototype.changeClearFilterColor=function(n){var i=this;if(i._clearFilter){var u=i._style,f=i.getMergedStyleInfo(u.wholeSlicerStyle,u.headerStyle),r=f&&f.backColor;r||(r="white");i._clearFilterNormalBackColor=r;switch(n){case 0:i._isFiltered=!1;t.GC$(i._clearFilter).css({color:i._clearFilterNonActivedForeColor,"background-color":r});break;case 1:i._isFiltered=!0;t.GC$(i._clearFilter).css({color:i._clearFilterActivedForeColor,"background-color":r});break;case 2:t.GC$(i._clearFilter).css({"background-color":i._clearFilterHoveredBackColor});break}}},u.prototype.doMouseMove=function(n){var i=this,o=i._hitInfo?new s(i._hitInfo.mark,i._hitInfo.itemValue):null,r=i.hitTest(n),h,v,l,u,c,a,e;if(r&&(!o||o.mark!==r.mark||o.mark===5&&o.itemValue!==r.itemValue)){if(!i._isMouseDownOnItem){i._hitInfo=r;i.clearOldHover(o);i.setNewHover(r);return}if(r.mark===5)if(h=i._exclusiveDataTexts.indexOf(r.itemValue),v=i._noDataItemIndexes,t.ArrayHelper.contains(i._filteringItemIndexes,h)){var f=i._sortedItems,p=Math.min(f.indexOf(i._exclusiveDataTexts[i._activeItemIndex]),f.indexOf(r.itemValue)),w=Math.max(f.indexOf(i._exclusiveDataTexts[i._activeItemIndex]),f.indexOf(r.itemValue)),y=[];for(u=0,c=i._filteringItemIndexes.length;u<c;u++)l=i._filteringItemIndexes[u],(f.indexOf(i._exclusiveDataTexts[l])>w||f.indexOf(i._exclusiveDataTexts[l])<p)&&y.push(l);for(u=0,c=y.length;u<c;u++)a=y[u],e=i.getItemElement(i._exclusiveDataTexts[a]),t.ArrayHelper.contains(v,a)?i.changeItemStyle(e,20):i.changeItemStyle(e,12),t.ArrayHelper.remove(i._filteringItemIndexes,a)}else e=i.getItemElement(i._exclusiveDataTexts[h]),t.ArrayHelper.contains(v,h)?i.changeItemStyle(e,18):i.changeItemStyle(e,10),t.ArrayHelper.add(i._filteringItemIndexes,h);i._hitInfo=r}},u.prototype.doMouseLeave=function(n){var t=this,i=t._hitInfo?new s(t._hitInfo.mark,t._hitInfo.itemValue):f;t._hitInfo=f;this.clearOldHover(i)},u.prototype.doMouseWheel=function(n){var t=this.hitTest(n);return t.mark===8?(n.stopPropagation(),!0):!1},u.prototype.clearOldHover=function(n){var i,r;if(n){i=this;switch(n.mark){case 4:if(!i._clearFilter)return;i._isFiltered?i.changeClearFilterColor(1):i.changeClearFilterColor(0);break;case 5:r=i._exclusiveDataTexts.indexOf(n.itemValue);i._selectingItemIndexes&&t.ArrayHelper.contains(i._selectingItemIndexes,r)?i.preRefreshItemsStyle(i._selectingItemIndexes):i.refreshItemStyle(r);break}}},u.prototype.setNewHover=function(n){var t,i;if(n){t=this;switch(n.mark){case 4:if(!t._clearFilter||!t._isFiltered)return;t.changeClearFilterColor(2);break;case 5:i=this._exclusiveDataTexts.indexOf(n.itemValue);t.refreshItemStyle(i);break;case 6:t._itemsContainer.style.cursor="default";break}}},u.prototype.getItemElement=function(n){var f=this,t=f._items,i,u,r;if(!t||t.length===0||n===null)return null;for(i=0,u=t.length;i<u;i++)if(r=t[i],r.innerHTML.toLowerCase()===n.toLowerCase())return r;return null},u.prototype.doKeyDown=function(n){var t=this;n.keyCode!==17||t._isCtrlKeyDown||(t._isCtrlKeyDown=!0);n.keyCode!==16||t._isShiftKeyDown||(t._isShiftKeyDown=!0)},u.prototype.doKeyUp=function(n){var t=this,i=t.slicerData;n.keyCode===17&&t._isCtrlKeyDown&&(t._isCtrlKeyDown=!1);n.keyCode===16&&t._isShiftKeyDown&&(t._isShiftKeyDown=!1);!t._isCtrlKeyDown&&!t._isShiftKeyDown&&t._selectingItemIndexes.length>0&&(i.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),t._selectingItemIndexes=[],t._filteringItemIndexes=[])},u.prototype.hitTest=function(n){var t=this,i=t.getContainerRect(t._container),r=null,l=null,f,e,w,h,c,b;if(!i)return null;var o=n.pageX,u=n.pageY,a=t.getHeaderRect(i),v=t.getClearfilterRect(i),y=t.getBodyRect(i),p=t.getItemsContainerRect(i);if(a&&a.contains(o,u))r=v&&v.contains(o,u)?4:1;else if(y&&y.contains(o,u))if(f=t._items,p&&p.contains(o,u)&&f){for(e=0,w=f.length;e<w;e++)if(h=t.getItemRect(i,e),h&&h.contains(o,u)){r=5;for(c in t._itemsSet)if(t._itemsSet[c]===f[e]){l=t._exclusiveDataTexts[c];break}break}e>=f.length&&(b=t.getItemRect(i,f.length-1),r=u<b.y+t._itemHeight*t._zoomFactor?6:7)}else r=8;else r=0;return new s(r,l)},u.prototype.getContainerRect=function(n){if(!n)return null;var i=n,r=0,u=0,f=i.offsetWidth,e=i.offsetHeight;do r+=i.offsetLeft,u+=i.offsetTop;while(i=i.offsetParent);return new t.Rect(r,u,f,e)},u.prototype.getHeaderRect=function(n){var i=this,u,f,e,o,r;return!n||!i._showHeader?null:(r=i._zoomFactor,u=n.x+i._containerBorderWidth*r,f=n.y+i._containerBorderWidth*r,e=i.width()*r,o=i._headerHeight*i.getHeaderFontFactor()*r,new t.Rect(u,f,e,o))},u.prototype.getClearfilterRect=function(n){var i=this,r,u,f,e,o;return!n||!i._showHeader?null:(i=this,r=i._zoomFactor,u=n.x+n.width-(i._containerBorderWidth+i._containerPadding+i._clearFilterWidth)*r,f=n.y+i._containerBorderWidth+i._captionTop*i.getHeaderFontFactor()*r,e=i._clearFilterWidth,o=i._clearFilterHeight,new t.Rect(u,f,e*r,o*r))},u.prototype.getBodyRect=function(n){var i=this;if(!n)return null;var u,f,e,o,r=i._zoomFactor,s=i._containerBorderWidth+i._containerPadding,h=0,c=i._headerHeight*i.getHeaderFontFactor()+i._headerMarginBottom;return u=n.x+s*r,f=n.y+h*r+(i.showHeader()?c*r:0),e=(i.width()-2*s)*r,o=n.height-2*h*r-(i.showHeader()?c*r:0),new t.Rect(u,f,e,o)},u.prototype.getItemsContainerRect=function(n){var r=this,i=r.getBodyRect(n);return i?r.needShowScrollbar()?new t.Rect(i.x,i.y,i.width-r._scrollbarWidth*r._zoomFactor,i.height):i:null},u.prototype.getItemRect=function(n,i){var r=this,o=r._exclusiveDataTexts,u,s,h,f,e;return!n||o.length===0||i>=o.length?null:(u=r.getItemsContainerRect(n),!u)?null:(f=(u.width-(r._columnCount-2)*r._itemMargin*r._zoomFactor)/r._columnCount,e=r._itemHeight*r._zoomFactor+2*r._itemBorderWidth,s=u.x+i%r._columnCount*(f+r._itemMargin*r._zoomFactor),h=u.y+Math.floor(i/r._columnCount)*(e+r._itemMargin*r._zoomFactor),new t.Rect(s,h,f,e))},u}(n.Slicer.SlicerBase);t.ItemSlicer=v;s=function(){function n(n,t){var i=this;i.mark=n===undefined?null:n;i.itemValue=t===undefined?null:t}return n}();t.SlicerHitInfo=s,function(n){n[n.HOVERED=1]="HOVERED";n[n.SELECTED=2]="SELECTED";n[n.UNSELECTED=4]="UNSELECTED";n[n.HASDATA=8]="HASDATA";n[n.NODATA=16]="NODATA"}(t.SlicerItemState||(t.SlicerItemState={}));p=t.SlicerItemState,function(n){n[n.NORMAL=0]="NORMAL";n[n.ACTIVE=1]="ACTIVE";n[n.HOVERED=2]="HOVERED"}(t.SlicerClearFilterState||(t.SlicerClearFilterState={}));w=t.SlicerClearFilterState,function(n){n[n.CONTAINER=0]="CONTAINER";n[n.H_SPACE=1]="H_SPACE";n[n.H_CAPTION=2]="H_CAPTION";n[n.H_SPLITLINE=3]="H_SPLITLINE";n[n.H_CLEARFILTER=4]="H_CLEARFILTER";n[n.B_ITEM=5]="B_ITEM";n[n.B_ITEMSPACER=6]="B_ITEMSPACER";n[n.B_TAIL=7]="B_TAIL";n[n.B_SCROLLBAR=8]="B_SCROLLBAR"}(t.SlicerHitMark||(t.SlicerHitMark={}));b=t.SlicerHitMark;r=function(){function n(n,t,i,r,u,f,e,o){var s=this;s._backColor=n;s._foreColor=t;s._font=i;s._borderLeft=r;s._borderTop=u;s._borderRight=f;s._borderBottom=e;s._textDecoration=o}return n.prototype.setBorders=function(n){var t=this;t._borderLeft=t._borderTop=t._borderRight=t._borderBottom=n},n.prototype.backColor=function(n){var t=this;return arguments.length===0?t._backColor:(t._backColor=n,t)},n.prototype.foreColor=function(n){var t=this;return arguments.length===0?t._foreColor:(t._foreColor=n,t)},n.prototype.font=function(n){var t=this;return arguments.length===0?t._font:(t._font=n,t)},n.prototype.borderLeft=function(n){var t=this;return arguments.length===0?t._borderLeft:(t._borderLeft=n,t)},n.prototype.borderTop=function(n){var t=this;return arguments.length===0?t._borderTop:(t._borderTop=n,t)},n.prototype.borderRight=function(n){var t=this;return arguments.length===0?t._borderRight:(t._borderRight=n,t)},n.prototype.borderBottom=function(n){var t=this;return arguments.length===0?t._borderBottom:(t._borderBottom=n,t)},n.prototype.textDecoration=function(n){var t=this;return arguments.length===0?t._textDecoration:(t._textDecoration=n,t)},n.prototype.fromJSON=function(n){var r,f,e,o,s;n&&!t.GC$.isEmptyObject(n)&&(r=this,n.backColor!==i&&(r._backColor=n.backColor),n.foreColor!==i&&(r._foreColor=n.foreColor),n.font!==i&&(r._font=n.font),n.borderLeft!==i&&(f=new u,f.fromJSON(n.borderLeft),r._borderLeft=f),n.borderTop!==i&&(e=new u,e.fromJSON(n.borderTop),r._borderTop=e),n.borderRight!==i&&(o=new u,o.fromJSON(n.borderRight),r._borderRight=o),n.borderBottom!==i&&(s=new u,s.fromJSON(n.borderBottom),r._borderBottom=s),n.textDecoration!==i&&(r._textDecoration=n.textDecoration))},n.prototype.toJSON=function(){var n=this,e={backColor:n._backColor,foreColor:n._foreColor,font:t.StyleHelper.normalizeFont(n._font),borderLeft:n._borderLeft&&n._borderLeft.toJSON(),borderTop:n._borderTop&&n._borderTop.toJSON(),borderRight:n._borderRight&&n._borderRight.toJSON(),borderBottom:n._borderBottom&&n._borderBottom.toJSON(),textDecoration:n._textDecoration},o={},u,r;for(u in e)r=e[u],r===i||r===f||typeof r=="object"&&t.GC$.isEmptyObject(r)||(o[u]=r);return o},n}();t.SlicerStyleInfo=r;u=function(){function n(n,t,i){var r=this;r._borderWidth=n;r._borderStyle=t;r._borderColor=i}return n.prototype.borderWidth=function(n){var t=this;return arguments.length===0?t._borderWidth:(typeof n=="number"&&n>0&&n!==t._borderWidth&&(t._borderWidth=n),t)},n.prototype.borderStyle=function(n){var t=this;return arguments.length===0?t._borderStyle:(typeof n=="string"&&n!==t._borderStyle&&(t._borderStyle=n),t)},n.prototype.borderColor=function(n){var t=this;return arguments.length===0?t._borderColor:(typeof n=="string"&&n!==t._borderColor&&(t._borderColor=n),t)},n.prototype.fromJSON=function(n,r){if(n&&!t.GC$.isEmptyObject(n)){var u=this;n.borderWidth!==i&&(u._borderWidth=n.borderWidth);n.borderStyle!==i&&(u._borderStyle=n.borderStyle);n.borderColor!==i&&(u._borderColor=n.borderColor)}},n.prototype.toJSON=function(){var r=this,n={borderWidth:r._borderWidth,borderStyle:r._borderStyle,borderColor:r._borderColor},u={};for(var t in n)n[t]!==i&&n[t]!==f&&(u[t]=n[t]);return u},n}();t.SlicerBorder=u;o=function(){function n(){var n=this;n.name("");n._wholeSlicerStyle=n.createDefaultStyleInfo()}return n.prototype.createDefaultStyleInfo=function(){var t=new u(0,"",""),n=new r("white","black",e);return n.setBorders(t),n},n.prototype.name=function(n){var t=this;return arguments.length===0?this._name:(n!==i&&n!==f&&t._name!==n&&(t._name=n),t)},n.prototype.wholeSlicerStyle=function(n){var t=this;return arguments.length===0?t._wholeSlicerStyle:(n&&t._wholeSlicerStyle!==n&&(t._wholeSlicerStyle=n),t)},n.prototype.headerStyle=function(n){var t=this;return arguments.length===0?t._headerStyle:(n&&t._headerStyle!==n&&(t._headerStyle=n),t)},n.prototype.selectedItemWithDataStyle=function(n){var t=this;return arguments.length===0?t._selectedItemWithDataStyle:(n&&t._selectedItemWithDataStyle!==n&&(t._selectedItemWithDataStyle=n),t)},n.prototype.selectedItemWithNoDataStyle=function(n){var t=this;return arguments.length===0?t._selectedItemWithNoDataStyle:(n&&t._selectedItemWithNoDataStyle!==n&&(t._selectedItemWithNoDataStyle=n),t)},n.prototype.unSelectedItemWithDataStyle=function(n){var t=this;return arguments.length===0?t._unSelectedItemWithDataStyle:(n&&t._unSelectedItemWithDataStyle!==n&&(t._unSelectedItemWithDataStyle=n),t)},n.prototype.unSelectedItemWithNoDataStyle=function(n){var t=this;return arguments.length===0?t._unSelectedItemWithNoDataStyle:(n&&t._unSelectedItemWithNoDataStyle!==n&&(t._unSelectedItemWithNoDataStyle=n),t)},n.prototype.hoveredSelectedItemWithDataStyle=function(n){var t=this;return arguments.length===0?t._hoveredSelectedItemWithDataStyle:(n&&t._hoveredSelectedItemWithDataStyle!==n&&(t._hoveredSelectedItemWithDataStyle=n),t)},n.prototype.hoveredSelectedItemWithNoDataStyle=function(n){var t=this;return arguments.length===0?t._hoveredSelectedItemWithNoDataStyle:(n&&t._hoveredSelectedItemWithNoDataStyle!==n&&(t._hoveredSelectedItemWithNoDataStyle=n),t)},n.prototype.hoveredUnSelectedItemWithDataStyle=function(n){var t=this;return arguments.length===0?t._hoveredUnSelectedItemWithDataStyle:(n&&t._hoveredUnSelectedItemWithDataStyle!==n&&(t._hoveredUnSelectedItemWithDataStyle=n),t)},n.prototype.hoveredUnSelectedItemWithNoDataStyle=function(n){var t=this;return arguments.length===0?t._hoveredUnSelectedItemWithNoDataStyle:(n&&t._hoveredUnSelectedItemWithNoDataStyle!==n&&(t._hoveredUnSelectedItemWithNoDataStyle=n),t)},n.prototype.fromJSON=function(n){var f,o,e,u;if(n&&!t.GC$.isEmptyObject(n)){if(f=this,n.name!==i&&(f._name=n.name,f.isBuildinStyle(f._name))){o=f._name.toLocaleLowerCase().replace("slicerstyle","").replace(" ","");e=h[o]();f.wholeSlicerStyle(e.wholeSlicerStyle());f.headerStyle(e.headerStyle());f.selectedItemWithDataStyle(e.selectedItemWithDataStyle());f.selectedItemWithNoDataStyle(e.selectedItemWithNoDataStyle());f.unSelectedItemWithDataStyle(e.unSelectedItemWithDataStyle());f.unSelectedItemWithNoDataStyle(e.unSelectedItemWithNoDataStyle());f.hoveredSelectedItemWithDataStyle(e.hoveredSelectedItemWithDataStyle());f.hoveredSelectedItemWithNoDataStyle(e.hoveredSelectedItemWithNoDataStyle());f.hoveredUnSelectedItemWithDataStyle(e.hoveredUnSelectedItemWithDataStyle());f.hoveredSelectedItemWithNoDataStyle(e.hoveredSelectedItemWithNoDataStyle());return}n.wholeSlicerStyle!==i&&(u=new r,u.fromJSON(n.wholeSlicerStyle),f._wholeSlicerStyle=u);n.headerStyle!==i&&(u=new r,u.fromJSON(n.headerStyle),f._headerStyle=u);n.selectedItemWithDataStyle!==i&&(u=new r,u.fromJSON(n.selectedItemWithDataStyle),f._selectedItemWithDataStyle=u);n.selectedItemWithNoDataStyle!==i&&(u=new r,u.fromJSON(n.selectedItemWithNoDataStyle),f._selectedItemWithNoDataStyle=u);n.unSelectedItemWithDataStyle!==i&&(u=new r,u.fromJSON(n.unSelectedItemWithDataStyle),f._unSelectedItemWithDataStyle=u);n.unSelectedItemWithNoDataStyle!==i&&(u=new r,u.fromJSON(n.unSelectedItemWithNoDataStyle),f._unSelectedItemWithNoDataStyle=u);n.hoveredSelectedItemWithDataStyle!==i&&(u=new r,u.fromJSON(n.hoveredSelectedItemWithDataStyle),f._hoveredSelectedItemWithDataStyle=u);n.hoveredSelectedItemWithNoDataStyle!==i&&(u=new r,u.fromJSON(n.hoveredSelectedItemWithNoDataStyle),f._hoveredSelectedItemWithNoDataStyle=u);n.hoveredUnSelectedItemWithDataStyle!==i&&(u=new r,u.fromJSON(n.hoveredUnSelectedItemWithDataStyle),f._hoveredUnSelectedItemWithDataStyle=u);n.hoveredUnSelectedItemWithNoDataStyle!==i&&(u=new r,u.fromJSON(n.hoveredUnSelectedItemWithNoDataStyle),f._hoveredUnSelectedItemWithNoDataStyle=u)}},n.prototype.toJSON=function(){var u=this,n,e,r;n=u.isBuildinStyle(u._name)?{name:u._name}:u.toJSONInternal();e={};for(r in n)n[r]===f||n[r]===i||t.GC$.isEmptyObject(n[r])||(e[r]=n[r]);return e},n.prototype.toJSONInternal=function(){var n=this;return{name:n._name,wholeSlicerStyle:n._wholeSlicerStyle?n._wholeSlicerStyle.toJSON():f,headerStyle:n._headerStyle?n._headerStyle.toJSON():f,selectedItemWithDataStyle:n._selectedItemWithDataStyle?n._selectedItemWithDataStyle.toJSON():f,selectedItemWithNoDataStyle:n._selectedItemWithNoDataStyle?n._selectedItemWithNoDataStyle.toJSON():f,unSelectedItemWithDataStyle:n._unSelectedItemWithDataStyle?n._unSelectedItemWithDataStyle.toJSON():f,unSelectedItemWithNoDataStyle:n._unSelectedItemWithNoDataStyle?n._unSelectedItemWithNoDataStyle.toJSON():f,hoveredSelectedItemWithDataStyle:n._hoveredSelectedItemWithDataStyle?n._hoveredSelectedItemWithDataStyle.toJSON():f,hoveredSelectedItemWithNoDataStyle:n._hoveredSelectedItemWithNoDataStyle?n._hoveredSelectedItemWithNoDataStyle.toJSON():f,hoveredUnSelectedItemWithDataStyle:n._hoveredUnSelectedItemWithDataStyle?n._hoveredUnSelectedItemWithDataStyle.toJSON():f,hoveredUnSelectedItemWithNoDataStyle:n._hoveredUnSelectedItemWithNoDataStyle?n._hoveredUnSelectedItemWithNoDataStyle.toJSON():f}},n.prototype.isBuildinStyle=function(n){var i=["SlicerStyleLight1","SlicerStyleLight2","SlicerStyleLight3","SlicerStyleLight4","SlicerStyleLight5","SlicerStyleLight6","SlicerStyleDark1","SlicerStyleDark2","SlicerStyleDark3","SlicerStyleDark4","SlicerStyleDark5","SlicerStyleDark6","SlicerStyleOther1","SlicerStyleOther2"];return t.ArrayHelper.contains(i,n)},n}();t.SlicerStyle=o;h=function(){function n(){}return n.light1=function(){return n.createLightStyle(1)},n.light2=function(){return n.createLightStyle(2)},n.light3=function(){return n.createLightStyle(3)},n.light4=function(){return n.createLightStyle(4)},n.light5=function(){return n.createLightStyle(5)},n.light6=function(){return n.createLightStyle(6)},n.createLightStyle=function(n){var t=new o,a="Accent "+n,p="SlicerStyleLight"+n,f,s,h,c,l,i;t.name(p);f=new r;f.backColor("white");f.font(e);f.setBorders(new u(1,"solid",a));t.wholeSlicerStyle(f);var y=new r,v=new u(0,"",""),w=new u(1,"solid",a);return y.borderLeft(v).borderTop(v).borderRight(v).borderBottom(w),t.headerStyle(y),s=new r,s.foreColor("black"),s.backColor(a+",Lighter 60%"),s.setBorders(new u(1,"solid","#999999")),t.selectedItemWithDataStyle(s),h=new r,h.foreColor("#828282"),h.backColor(a+",Lighter 80%"),h.setBorders(new u(1,"solid","#CCCCCC")),t.selectedItemWithNoDataStyle(h),c=new r,c.foreColor("black"),c.backColor("white"),c.setBorders(new u(1,"solid","#CCCCCC")),t.unSelectedItemWithDataStyle(c),l=new r,l.foreColor("#828282"),l.backColor("white"),l.setBorders(new u(1,"solid","#E0E0E0")),t.unSelectedItemWithNoDataStyle(l),i=new r,i.foreColor("black"),i.backColor("#F9E36F"),i.setBorders(new u(1,"solid","#999999")),t.hoveredSelectedItemWithDataStyle(i),t.hoveredSelectedItemWithNoDataStyle(i),t.hoveredUnSelectedItemWithDataStyle(i),t.hoveredUnSelectedItemWithNoDataStyle(i),t},n.dark1=function(){return n.createDarkStyle(1)},n.dark2=function(){return n.createDarkStyle(2)},n.dark3=function(){return n.createDarkStyle(3)},n.dark4=function(){return n.createDarkStyle(4)},n.dark5=function(){return n.createDarkStyle(5)},n.dark6=function(){return n.createDarkStyle(6)},n.createDarkStyle=function(n){var t=new o,f="Accent "+n,p="SlicerStyleDark"+n,s,h,c,l,a,i;t.name(p);s=new r;s.backColor("white");s.font(e);s.setBorders(new u(1,"solid",f));t.wholeSlicerStyle(s);var y=new r,v=new u(0,"",""),w=new u(1,"solid",f);return y.borderLeft(v).borderTop(v).borderRight(v).borderBottom(w),t.headerStyle(y),h=new r,h.foreColor("white"),h.backColor(f),h.setBorders(new u(1,"solid",f)),t.selectedItemWithDataStyle(h),c=new r,c.foreColor(f+",Darker 25%"),c.backColor(f+",Lighter 60%"),c.setBorders(new u(1,"solid",f+",Lighter 60%")),t.selectedItemWithNoDataStyle(c),l=new r,l.foreColor("black"),l.backColor("#C0C0C0"),l.setBorders(new u(1,"solid","#C0C0C0")),t.unSelectedItemWithDataStyle(l),a=new r,a.foreColor("#959595"),a.backColor("#DFDFDF"),a.setBorders(new u(1,"solid","#DFDFDF")),t.unSelectedItemWithNoDataStyle(a),i=new r,i.foreColor("black"),i.backColor("#F9E36F"),i.setBorders(new u(1,"solid","#999999")),t.hoveredSelectedItemWithDataStyle(i),t.hoveredSelectedItemWithNoDataStyle(i),t.hoveredUnSelectedItemWithDataStyle(i),t.hoveredUnSelectedItemWithNoDataStyle(i),t},n.other1=function(){var n=new o,v="SlicerStyleOther1",i,f,s,h,c,t;n.name(v);i=new r;i.backColor("white");i.font(e);i.setBorders(new u(1,"solid","#808080"));n.wholeSlicerStyle(i);var a=new r,l=new u(0,"",""),y=new u(1,"solid","#A6A6A6");return a.borderLeft(l).borderTop(l).borderRight(l).borderBottom(y),n.headerStyle(a),f=new r,f.foreColor("black"),f.backColor("#BFBFBF"),f.setBorders(new u(1,"solid","#999999")),n.selectedItemWithDataStyle(f),s=new r,s.foreColor("black"),s.backColor("#D9D9D9"),s.setBorders(new u(1,"solid","#CCCCCC")),n.selectedItemWithNoDataStyle(s),h=new r,h.foreColor("black"),h.backColor("white"),h.setBorders(new u(1,"solid","#CCCCCC")),n.unSelectedItemWithDataStyle(h),c=new r,c.foreColor("#959595"),c.backColor("white"),c.setBorders(new u(1,"solid","#E0E0E0")),n.unSelectedItemWithNoDataStyle(c),t=new r,t.foreColor("black"),t.backColor("#F9E36F"),t.setBorders(new u(1,"solid","#999999")),n.hoveredSelectedItemWithDataStyle(t),n.hoveredSelectedItemWithNoDataStyle(t),n.hoveredUnSelectedItemWithDataStyle(t),n.hoveredUnSelectedItemWithNoDataStyle(t),n},n.other2=function(){var n=new o,v="SlicerStyleOther2",i,f,s,h,c,t;n.name(v);i=new r;i.backColor("white");i.font(e);i.setBorders(new u(1,"solid","#4F81BD"));n.wholeSlicerStyle(i);var a=new r,l=new u(0,"",""),y=new u(1,"solid","#4F81BD");return a.borderLeft(l).borderTop(l).borderRight(l).borderBottom(y),n.headerStyle(a),f=new r,f.foreColor("black"),f.backColor("#A9C1E3"),f.setBorders(new u(1,"solid","#999999")),n.selectedItemWithDataStyle(f),s=new r,s.foreColor("#828282"),s.backColor("#D5E2F6"),s.setBorders(new u(1,"solid","#CCCCCC")),n.selectedItemWithNoDataStyle(s),h=new r,h.foreColor("black"),h.backColor("white"),h.setBorders(new u(1,"solid","#CCCCCC")),n.unSelectedItemWithDataStyle(h),c=new r,c.foreColor("#828282"),c.backColor("white"),c.setBorders(new u(1,"solid","#E0E0E0")),n.unSelectedItemWithNoDataStyle(c),t=new r,t.foreColor("black"),t.backColor("#F9E36F"),t.setBorders(new u(1,"solid","#999999")),n.hoveredSelectedItemWithDataStyle(t),n.hoveredSelectedItemWithNoDataStyle(t),n.hoveredUnSelectedItemWithDataStyle(t),n.hoveredUnSelectedItemWithNoDataStyle(t),n},n}();t.SlicerStyles=h;c=function(){function i(t){this._listeners=[];var i=this,r=[],u=[],e=t._getSheet(),f=t.rowFilter();i._sheet=e;i._table=t;i._rowFilter=f;i.setDataSource(r,u);i._generalSlicerData=new n.Slicer.GeneralSlicerData(r,u);i.initFilterInfo();f.filterHandler=function(n){i.onFilteredByTable(n)}}return i.prototype.setDataSource=function(n,t){for(var e,i,s,h=this,f=h._table,o=f._getSheet(),r=f.dataRange(),c=r.row+r.rowCount-1,l=r.col+r.colCount-1,u=r.row;u<=c;u++)for(e=[],n.push(e),i=r.col;i<=l;i++)e.push({value:o.getValue(u,i),text:o.getText(u,i)});for(i=0;i<r.colCount;i++)s=f.getColumnName(i)||"",t.push(s)},i.prototype.initFilterInfo=function(){var t=this,r=t._sheet,u=t._table,e=u.dataRange(),f=u.rowFilter(),i,n;for(r.isPaintSuspended(!0),i=f&&f.filteredColumns||[],n=0;n<i.length;n++)t.onFilteredByTable({column:i[n]});r.isPaintSuspended(!1)},i.prototype.onFilteredByTable=function(n){var c=n.column-this._table.range().col,r=this._table.dataRange(),l=c+r.col,f=this._generalSlicerData.columnNames[c],e=[],a={},o,u,s,v,h,y,i;if(t.ArrayHelper.contains(this._rowFilter.filteredColumns,l)){for(o=[],u=r.row;u<r.row+r.rowCount;u++)if(s=this._rowFilter.filteredInRowsWithColIndexs[u],s)for(i=0;i<s.length;i++)if(s[i]===l){o.push(u);break}for(i=0;i<o.length;i++)v=o[i]-r.row,h=this.getExclusiveRowIndex(f,v),a[h]||(a[h]=!0,e.push(h))}else for(y=this.getExclusiveData(f).length,i=0;i<y;i++)e.push(i);if(!t.ArrayHelper.isEquals(this.getFilteredExclusiveRowIndexesBySelf(f),e)){this._generalSlicerData.doFilter(f,{exclusiveRowIndexes:e});this.onFiltered(this._generalSlicerData.getFilteredRowIndexes(),!1);this._sheet.invalidate()}},i.prototype.getFilteredExclusiveRowIndexesBySelf=function(n){for(var r=this,f=r.getExclusiveData(n),e=r.getFilteredOutIndexes(n,1),u=[],i=0,o=f.length;i<o;i++)t.ArrayHelper.contains(e,i)&&u.push(i);return u},i.prototype.getTable=function(){return this._table},i.prototype.getSheet=function(){return this._sheet},i.prototype.getColumnIndex=function(n){return this._generalSlicerData.getColumnIndex(n)},i.prototype.getGeneralSlicerData=function(){return this._generalSlicerData},i.prototype.getData=function(n,t){return this._generalSlicerData.getData(n,t)},i.prototype.getExclusiveData=function(n){return this._generalSlicerData.getExclusiveData(n)},i.prototype.getRowIndexes=function(n,t){return this._generalSlicerData.getRowIndexes(n,t)},i.prototype.getExclusiveRowIndex=function(n,t){return this._generalSlicerData.getExclusiveRowIndex(n,t)},i.prototype.getFilteredIndexes=function(n){return this._generalSlicerData.getFilteredIndexes(n)},i.prototype.getFilteredRanges=function(n){return this._generalSlicerData.getFilteredRanges(n)},i.prototype.getFilteredOutRanges=function(n){return this._generalSlicerData.getFilteredOutRanges(n)},i.prototype.getFilteredOutIndexes=function(n,t){return this._generalSlicerData.getFilteredOutIndexes(n,t)},i.prototype.attachListener=function(n){this._listeners.push(n)},i.prototype.detachListener=function(n){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===n){this._listeners.splice(t,1);break}},i.prototype.getListeners=function(){return this._listeners},i.prototype.doFilter=function(n,i,r){var u=this,o=u._generalSlicerData,h=o.getColumnIndex(n),d,e,nt,c,tt,a,v,s,y,p,w,it,b,f,rt,k,l;if(!(h<0)&&(i.exclusiveRowIndexes||i.ranges))if(r){o.doFilter(n,i,r);u.onFiltered(o.getFilteredRowIndexes(),!0)}else{if(d=i.exclusiveRowIndexes?u.getExclusiveData(n):u.getData(n),i.exclusiveRowIndexes)e=i.exclusiveRowIndexes;else{e=[];var ft=o.data,g=o.getSortedColumnDataCache(),ut=o.getSorted2DataMapping();for(g[h]||o.sortOneCol(h),nt=g[h],c=0;c<i.ranges.length;c++)for(tt=i.ranges[c],a=o._getStartEndIndex(nt,tt),f=a.start;f<=a.end;f++)e.push(ut[h][f])}for(v=u._sheet.isPaintSuspended(),v||u._sheet.isPaintSuspended(!0),s=u._table.startColumn()+h,y=u._table.dataRange().row,u._rowFilter.removeFilterItemsInternal(s),u._rowFilter._unfilterColumn(s),u._sheet.refreshObjectsAboveSheet(),p=[],f=0;f<e.length;f++)w=new t.TextCondition(0,d[e[f]]),u._rowFilter.addFilterItem(s,w),p.push(w);for(u._generalSlicerData.doFilter(n,i),it=[],b={},u._generalSlicerData.getFilteredExclusiveIndexes(n,it,b),f=0;f<e.length;f++)if(rt=i.exclusiveRowIndexes?e[f]:u.getExclusiveRowIndex(n,e[f]),b[rt])if(u._rowFilter._addFilteredItem(p[f]),i.exclusiveRowIndexes)for(k=u.getRowIndexes(n,e[f]),l=0;l<k.length;l++)u._rowFilter._addFilteredInRowsWithColumnIndex(k[l]+y,s);else u._rowFilter._addFilteredInRowsWithColumnIndex(e[f]+y,s);u._rowFilter._setColumnFilteredState(s,!0);u._rowFilter.onFilter(u._rowFilter.getFilterArgs(0,s));u.onFiltered(u._generalSlicerData.getFilteredRowIndexes(),!1);u._sheet.invalidateLayout();v||u._sheet.isPaintSuspended(!1)}},i.prototype.clearPreview=function(){var n=this,t=n._generalSlicerData;n._generalSlicerData.clearPreview();n.onFiltered(t.getFilteredRowIndexes(),t.inPreview())},i.prototype.onFiltered=function(n,t){for(var r=this,i=0;i<r._listeners.length;i++)if(r._listeners[i].onFiltered)r._listeners[i].onFiltered({rowIndexes:n,isPreview:t})},i.prototype.doUnfilter=function(n){var t=this,u,i,r,f;if(t._generalSlicerData.inPreview()&&t.clearPreview(),u=t._generalSlicerData.getColumnIndex(n),i=t._rowFilter,u!==-1){r=t._table.startColumn()+u;f=t._table.dataRange().row;i.removeFilterItems(r);t._generalSlicerData.doUnfilter(n);i._unfilterColumn(r);i._setColumnFilteredState(r,!1);i.onFilter(i.getFilterArgs(0,r));t.onFiltered(t._generalSlicerData.getFilteredRowIndexes(),!1);t._sheet.invalidateLayout();t._sheet.repaint()}},i.prototype.refresh=function(){var n=this,r=[],u=[],t,f,i;for(n.setDataSource(r,u),n._generalSlicerData.setDataSource(r,u),t=0,f=n._listeners.length;t<f;t++)i=n._listeners[t],i.reset&&i.reset()},i.prototype.onDataChanged=function(t,i,r){var e=this._generalSlicerData,o,s,f,u,h;if(e)for(o=[new n.Slicer.SlicerDataItem(e.columnNames[i],t,r.text)],e.changeData(o),s=this,f=s._listeners||[],u=0,h=f.length;u<h;u++)if(f[u].onDataChanged)f[u].onDataChanged(o)},i.prototype.onColumnNameChanged=function(n,t){var i=this,o,r,f,e,u,s;if(i._generalSlicerData){if(i._generalSlicerData.changeColumnName(n,t),o=i._sheet,r=o._slicerCollection.getSlicers(i._table.tableName(),n),r&&r.length>0)for(f=0;f<r.length;f++)r[f].columnName(t);for(e=i._listeners||[],u=0,s=e.length;u<s;u++)if(e[u].onColumnNameChanged)e[u].onColumnNameChanged(n,t)}},i.prototype.onRowsAdded=function(n,t){var u=this,c=u._sheet,a=u._table,f=a.dataRange(),e=u._generalSlicerData,s,h,r,o,i,l;for(e&&e.addRows(n,t),s=e.columnNames,h=e.data,i=n;i<n+t;i++)for(r=0;r<s.length;r++)h[i][r]={value:c.getValue(f.row+i,f.col+r),text:c.getText(f.row+i,f.col+r)};for(u._generalSlicerData.setDataSource(h,s),o=u._listeners||[],i=0,l=o.length;i<l;i++)if(o[i].onRowsChanged)o[i].onRowsChanged(n,t,!0)},i.prototype.onRowsDeleted=function(n,t){var u=this._generalSlicerData,f,r,i,e;if(u)for(u.removeRowsCore(n,t,!1),f=this,r=f._listeners||[],i=0,e=r.length;i<e;i++)if(r[i].onRowsChanged)r[i].onRowsChanged(n,t,!1)},i.prototype.onColumnsAdded=function(n,t){var r=this,s=r._sheet,c=r._table,f=c.dataRange(),e,o,u,i,h;if(r._generalSlicerData){for(e=r._generalSlicerData.data,o=r._generalSlicerData.columnNames,i=0;i<e.length;i++)for(u=n;u<n+t;u++)e[i].splice(u,0,{value:s.getValue(f.row+i,f.col+u),text:s.getText(f.row+i,f.col+u)});for(i=n;i<n+t;i++)h=r._table.getColumnName(i)||"",o.splice(i,0,h);r._generalSlicerData.setDataSource(e,o)}},i.prototype.onColumnsDeleted=function(n,t){var u=this,e=u._generalSlicerData,f,i,s,r;if(e){var a=e.data,h=e.columnNames,p=a.concat(),v=h.concat(),o=[];for(i=n;i<n+t;i++)o.push(h[i]);for(u._generalSlicerData.removeColumns(n,t),f=u._listeners||[],i=0;i<o.length;i++)for(r=0;r<f.length;r++)if(f[r].onColumnRemoved)f[r].onColumnRemoved(o[i]);var c=u._sheet,y=u._table,l=c&&c._slicerCollection;for(i=n;i<n+t;i++)for(s=l.getSlicers(y.name(),v[i]),r=0;r<s.length;r++)l.removeSlicer(s[r])}},i.prototype.onTableRemoved=function(n){var t=this,r,u,i;if(n&&n===t._table){t._savedSlicers=[];var e=t._sheet,f=e._slicerCollection,h=t._listeners||[],o=t._generalSlicerData.columnNames,s=n.name();for(r=0;r<o.length;r++)for(u=f.getSlicers(s,o[r]),i=0;i<u.length;i++)t._savedSlicers.push(u[i]),e.removeSlicer(u[i].name());f&&f.removeSlicerData(t);t._listeners=[]}},i.prototype.onTableAdded=function(n){var r=this,u=r._sheet,f=u._slicerCollection,i,t;for(f&&n&&n.hasSlicerData()&&f.addSlicerData(n.getSlicerData()),i=r._savedSlicers||[],t=0;t<i.length;t++)u.addSlicerInternal(i[t])},i}();t.TableSlicerData=c;l=function(i){function r(n){i.call(this,n);this._isSelected=!1}return __extends(r,i),r.prototype.isSelected=function(n){var t=this;return arguments.length===0?t._isSelected:(n!==t._isSelected&&(t._isSelected=n),t)},r.prototype.sheet=function(n){var t=this;return arguments.length===0?t._sheet:(n!==t._sheet&&(t._sheet=n),t)},r.prototype.slicer=function(n){var t=this;return arguments.length===0?t._slicer:(n!==t._slicer&&(t._slicer=n),t)},r.prototype.onDataLoaded=function(){var n=this,t;n.slicerData&&n.slicerData instanceof c&&(t=n.slicerData,n._sheet=t.getSheet(),n._table=t.getTable());i.prototype.onDataLoaded.call(this)},r.prototype.onColumnRemoved=function(n){var t=this,r,i,u;n===t.columnName&&(r=t.slicerData.getFilteredOutIndexes(n,1),r.length!==0&&t.slicerData.doUnfilter(n),i=t._sheet,u=t._table,i&&u&&i._removeFloatingObjectInternal(t.name()))},r.prototype.orderBySortState=function(t,i){var r=this,l=r._sheet,a=r.slicerData.getColumnIndex(r.columnName),v=r._table,h=v.dataRange(),e=[],o,f,c,s,u;if(i!==0){for(o=[],f=0;f<t.length;f++)c=r.slicerData.getRowIndexes(r.columnName,f),o.push(l.getValue(h.row+c[0],h.col+a));for(s=n.Slicer.SortHelper.quickSort(o),u=0;u<s.length;u++)e[u]=t[s[u].index];i===2&&e.reverse()}else return t;return e},r.prototype.doMouseDown=function(n){var t=this,s=t._sheet,f=t._slicer,r,e,u,o;if(f&&s.canEditFloatingObject(f)){if(r=t.hitTest(n),!t.canDoFilter()&&(r.mark===5||r.mark===6||r.mark===8)){n.stopPropagation();return}for(e=f.getTableItemSlicers(),u=0,o=e.length;u<o;u++)i.prototype.doMouseDown.call(e[u],n)}},r.prototype.canDoFilter=function(){var n=this._table,i=this._sheet,t=n&&n.rowFilter();return!i.isProtected||t&&t.canDoFilter()},r.prototype.doMouseUp=function(n){var i=this,f=i._sheet,s=i._slicer,o,a,v,y,u,r,p;if(s&&f.canEditFloatingObject(s)&&i.canDoFilter()&&(o=i.hitTest(n),o)){var e=i.slicerData,c=i._selectingItemIndexes,l=i._filteringItemIndexes,w=e.getExclusiveData(i.columnName),h=!1;for(o.mark!==4&&(o.mark!==5||l.length!==w.length||i._isCtrlKeyDown||i._isShiftKeyDown)?c&&c.length>0&&(i._isCtrlKeyDown||i._isShiftKeyDown||(v=e.getFilteredIndexes(i.columnName),y=l.concat(),f._doCommand(new t.UndoRedo.SlicerDataFilterUndoAction(f,e,i.columnName,v,y)),h=!0)):(a=e.getFilteredIndexes(i.columnName),f._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(f,e,i.columnName,a)),h=!0),u=s.getTableItemSlicers(),r=0,p=u.length;r<p;r++)u[r]._isMouseDownOnItem=!1,u[r]._isMouseDownOnScrollbar=!1,h&&(u[r]._selectingItemIndexes=[],u[r]._filteringItemIndexes=[])}},r.prototype.doMouseMove=function(n){var r=this,o=r._sheet,u=r._slicer,f,t,e;if(u&&!r._isMouseDownOnScrollbar&&o.canEditFloatingObject(u))for(f=u.getTableItemSlicers(),t=0,e=f.length;t<e;t++)i.prototype.doMouseMove.call(f[t],n)},r.prototype.doMouseLeave=function(n){var f=this,o=f._sheet,r=f._slicer,u,t,e;if(r&&o.canEditFloatingObject(r))for(u=r.getTableItemSlicers(),t=0,e=u.length;t<e;t++)i.prototype.doMouseLeave.call(u[t],n)},r.prototype.doScroll=function(n,t){var e=this,s=e._sheet,u=e._slicer,f,r,o;for(u&&s.canEditFloatingObject(u)||(t.newValue=t.oldValue),f=u.getTableItemSlicers(),r=0,o=f.length;r<o;r++)i.prototype.scrollTo.call(f[r],n,t)},r.prototype.doMouseWheel=function(n){var t=this;if(i.prototype.doMouseWheel.call(this,n))return!0;var e=t._sheet,r=e._slicerCollection,u=r&&r.getSelectedSlicers(),f=t.getScrollbarObj();return u&&u.length===1&&t._isSelected&&t.needShowScrollbar()&&f?(f._scrollContainerMousewheel(n),n.stopPropagation(),!0):!1},r.prototype.doKeyUp=function(n){var i=this,r=i.slicerData,u=i._sheet,f,e,o,s;n.keyCode===17&&i._isCtrlKeyDown&&(i._isCtrlKeyDown=!1);n.keyCode===16&&i._isShiftKeyDown&&(i._isShiftKeyDown=!1);!i._isCtrlKeyDown&&!i._isShiftKeyDown&&i._selectingItemIndexes.length>0&&(f=i.slicerData.getExclusiveData(i.columnName).length,i._filteringItemIndexes.length===f?(e=r.getFilteredIndexes(i.columnName),u._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(u,r,i.columnName,e))):(o=r.getFilteredIndexes(i.columnName),s=i._filteringItemIndexes.concat(),u._doCommand(new t.UndoRedo.SlicerDataFilterUndoAction(u,r,i.columnName,o,s))),i._selectingItemIndexes=[],i._filteringItemIndexes=[])},r}(v);t.TableItemSlicer=l;y=function(){function n(n){var t=this;t._sheet=n;t._slicerDatas=[];t._slicerSet={}}return n.prototype.addSlicerData=function(n){var i=this,r,t,u;if(n){for(r=n.getTable(),t=0,u=i._slicerDatas.length;t<u;t++)if(i._slicerDatas[t].getTable()===r)return;i._slicerDatas.push(n)}},n.prototype.removeSlicerData=function(n){t.ArrayHelper.remove(this._slicerDatas,n)},n.prototype.getSlicerData=function(n){var i=this,r,u,t;if(!i._slicerDatas||i._slicerDatas.length===0)return null;for(r=0,u=i._slicerDatas.length;r<u;r++)if(t=i._slicerDatas[r],t&&t.getTable()&&t.getTable().tableName()===n)return t;return f},n.prototype.addSlicer=function(n){var i=this;if(n){if(!i.isSlicerNameValid(n.name()))throw new Error(t.SR.Exp_SlicerNameInvalid);if(i.isSlicerNameExist(n.name()))throw new Error(t.SR.Exp_SlicerNameExist);i._slicerSet[n.name()]=n;i.addSlicerData(n.getSlicerData())}},n.prototype.removeSlicer=function(n){var r=this,f=r._slicerSet,u,i,t;if(n&&f.hasOwnProperty(n.name())){for(u=n.getSlicerData(),i=n.getTableItemSlicers(),t=0;t<i.length;t++)u.detachListener(i[t]);delete r._slicerSet[n.name()]}},n.prototype.getSlicer=function(n){return n===f||n===undefined?null:this._slicerSet[n]},n.prototype.getSlicers=function(n,i){var e=this,f,r,u;if(t.GC$.isEmptyObject(e._slicerSet))return[];if(f=[],r=e._slicerSet,arguments.length===0)for(u in r)f.push(r[u]);else if(arguments.length===1)for(u in r)r[u].getTable().name()===n&&f.push(r[u]);else for(u in r)r[u].getTable().name()===n&&r[u].columnName()===i&&f.push(r[u]);return f},n.prototype.getSlicerSet=function(){return this._slicerSet},n.prototype.updateSlicerSet=function(n,t){var r=this,i=r._slicerSet,u=i[n];delete i[n];i[t]=u},n.prototype.isSlicerNameValid=function(n){return!!n},n.prototype.isSlicerNameExist=function(n){return this.getSlicerSetInSpread().hasOwnProperty(n)},n.prototype.getAutoSlicerName=function(n){var r=this.getSlicerSetInSpread();if(!r.hasOwnProperty(n))return n;for(var t=1,i=" ",u=n.split(i)[0];r.hasOwnProperty(u+i+t);)t++;return u+i+t},n.prototype.getSlicerSetInSpread=function(){var t=this,f={},i=t._sheet&&t._sheet.parent&&t._sheet.parent.sheets,n,r,u;if(i)for(n=0;n<i.length;n++){r=i[n]._slicerCollection.getSlicerSet();for(u in r)f[u]=r[u]}return f},n.prototype.getSelectedSlicers=function(){var n=this,r,u,i;if(!n._slicerSet||t.GC$.isEmptyObject(n._slicerSet))return[];r=[];for(u in n._slicerSet)i=n._slicerSet[u],i&&i.isSelected()&&r.push(i);return r},n.prototype.mouseWheelSelectedSlicer=function(n){var u=this,r=u.getSelectedSlicers(),t,i;if(r.length!==1)return!1;if(t=r[0].getTableItemSlicers(),t&&t.length>0){for(i=0;i<t.length;i++)t[i].doMouseWheel(n);return!0}return!1},n.prototype.toJSON=function(){var n=this,i,r;if(!n._slicerSet||t.GC$.isEmptyObject(n._slicerSet))return f;i=[];for(r in n._slicerSet)i.push(n._slicerSet[r].toJSON());return i.length===0?f:i},n.prototype.fromJSON=function(n,t){var f,i,e,r,u;if(n&&n.length!==0)for(f=this,f._slicerSet={},i=0;i<n.length;i++)if(e=n[i].tableName,r=n[i].columnName,e&&r){var f=this,o=f._sheet,s=o.findTableByName(e);s&&s.getColumnIndexInTable(r)!==-1&&(u=new a(n[i].name,s,r),u.fromJSON(n[i]),o._slicerCollection.addSlicer(u),o.addFloatingObject(u))}},n}();t.SlicerCollection=y;a=function(n){function r(t,i,u){n.call(this,t,r.DEFAULT_X,r.DEFAULT_Y,r.DEFAULT_WIDTH,r.DEFAULT_HEIGHT);var f=this,o,e;f.typeName="Slicer";i&&(o=i._getSheet(),f.owner(o),e=o._slicerCollection.getSlicerData(i.tableName()));e||(e=i.getSlicerData());f._slicerData=e;f._columnName=u;f._tableItemSlicers=[];f._sourceName=f._columnName;f._nameInFormula="Slicer_"+f._columnName;f._captionName=f._columnName;f._columnCount=r.DEFAULT_COLUMN_COUNT;f._itemHeight=r.DEFAULT_ITEM_HEIGHT;f._showHeader=!0;f._sortState=1;f._disableResizingAndMoving=!1;f._showNoDataItems=!0;f._showNoDataItemsInLast=!0;f._visuallyNoDataItems=!0;f._style=h.light1();f.dynamicSize(!1);f.dynamicMove(!1)}return __extends(r,n),r.prototype.name=function(t){var i=this,r;if(arguments.length===0)return n.prototype.name.call(this);else{if(t&&t!==n.prototype.name.call(this)){r=i.name();n.prototype.name.call(this,t);i.onNameChanged(r,t)}return i}},r.prototype.sourceName=function(){return this._sourceName},r.prototype.nameInFormula=function(n){var t=this;if(arguments.length===0)return t._nameInFormula;else{if(t._nameInFormula!==n){t._nameInFormula=n;t.onPropertyChanged("nameInFormula",n)}return t}},r.prototype.captionName=function(n){var t=this;if(arguments.length===0)return t._captionName;else{if(n!==t._captionName){t._captionName=n;t.onPropertyChanged("captionName",n)}return t}},r.prototype.columnCount=function(n){var t=this;if(arguments.length===0)return t._columnCount;else{if(n>0&&n!==t._columnCount){t._columnCount=n;t.onPropertyChanged("columnCount",n)}return t}},r.prototype.itemHeight=function(n){var t=this;if(arguments.length===0)return t._itemHeight;else{if(n!==t._itemHeight){t._itemHeight=n;t.onPropertyChanged("itemHeight",n)}return t}},r.prototype.showHeader=function(n){var t=this;if(arguments.length===0)return t._showHeader;else{if(n!==t._showHeader){t._showHeader=n;t.onPropertyChanged("showHeader",n)}return t}},r.prototype.sortState=function(n){var t=this;if(arguments.length===0)return t._sortState;else{if(n!==t._sortState){t._sortState=n;t.onPropertyChanged("sortState",n)}return t}},r.prototype.disableResizingAndMoving=function(n){var t=this;if(arguments.length===0)return t._disableResizingAndMoving;else{if(n!==t._disableResizingAndMoving){t._disableResizingAndMoving=n;t.allowMove(!n);t.allowResize(!n);t.onPropertyChanged("disableResizingAndMoving",n)}return t}},r.prototype.showNoDataItems=function(n){var t=this;if(arguments.length===0)return t._showNoDataItems;else{if(n!==t._showNoDataItems){t._showNoDataItems=n;t.onPropertyChanged("showNoDataItems",n)}return t}},r.prototype.showNoDataItemsInLast=function(n){var t=this;if(arguments.length===0)return t._showNoDataItemsInLast;else{if(n!==t._showNoDataItemsInLast){t._showNoDataItemsInLast=n;t.onPropertyChanged("showNoDataItemsInLast",n)}return t}},r.prototype.visuallyNoDataItems=function(n){var t=this;if(arguments.length===0)return t._visuallyNoDataItems;else{if(n!==t._visuallyNoDataItems){t._visuallyNoDataItems=n;t.onPropertyChanged("visuallyNoDataItems",n)}return t}},r.prototype.style=function(n){var t=this;if(arguments.length===0)return t._style;else{if(t._style!==n&&n!==null){t._style=n;t.onPropertyChanged("style",n)}return t}},r.prototype.isSelected=function(t){var i=this;if(arguments.length===0)return n.prototype.isSelected.call(this);else{if(t!==n.prototype.isSelected.call(this)){n.prototype.isSelected.call(this,t);i.onPropertyChanged("isSelected",t)}return i}},r.prototype.isVisible=function(){return this.callBaseClassProperty("isVisible",arguments)},r.prototype.Content=function(){return this.callBaseClassProperty("Content",arguments)},r.prototype.startRow=function(){return this.callBaseClassProperty("startRow",arguments)},r.prototype.startRowOffset=function(){return this.callBaseClassProperty("startRowOffset",arguments)},r.prototype.startColumn=function(){return this.callBaseClassProperty("startColumn",arguments)},r.prototype.startColumnOffset=function(){return this.callBaseClassProperty("startColumnOffset",arguments)},r.prototype.endRow=function(){return this.callBaseClassProperty("endRow",arguments)},r.prototype.endRowOffset=function(){return this.callBaseClassProperty("endRowOffset",arguments)},r.prototype.endColumn=function(){return this.callBaseClassProperty("endColumn",arguments)},r.prototype.endColumnOffset=function(){return this.callBaseClassProperty("endColumnOffset",arguments)},r.prototype.callBaseClassProperty=function(n,i){return t.CustomFloatingObject.prototype[n].apply(this,i)},r.prototype.onPropertyChanged=function(n,t){for(var i,f=this,u=f._tableItemSlicers||[],r=0,e=u.length;r<e;r++)u[r][n]&&(n==="style"?u[r][n](t.toJSONInternal()):u[r][n](t));i=f.owner();i&&i.triggerSlicerChanged({sheet:i,sheetName:i?i._name:"",slicer:f,propertyName:n})},r.prototype.onNameChanged=function(n,i){var u=this._slicerData.getSheet(),r=u._slicerCollection;t.ArrayHelper.contains(r.getSlicers(),this)&&r.updateSlicerSet(n,i)},r.prototype.cloneContent=function(){var n=this,i=n.owner(),t=new l(n.name());return t.setData(n._slicerData,n._columnName),t.width(n.width()).height(n.height()).captionName(n._captionName).columnCount(n._columnCount).itemHeight(n._itemHeight).showHeader(n._showHeader).sortState(n._sortState).isLocked(n.isLocked()).disableResizingAndMoving(n._disableResizingAndMoving).showNoDataItems(n._showNoDataItems).showNoDataItemsInLast(n._showNoDataItemsInLast).visuallyNoDataItems(n._visuallyNoDataItems).style(n._style.toJSONInternal()).zoomFactor(i._zoomFactor).isSelected(n.isSelected()).slicer(n),t.sheet()!==i&&t.sheet(i),n._tableItemSlicers.push(t),t.getDOMElement()},r.prototype.refresh=function(n){for(var r=this,i=r._tableItemSlicers||[],t=0,u=i.length;t<u;t++)i[t].refresh(n)},r.prototype.refreshContent=function(){var n=this;n.refresh(n.owner()._zoomFactor)},r.prototype.clone=function(n){var t=this,i;return!t.owner()&&n&&t.owner(n),i=new r(t.name(),t.getTable(),t.columnName()),i.owner(t.owner()),i.fromJSON(t.toJSON(),!1,t._slicerData),i.name(t.name()),i},r.prototype.getSlicerData=function(){return this._slicerData},r.prototype.columnName=function(n){var t=this;return arguments.length===0?t._columnName:(n!==t._columnName&&(t._columnName=n,t._sourceName=n,t._captionName=n),t)},r.prototype.getTable=function(){return this._slicerData.getTable()},r.prototype.getTableItemSlicers=function(){return this._tableItemSlicers||[]},r.prototype.fromJSON=function(u,f,e){var v,y,p,c;if(u&&!t.GC$.isEmptyObject(u||!u.tableName||!u.columnName)){n.prototype.fromJSON.call(this,u);var s=this,l=s.owner(),a=l._slicerCollection,h=e?e:a.getSlicerData(u.tableName);h||(v=l.findTableByName(u.tableName),h=v.getSlicerData(),a.addSlicerData(h));s._slicerData=h;s._columnName=u.columnName;y=u.x!==i?u.x:r.DEFAULT_X;p=u.y!==i?u.y:r.DEFAULT_Y;s.position(new t.Point(y,p));s.width(u.width!==i?u.width:r.DEFAULT_WIDTH);s.height(u.height!==i?u.height:r.DEFAULT_HEIGHT);u.sourceName!==i&&(s._sourceName=u.sourceName);u.nameInFormula!==i&&(s._nameInFormula=u.nameInFormula);u.captionName!==i&&(s._captionName=u.captionName);u.columnCount!==i&&(s._columnCount=u.columnCount);u.itemHeight!==i&&(s._itemHeight=u.itemHeight);u.showHeader!==i&&(s._showHeader=u.showHeader);u.sortState!==i&&(s._sortState=u.sortState);u.disableResizingAndMoving!==i&&(s._disableResizingAndMoving=u.disableResizingAndMoving);u.showNoDataItems!==i&&(s._showNoDataItems=u.showNoDataItems);u.visuallyNoDataItems!==i&&(s._visuallyNoDataItems=u.visuallyNoDataItems);u.showNoDataItemsInLast!==i&&(s._showNoDataItemsInLast=u.showNoDataItemsInLast);u.style!==i&&(c=new o,c.fromJSON(u.style),s._style=c)}},r.prototype.toJSON=function(){var n=this,r={name:n.name(),x:n.position().x,y:n.position().y,width:n.width(),height:n.height(),sourceName:n._sourceName,nameInFormula:n._nameInFormula,captionName:n._captionName,columnCount:n._columnCount,itemHeight:n._itemHeight,showHeader:n._showHeader,sortState:n._sortState,disableResizingAndMoving:n._disableResizingAndMoving,showNoDataItems:n._showNoDataItems,visuallyNoDataItems:n._visuallyNoDataItems,showNoDataItemsInLast:n._showNoDataItemsInLast,style:n._style?n._style.toJSON():f,dynamicMove:n.dynamicMove(),dynamicSize:n.dynamicSize(),isLocked:n.isLocked(),fixedPosition:n.fixedPosition(),tableName:n._slicerData.getTable().tableName(),columnName:n._columnName},u={},t,i;for(t in r)i=r[t],n.isDefaultValue(t,i)||(u[t]=i);return u},r.prototype.isDefaultValue=function(n,t){switch(n){case"x":return t===r.DEFAULT_X;case"y":return t===r.DEFAULT_Y;case"width":return t===r.DEFAULT_WIDTH;case"height":return t===r.DEFAULT_HEIGHT;case"columnCount":return t===r.DEFAULT_COLUMN_COUNT;case"itemHeight":return t===r.DEFAULT_ITEM_HEIGHT;case"sortState":return t===1;case"disableResizingAndMoving":return t===!1;case"showHeader":case"showNoDataItems":case"visuallyNoDataItems":case"showNoDataItemsInLast":case"isLocked":return t===!0;case"style":return t&&t.name==="SlicerStyleLight1";case"dynamicMove":case"dynamicSize":case"fixedPosition":return t===!1;default:return!1}},r.DEFAULT_X=100,r.DEFAULT_Y=100,r.DEFAULT_WIDTH=192,r.DEFAULT_HEIGHT=250,r.DEFAULT_COLUMN_COUNT=1,r.DEFAULT_ITEM_HEIGHT=21,r}(t.CustomFloatingObject);t.Slicer=a})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
