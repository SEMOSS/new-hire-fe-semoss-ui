/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){var a,wt,bt,it,i,u,b,k,d,rt,g,y;n.feature("formatter",["core.common","core.globalize"]);var t=null,f=undefined,o=Math.abs,c=Math.ceil,nt=Math.pow,v=Math.floor,lt=Math.max,at=Math.min,vt=Math.round,yt="\u4e00\u5341",pt="\u5341",r={Empty:"",Format:function(){for(var r,n,f,u=[],i=0;i<arguments.length-0;i++)u[i]=arguments[i+0];if(arguments.length===0)return t;for(r=u[0],n=1;n<arguments.length;n++)f=new RegExp("\\{"+(n-1)+"\\}","gm"),r=r.replace(f,arguments[n]);return r},IsNullOrEmpty:function(n){return!n||n===r.Empty}},tt;(function(n){n[n.None=0]="None";n[n.AllowLeadingWhite=1]="AllowLeadingWhite";n[n.AllowTrailingWhite=2]="AllowTrailingWhite";n[n.AllowInnerWhite=4]="AllowInnerWhite";n[n.AllowWhiteSpaces=7]="AllowWhiteSpaces";n[n.NoCurrentDateDefault=8]="NoCurrentDateDefault";n[n.AdjustToUniversal=16]="AdjustToUniversal";n[n.AssumeLocal=32]="AssumeLocal";n[n.AssumeUniversal=64]="AssumeUniversal";n[n.RoundtripKind=128]="RoundtripKind"})(tt||(tt={}));a={IsDigit:function(n){var t=n.charCodeAt(0);return t>=48&&t<=57},IsWhiteSpace:function(n){var t=n.charCodeAt(0);return t>=9&&t<=13||t===32||t===133||t===160}},function(n){n[n.CustomMode=0]="CustomMode";n[n.StandardDateTimeMode=1]="StandardDateTimeMode";n[n.StandardNumericMode=2]="StandardNumericMode"}(n.FormatMode||(n.FormatMode={}));wt=n.FormatMode,function(n){n[n.General=0]="General";n[n.Number=1]="Number";n[n.DateTime=2]="DateTime";n[n.Text=3]="Text"}(n.NumberFormatType||(n.NumberFormatType={}));bt=n.NumberFormatType,function(n){n[n.Hour=0]="Hour";n[n.Minute=1]="Minute";n[n.Second=2]="Second"}(it||(it={}));i=function(){function i(){}return i.DateTimeFormatInfo=function(){return n._CultureInfo._currentCulture.DateTimeFormat()},i.NumberFormatInfo=function(){return n._CultureInfo._currentCulture.NumberFormat()},i.Filter=function(n,i,r){var s,u,e,o;if(n===f||n===t||n==="")return n;for(s="",u=0,e=0;e<n.length;e++)o=n[e],o===i?u++:o===r?(u--,u<0&&(u=0)):u===0&&(s+=o);return s.toString()},i.TrimSquareBracket=function(t){return!t||t===r.Empty?t:(t[0]===i.LeftSquareBracket&&(t=n.StringHelper.TrimStart(t,i.LeftSquareBracket)),t[t.length-1]===i.RightSquareBracket&&(t=n.StringHelper.TrimEnd(t,i.RightSquareBracket)),t)},i.IsOperator=function(n){return n===i.LessThanSign||n===i.GreaterThanSign||n===i.EqualsThanSign},i.TrimEscape=function(n){for(var r,e=n.length,t=!1,u="",f=0;f<e;f++)r=n.charAt(f),r===i.ReverseSolidusSign?(t=!t,t||(u+=r)):(t=!1,u+=r);return u},i.AddSquareBracket=function(t){if(!t)throw new Error(n.SR.Exp_TokenIsNull);return(t.length===0||t[0]!==i.LeftSquareBracket)&&(t=n.StringHelper.Insert(t,0,i.LeftSquareBracket.toString())),(t.length===0||t[t.length-1]!==i.RightSquareBracket)&&(t=n.StringHelper.Insert(t,t.length,i.RightSquareBracket.toString())),t},i.IsEquals=function(n,t,i){return n||t?n&&t?i?n.toLowerCase()===t.toLowerCase():n===t:!1:!0},i.ReplaceKeyword=function(t,i,u){var f,o,e;if(!t||t===r.Empty||this.IsEquals(i,u,!0))return t;for(f=t,o=0;;)if(e=n.StringHelper.IndexOf(f,i,1),e>-1)f=n.StringHelper.Remove(f,e,i.length),f=n.StringHelper.Insert(f,e,u),o=e+u.length;else break;return f},i.IsDecimal=function(n,t){var r=i.DecimalSeparator;return n.indexOf(r)>-1},i.DoubleQuote='"',i.SingleQuote="'",i.Tab="\t",i.LeftSquareBracket="[",i.RightSquareBracket="]",i.LessThanSign="<",i.GreaterThanSign=">",i.EqualsThanSign="=",i.PlusSign="+",i.HyphenMinus="-",i.UnderLine="_",i.LeftParenthesis="(",i.RightParenthesis=")",i.Dollar="$",i.Comma=";",i.Space=" ",i.SolidusSign="/",i.ReverseSolidusSign="\\",i.Zero="0",i.QuestionMark="?",i.Colon=":",i.Semicolon=";",i.Sharp="#",i.CommercialAt="@",i.NumberSign="#",i.Asterisk="*",i.Exponential1="E+",i.Exponential2="E-",i.DecimalSeparator=".",i.numberGroupSeparator=",",i.percentSymbol="%",i.nanSymbol="NaN",i.FormatSeparator=";",i.negativeSign="-",i.ReplacePlaceholder="@",i.ExponentialSymbol="E",i}();n.DefaultTokens=i;u=function(){function u(i,r,u){this._classNames=["NumberFormatBase","IFormatter","IFormatProviderSupport"];this.numberFormatInfo=t;this.dateTimeFormatInfo=t;this.cultureName="";var f=this;f._initFileds();f.partLocaleID=i;f.partDbNumberFormat=r;f.cultureName=u?u:n._CultureInfo._currentCulture.Name()}return u.prototype._initFileds=function(){var n=this;n.numberStringConverter=t;n.numberFormatInfo=t;n.dateTimeFormatInfo=t;n.partLocaleID=t;n.partDbNumberFormat=t},u.prototype.NumberStringConverter=function(n){return arguments.length===0?this.numberStringConverter?this.numberStringConverter:t:(this.numberStringConverter=n,n)},u.prototype.PartLocaleID=function(){return n.util.asCustomType(this.partLocaleID,"LocaleIDFormatPart")},u.prototype.PartDBNumberFormat=function(){return n.util.asCustomType(this.partDbNumberFormat,"DBNumberFormatPart")},u.prototype.DateTimeFormatInfo=function(n){return arguments.length===0?this.dateTimeFormatInfo:(this.dateTimeFormatInfo=n,n)},u.prototype.NumberFormatInfo=function(n){return arguments.length===0?this.numberFormatInfo:(this.numberFormatInfo=n,n)},u.prototype.CultureName=function(n){var t=this;return arguments.length===0?t.partLocaleID?t.partLocaleID.CultureInfo().Name():t.cultureName:(t.cultureName=n,n)},u.prototype.numberGroupSeparator=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().numberGroupSeparator:i.numberGroupSeparator},u.prototype.PercentSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().percentSymbol:i.percentSymbol},u.prototype.PositiveSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().positiveSign:i.NumberFormatInfo().positiveSign},u.prototype.NegativeSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().negativeSign:i.negativeSign},u.prototype.DecimalSeparator=function(){return i.DecimalSeparator},u.prototype.NaNSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().nanSymbol:i.nanSymbol},u.TrimNotSupportSymbol=function(n,t){var e,o,i,r,f;for(arguments.length===1&&(t=!0),e=!1,o="",i=0;i<n.length;i++)r=n[i],f=!0,r==='"'?e=!e:e||(t||(r==="?"&&(u.IsTransform(n,i)||(f=!1)),r==="/"&&(u.IsTransform(n,i)||(f=!1))),r==="_"?u.IsTransform(n,i)||(f=!1,i++):r==="*"&&(u.IsTransform(n,i)||(f=!1))),f&&(o+=r);return o},u.IsTransform=function(t,i){if(t[i]==="\\")throw new Error(n.SR.Exp_InvalidBackslash);if(i-1>0&&i-1<t.length&&t[i-1]==="\\")if(i-2<0)return!0;else if(i-2>0&&i-2<t.length)return t[i-2]!=="\\";return!1},u.ContainsKeywords=function(n,u,f){var s,e,l,h;if(!n||n===r.Empty)return!1;if(f[n])return!0;var a="",c=!1,v=t,o;for(s=0;s<n.length;s++)e=n[s],e==='"'?c=!c:c||e!==i.UnderLine&&v!==i.UnderLine&&(e!=="E"&&(o=e.charCodeAt(0),o>=65&&o<=90&&(o|=32,e=String.fromCharCode(o))),a+=e),v=e;if(l=a,f[l])return!0;for(h=0;h<u.length;h++)if(l.indexOf(u[h])>=0)return!0;return!1},u.prototype.Format=function(n){return""},u.prototype.Parse=function(n){return t},u.prototype.FormatString=function(){return""},u.prototype.ExcelCompatibleFormatString=function(){return""},u.General="General",u.General_Lower="general",u._keywords=[u.General_Lower],u._keywordsSet={general:!0},u}();b=function(){function r(n){var t=this;t.shortDatePattern="d";t.longDatePattern="D";t.FullDatePatternShortTime="f";t.FullDatePatternLongTime="F";t.GeneralDatePatternLongTimeShortTime="g";t.GeneralDatePatternLongTimeLongTime="G";t.MonthDayPattern1="m";t.MonthDayPattern2="M";t.RoundTripDatePattern1="o";t.RoundTripDatePattern2="O";t.RFC1123Pattern1="r";t.RFC1123Pattern2="R";t.SortableDatePattern="s";t.shortTimePattern="t";t.longTimePattern="T";t.UniversalSortableDatePattern="u";t.UniversalFullDatePattern="U";t.YearMonthPattern1="y";t.YearMonthPattern2="Y";t._classNames=["StandardDateTimeFormatter","IFormatter"];t._formatString=n}return r.prototype.EvaluateFormat=function(n){var t=this;return n===t.shortDatePattern||n===t.longDatePattern||n===t.FullDatePatternShortTime||n===t.FullDatePatternLongTime||n===t.GeneralDatePatternLongTimeShortTime||n===t.GeneralDatePatternLongTimeLongTime||n===t.MonthDayPattern1||n===t.MonthDayPattern2||n===t.RoundTripDatePattern1||n===t.RoundTripDatePattern2||n===t.RFC1123Pattern1||n===t.RFC1123Pattern2||n===t.SortableDatePattern||n===t.shortTimePattern||n===t.longTimePattern||n===t.UniversalSortableDatePattern||n===t.UniversalFullDatePattern||n===t.YearMonthPattern1||n===t.YearMonthPattern2?!0:!1},r.prototype.Format=function(i){try{return i===f||i===t||i===""?"":new n._DateTimeHelper(i).localeFormat(this._formatString)}catch(r){return i.toString()}},r.prototype.Parse=function(i){try{if(!i||i==="")return t;var r=n._DateTimeHelper.parseLocale(i,this._formatString);return r?r:(r=new Date(i),isNaN(r.valueOf())?t:r)}catch(u){return new Date(i)}},r.prototype.FormatString=function(){return this._formatString},r.prototype.ExcelCompatibleFormatString=function(){var t="",u=this,n=i.DateTimeFormatInfo(),r;switch(u.FormatString()){case"D":t=n.longDatePattern;break;case"d":t=n.shortDatePattern;break;case"F":t=n.fullDateTimePattern;break;case"f":t=n.longDatePattern+" "+n.shortTimePattern;break;case"G":t=n.shortDatePattern+" "+n.longTimePattern;break;case"g":t=n.shortDatePattern+" "+n.shortTimePattern;break;case"M":case"m":t=n.monthDayPattern;break;case"R":case"r":t=n.rfc1123Pattern;break;case"s":t=n.sortableDateTimePattern;break;case"T":t=n.longTimePattern;break;case"t":t=n.shortTimePattern;break;case"u":t=n.universalSortableDateTimePattern;break;case"U":t=n.fullDateTimePattern;break;case"Y":case"y":t=n.yearMonthPattern;break}return t?(r=new h(t,null,null,null,null),r.ExcelCompatibleFormatString()):null},r}();n._StandardDateTimeFormatter=b;k=function(){function e(n){var t=this;t.CurrencyPattern1="c";t.CurrencyPattern2="C";t.DecimalPattern1="d";t.DecimalPattern2="D";t.ScientificPattern1="e";t.ScientificPattern2="E";t.FixedPointPattern1="f";t.FixedPointPattern2="F";t.GeneralPattern1="g";t.GeneralPattern2="G";t.NumberPattern1="n";t.NumberPattern2="N";t.PercentPattern1="p";t.PercentPattern2="P";t.RoundTripPattern1="r";t.RoundTripPattern2="R";t.HexadecimalPattern1="x";t.HexadecimalPattern2="X";t._classNames=["StandardNumberFormatter","IFormatter"];t._formatString=n}return e.prototype.EvaluateFormat=function(n){var i=this,t;return n&&n!==r.Empty&&n.length>0&&(t=n.substr(0,1),t===i.CurrencyPattern1||t===i.CurrencyPattern2||t===i.DecimalPattern1||t===i.DecimalPattern2||t===i.ScientificPattern1||t===i.ScientificPattern2||t===i.FixedPointPattern1||t===i.FixedPointPattern2||t===i.GeneralPattern1||t===i.GeneralPattern2||t===i.NumberPattern1||t===i.NumberPattern2||t===i.PercentPattern1||t===i.PercentPattern2||t===i.RoundTripPattern1||t===i.RoundTripPattern2||t===i.HexadecimalPattern1||t===i.HexadecimalPattern2)?!0:!1},e.prototype.Format=function(i){try{return i===t||i===f||i===""?"":new n._NumberHelper(i).localeFormat(this._formatString)}catch(r){return i.toString()}},e.prototype.Parse=function(i){try{return i===t||i===f||i===""?t:n._NumberHelper.parseLocale(i)}catch(u){var r=parseFloat(i);return isNaN(r)||!isFinite(r)?t:r}},e.prototype.FormatString=function(){return this._formatString},e.prototype.GetPrecision=function(){var u=this,t=u.FormatString(),r,i;return t&&t.length>0?(r=n.StringHelper.Remove(t,0,1),i=parseInt(r),!isNaN(i))?i:null:null},e.AddDecimalPrecision=function(n,t,r){var u=n,f;if(r>0)for(u+=i.DecimalSeparator,f=0;f<r;f++)u+=t;return u},e.AddIntegralPrecision=function(n,t,i){var r=n,u,f;if(i>0){for(u="",f=0;f<i;f++)u+=t;r=u+r}return r},e.prototype.ExcelCompatibleFormatString=function(){var o=this,s=o.FormatString(),c,f,h,r,l,a;return s?(c=i.NumberFormatInfo(),r=o.GetPrecision(),n.StringHelper.StartsWith(s,o.CurrencyPattern1,1)?(f=c.currencySymbol+"#,##0",h=r!==t?r:c.currencyDecimalDigits,e.AddDecimalPrecision(f,i.Zero,h)):n.StringHelper.StartsWith(s,o.DecimalPattern1,1)?(f="0",h=r!==t?r:1,e.AddIntegralPrecision(f,i.Zero,h-1)):n.StringHelper.StartsWith(s,o.ScientificPattern1,1)?(f="0",l="E+000",r!==t?(a=e.AddDecimalPrecision(f,i.Zero,r),a+l):"0.########################################E+000"):n.StringHelper.StartsWith(s,o.FixedPointPattern1,1)?(f="0",h=r!==t?r:c.numberDecimalDigits,e.AddDecimalPrecision(f,i.Zero,h)):n.StringHelper.StartsWith(s,o.GeneralPattern1,1)?u.General:n.StringHelper.StartsWith(s,o.NumberPattern1,1)?(f="#,##0",h=r!==t?r:c.numberDecimalDigits,e.AddDecimalPrecision(f,i.Zero,h)):n.StringHelper.StartsWith(s,o.PercentPattern1,1)?(f="0",h=r!==t?r:c.numberDecimalDigits,e.AddDecimalPrecision(f,i.Zero,h)+i.percentSymbol):n.StringHelper.StartsWith(s,o.RoundTripPattern1,1)?u.General:n.StringHelper.StartsWith(s,o.HexadecimalPattern1,1)?u.General:null):null},e}();n._StandardNumberFormatter=k;d=function(r){function e(n,t,f,e){var s=this,o;r.call(this,t,f,e);s._classNames=["NumberFormatText","IFormatter"];o=u.TrimNotSupportSymbol(n,!1);t&&(o=i.ReplaceKeyword(o,s.PartLocaleID().OriginalToken(),s.PartLocaleID().CurrencySymbol()));o=i.Filter(o,i.LeftSquareBracket,i.RightSquareBracket);o=i.TrimEscape(o);s._formatString=o}return __extends(e,r),e.prototype.Format=function(i){try{var r=n.Calc.Convert.S(i),u=n.StringHelper.Replace(this._formatString,'"',"");return u!==t&&u!==f&&(r=n.StringHelper.Replace(u,"@",r)),r}catch(e){return""}},e.prototype.Parse=function(n){return n?n:""},e.prototype.FormatString=function(){return this._formatString},e.EvaluateFormat=function(n){return!0},e.prototype.DefaultDateTimeNumberStringConverter=function(){},e}(u);rt=function(){function n(n){this._innerFormatter=n}return n.prototype.FormatString=function(){return this._innerFormatter?this._innerFormatter.FormatString():""},n.prototype.innerFormatter=function(n){return arguments.length===0?this._innerFormatter:(this._innerFormatter=n,this)},n.prototype.Parse=function(n){return this._innerFormatter?this._innerFormatter.Parse(n):n},n.prototype.Format=function(n){return this._innerFormatter?this._innerFormatter.Format(n):n===f||n===t?"":n.toString()},n.prototype.toJSON=function(){return this._innerFormatter.toJSON()},n.prototype.fromJSON=function(n){this._innerFormatter=new y(n.formatCached,n.formatModeType,n.customerCultureName)},n}();n.AutoFormatter=rt;g=function(){function o(i,r){var f=this;f.conditionFormatPart=t;f.colorFormatPart=t;f.localeIDFormatPart=t;f.dbNumberFormatPart=t;f.numberFormat=t;f.dateTimeFormatInfo=t;f.numberFormatInfo=t;f.formatCached=t;f._classNames=["CustomNumberFormat","IFormatter","IFormatProviderSupport"];r||(r=n._CultureInfo._currentCulture.Name());arguments.length===0?(f.formatCached=u.General,f.numberFormat=new e):f.Init(i,r)}return o.prototype.Init=function(u,o){var c,k,y,nt,p,v,tt;if(u===t||u===f)throw new Error(n.SR.Exp_FormatIllegal);c=this;c.formatCached=u;var a="",l="",b=!1,g=[];for(k=0;k<u.length;k++)if(y=u[k],y===i.LeftSquareBracket){if(b)throw new Error(n.SR.Exp_FormatIllegal);else l&&(a||(a=""),a+=l,l=""),l=y.toString();b=!0}else if(y===i.RightSquareBracket){if(b)if(l){if(l+=y,nt=l.toString(),p=n.util.asCustomType(s.Create(nt),"FormatPartBase"),p&&!n.util.isCustomType(p,"ABSTimeFormatPart"))c.AddPart(p);else if(n.util.isCustomType(p,"ABSTimeFormatPart"))g.push(n.util.asCustomType(p,"ABSTimeFormatPart")),a+=l;else throw new Error(n.SR.Exp_FormatIllegal);l=""}else throw new Error(n.SR.Exp_FormatIllegal);else throw new Error(n.SR.Exp_FormatIllegal);b=!1}else l+=y;if(l)if(b)throw new Error(n.SR.Exp_FormatIllegal);else a+=l;if(c.localeIDFormatPart!==t&&(o=c.localeIDFormatPart.CultureInfo().Name()),v=a?a.toString():r.Empty,e.EvaluateFormat(v))c.numberFormat=new e(v,c.LocaleIDFormatPart(),c.dbNumberFormatPart,o);else if(h.EvaluateFormat(v))tt=g.length>0?g:t,c.numberFormat=new h(v,tt,c.LocaleIDFormatPart(),c.dbNumberFormatPart,o);else if(w.EvaluateFormat(v))c.numberFormat=new w(u,c.LocaleIDFormatPart(),c.dbNumberFormatPart,o);else if(d.EvaluateFormat(v))c.numberFormat=new d(u,c.LocaleIDFormatPart(),c.dbNumberFormatPart,o);else throw new Error(n.SR.Exp_FormatIllegal);},o.prototype.FormatString=function(){var n=this,t="";return n.numberFormat&&n.numberFormat.FormatString()&&(n.ColorFormatPart()&&(t+=n.ColorFormatPart().toString()),n.ConditionFormatPart()&&(t+=n.ConditionFormatPart().toString()),n.DBNumberFormatPart()&&(t+=n.DBNumberFormatPart().toString()),n.LocaleIDFormatPart()&&(t+=n.LocaleIDFormatPart().toString()),t+=n.numberFormat.FormatString()),t.toString()},o.prototype.ConditionFormatPart=function(){return this.conditionFormatPart},o.prototype.ColorFormatPart=function(){return this.colorFormatPart},o.prototype.LocaleIDFormatPart=function(){return this.localeIDFormatPart},o.prototype.DBNumberFormatPart=function(){return this.dbNumberFormatPart},o.prototype.NumberStringConverter=function(n){var i=this;if(arguments.length===0)return i.numberFormat?i.numberFormat.NumberStringConverter():t;else i.numberFormat&&i.numberFormat.NumberStringConverter(n)},o.prototype.ExcelCompatibleFormatString=function(){var t=this,i="";return t.numberFormat&&t.numberFormat.ExcelCompatibleFormatString()&&(n.util.isCustomType(t.numberFormat,"NumberFormatDigital")||(t.DBNumberFormatPart()&&(i+=t.DBNumberFormatPart().toString()),t.LocaleIDFormatPart()&&(i+=t.LocaleIDFormatPart().toString()),t.ConditionFormatPart()&&(i+=t.ConditionFormatPart().toString()),t.ColorFormatPart()&&(i+=t.ColorFormatPart().toString())),i+=t.numberFormat.ExcelCompatibleFormatString()),i.toString()},o.prototype.Formatter=function(){return this.numberFormat},o.prototype.DateTimeFormatInfo=function(n){return arguments.length===0?this.Formatter().DateTimeFormatInfo():(this.Formatter().DateTimeFormatInfo(n),this.dateTimeFormatInfo=n,n)},o.prototype.NumberFormatInfo=function(n){return arguments.length===0?this.Formatter().NumberFormatInfo():(this.Formatter().NumberFormatInfo(n),this.numberFormatInfo=n,n)},o.prototype.AddPart=function(t){if(!t)throw new Error(n.SR.Exp_PartIsNull);var i=this;if(n.util.isCustomType(t,"ConditionFormatPart"))if(i.conditionFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.conditionFormatPart=n.util.asCustomType(t,"ConditionFormatPart");else if(n.util.isCustomType(t,"ColorFormatPart"))if(i.colorFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.colorFormatPart=n.util.asCustomType(t,"ColorFormatPart");else if(n.util.isCustomType(t,"LocaleIDFormatPart"))if(i.localeIDFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.localeIDFormatPart=n.util.asCustomType(t,"LocaleIDFormatPart");else if(n.util.isCustomType(t,"DBNumberFormatPart"))if(i.dbNumberFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.dbNumberFormatPart=n.util.asCustomType(t,"DBNumberFormatPart")},o.prototype.Format=function(n){return this.numberFormat.Format(n)},o.prototype.Parse=function(n){return this.numberFormat.Parse(n)},o}();y=function(){function s(i,f,e){var o=this;o.formatters=t;o.formatModeType=0;o.dateTimeFormatInfo=t;o.numberFormatInfo=t;o.isSingleFormatterInfo=!0;o.isDefault=!0;o.isConstructed=!1;o.customerCultureName=t;o.PropertyChanged=[];o._classNames=["GeneralFormatter","IFormatter","INotifyPropertyChanged","IColorFormatter"];r.IsNullOrEmpty(i)&&(i=u.General);f||(f=0);o.formatCached=i;o.formatModeType=f;o.isDefault=o.formatCached.toLowerCase()===u.General_Lower;o.isConstructed=!1;o.customerCultureName=e?n._CultureInfo.getCulture(e).Name():n._CultureInfo._currentCulture.Name()}return s._needChangeDefaultFormat=function(t){if(t){var i=n._CultureInfo._currentCulture.Name().toLowerCase(),r=t.customerCultureName.toLowerCase();return r===i?!1:!0}else return!0},s.DefaultNumberFormatter=function(){return s._needChangeDefaultFormat(this.defaultNumberFormatter)&&(this.defaultNumberFormatter=new s("###################0.################",0,n._CultureInfo._currentCulture.Name())),this.defaultNumberFormatter},s.DefaultGeneralFormatter=function(){return s._needChangeDefaultFormat(this.defaultGeneralFormatter)&&(this.defaultGeneralFormatter=new s),this.defaultGeneralFormatter},s.DefaultShortDatePatternFormatter=function(){return s._needChangeDefaultFormat(this.defaultShortDatePatternFormatter)&&(this.defaultShortDatePatternFormatter=new s(i.DateTimeFormatInfo().shortDatePattern)),this.defaultShortDatePatternFormatter},s.DefaultSXDatetimePatternFormatter=function(){var n=i.DateTimeFormatInfo().shortDatePattern+" h:mm:ss";return s._needChangeDefaultFormat(this.defaultSXDatetimePatternFormatter)&&(this.defaultSXDatetimePatternFormatter=new s(n)),this.defaultSXDatetimePatternFormatter},s.DefaultLongTimePatternFormatter=function(){var n=i.DateTimeFormatInfo().longTimePattern;return s._needChangeDefaultFormat(this.defaultLongTimePatternFormatter)&&(this.defaultLongTimePatternFormatter=new s(n)),this.defaultLongTimePatternFormatter},s.DefaultDMMMFormatter=function(){return s._needChangeDefaultFormat(this.defaultDMMMFormatter)&&(this.defaultDMMMFormatter=new s("d-mmm",0,n._CultureInfo._currentCulture.Name())),this.defaultDMMMFormatter},s.DefaultMMMYYFormatter=function(){return s._needChangeDefaultFormat(this.defaultMMMYYFormatter)&&(this.defaultMMMYYFormatter=new s("mmm-yy",0,n._CultureInfo._currentCulture.Name())),this.defaultMMMYYFormatter},s.DefaultHMMFormatter=function(){return s._needChangeDefaultFormat(this.defaultHMMFormatter)&&(this.defaultHMMFormatter=new s("h:mm",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMFormatter},s.DefaultHMMSSFormatter=function(){return s._needChangeDefaultFormat(this.defaultHMMSSFormatter)&&(this.defaultHMMSSFormatter=new s("h:mm:ss",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMSSFormatter},s.DefaultHMMSS0Formatter=function(){return s._needChangeDefaultFormat(this.defaultHMMSS0Formatter)&&(this.defaultHMMSS0Formatter=new s("h:mm:ss.0",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMSS0Formatter},s.DefaultComboNumberFormatter1=function(){return s._needChangeDefaultFormat(this.defaultComboNumberFormatter1)&&(this.defaultComboNumberFormatter1=new s(r.Format("{0}#,##0.00;[Red]({0}#,##0.00)",i.NumberFormatInfo().currencySymbol))),this.defaultComboNumberFormatter1},s.DefaultComboNumberFormatter2=function(){return s._needChangeDefaultFormat(this.defaultComboNumberFormatter2)&&(this.defaultComboNumberFormatter2=new s(r.Format("{0}#,##0;[Red]({0}#,##0)",i.NumberFormatInfo().currencySymbol))),this.defaultComboNumberFormatter2},s.DefaultStandardNumberFormatter=function(){return s._needChangeDefaultFormat(this.defaultStandardNumberFormatter)&&(this.defaultStandardNumberFormatter=new s("0.00E+00",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardNumberFormatter},s.DefaultStandardPercentFormatter1=function(){return s._needChangeDefaultFormat(this.defaultStandardPercentFormatter1)&&(this.defaultStandardPercentFormatter1=new s("0.00%",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardPercentFormatter1},s.DefaultStandardPercentFormatter2=function(){return s._needChangeDefaultFormat(this.defaultStandardPercentFormatter2)&&(this.defaultStandardPercentFormatter2=new s("0%",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardPercentFormatter2},s.DefaultStandardGroupNumberFormatter1=function(){return s._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter1)&&(this.defaultStandardGroupNumberFormatter1=new s("#,##0.00",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardGroupNumberFormatter1},s.DefaultStandardGroupNumberFormatter2=function(){return s._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter2)&&(this.defaultStandardGroupNumberFormatter2=new s("#,##0",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardGroupNumberFormatter2},s.prototype.findDateTimeGeneralFormatter=function(i,r,u,f){var e,s,o;if(u&&u.length>0)for(e in u)if(u.hasOwnProperty(e)&&(s=u[e],o=n._DateTimeHelper.parseLocale(i,s),o&&o-r==0))return f();return t},s.prototype.toJSON=function(){var n=this,r={formatModeType:n.formatModeType,customerCultureName:n.customerCultureName,formatCached:n.formatCached},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},s.prototype._isDefaultValue=function(n,t){switch(n){case"formatModeType":return t===0;case"formatCached":return t==="General";default:return!1}},s.prototype.HasFormatedColor=function(){var n=this;return n.isDefault?!1:n.PositiveExpression()&&n.PositiveExpression().ColorFormatPart()?!0:n.NegativeExpression()&&n.NegativeExpression().ColorFormatPart()?!0:n.ZeroExpression()&&n.ZeroExpression().ColorFormatPart()?!0:n.TextExpression()&&n.TextExpression().ColorFormatPart()?!0:!1},s.prototype.IsDefaultFormat=function(){return this.isDefault},s.prototype.FormatString=function(f){var e=this,o,s,h,c;if(arguments.length===0){e.Init();o=t;switch(e.FormatMode()){case 0:if(e.formatters)for(s=0;s<e.formatters.length;s++)h=e.formatters[s],n.util.isCustomType(h,"CustomNumberFormat")&&(o==t?o="":o+=i.FormatSeparator,c=h.FormatString(),o+=c);break;case 1:if(n.util.isCustomType(e.formatters[0],"StandardDateTimeFormatter"))return e.formatters[0].FormatString();break;case 2:if(n.util.isCustomType(e.formatters[0],"StandardNumberFormatter"))return e.formatters[0].FormatString();break}return o?o:r.Empty}else{if(!f)throw new Error(n.SR.Exp_ValueIsNull);e.formatters=t;e.formatCached=f;e.isDefault=e.formatCached.toLowerCase()===u.General_Lower;e.isConstructed=!1;e.Init();e.RaisePropertyChanged("FormatString")}},s.prototype.DateTimeFormatInfo=function(t){var r=this,u,f,e;if(arguments.length===0)return(r.Init(),r.dateTimeFormatInfo)?r.dateTimeFormatInfo:i.DateTimeFormatInfo();else{if(r.Init(),r.dateTimeFormatInfo=t,r.formatters)for(u=0;u<r.formatters.length;u++)f=r.formatters[u],n.util.isCustomType(f,"IFormatProviderSupport")&&(e=f,e.DateTimeFormatInfo(t));return r.RaisePropertyChanged("DateTimeFormatInfo"),t}},s.prototype.NumberFormatInfo=function(t){var r=this,u,f,e;if(arguments.length===0)return(r.Init(),r.numberFormatInfo)?r.numberFormatInfo:i.NumberFormatInfo();else{if(r.Init(),r.numberFormatInfo=t,r.formatters)for(u=0;u<r.formatters.length;u++)f=r.formatters[u],n.util.isCustomType(f,"IFormatProviderSupport")&&(e=f,e.NumberFormatInfo(t));return r.RaisePropertyChanged("NumberFormatInfo"),t}},s.prototype.FormatMode=function(n){return arguments.length===0?this.formatModeType:(this.formatModeType=n,this.RaisePropertyChanged("FormatMode"),n)},s.prototype.ExcelCompatibleFormatString=function(){var u=this,f,e,o,s;u.Init();f=t;switch(u.FormatMode()){case 0:if(u.formatters)for(e=0;e<u.formatters.length;e++)o=u.formatters[e],n.util.isCustomType(o,"CustomNumberFormat")&&(f==t?f="":f+=i.FormatSeparator,s=o.ExcelCompatibleFormatString(),f+=s);break;case 1:if(n.util.isCustomType(u.formatters[0],"StandardDateTimeFormatter"))return u.formatters[0].ExcelCompatibleFormatString();break;case 2:if(n.util.isCustomType(u.formatters[0],"StandardNumberFormatter"))return u.formatters[0].ExcelCompatibleFormatString();break}return f?f.toString():r.Empty},s.prototype.PositiveExpression=function(){var i=this;return(i.Init(),i.formatters&&i.formatters.length>0)?n.util.asCustomType(i.formatters[0],"CustomNumberFormat"):t},s.prototype.NegativeExpression=function(){var i=this;return(i.Init(),i.formatters&&i.formatters.length>1)?n.util.asCustomType(i.formatters[1],"CustomNumberFormat"):t},s.prototype.ZeroExpression=function(){var i=this;return(i.Init(),i.formatters&&i.formatters.length>2)?n.util.asCustomType(i.formatters[2],"CustomNumberFormat"):t},s.prototype.TextExpression=function(){var i=this;return(i.Init(),i.formatters&&i.formatters.length>3)?n.util.asCustomType(i.formatters[3],"CustomNumberFormat"):t},s.prototype.GetFormatType=function(t){var i,r;if(this.Init(),i=this.GetFormatInfo(t),n.util.isCustomType(i,"CustomNumberFormat")){if(r=i.Formatter(),n.util.isCustomType(r,"NumberFormatDigital"))return 1;else if(n.util.isCustomType(r,"NumberFormatDateTime"))return 2;else if(n.util.isCustomType(r,"NumberFormatText"))return 3}else if(n.util.isCustomType(i,"NumberFormatDigital")||n.util.isCustomType(i,"StandardNumberFormatter"))return 1;else if(n.util.isCustomType(i,"NumberFormatDateTime")||n.util.isCustomType(i,"StandardDateTimeFormatter"))return 2;else if(n.util.isCustomType(i,"NumberFormatText"))return 3;return 0},s.prototype.GetPreferredEditingFormatter=function(t){var i,r;return this.Init(),n.util.isType(t,"DateTime")?(i=new n._DateTimeHelper(t),i.Hour()===0&&i.Minute()===0&&i.Second()===0&&i.Millisecond()===0?s.DefaultShortDatePatternFormatter():s.DefaultSXDatetimePatternFormatter()):n.util.isType(t,"TimeSpan")?s.DefaultLongTimePatternFormatter():n.FormatConverter.IsNumber(t)?(r=n.FormatConverter.ToDouble(t),r>1e20?new s("0.##E+00"):s.DefaultNumberFormatter()):n.util.isType(t,"string")?s.DefaultGeneralFormatter():s.DefaultGeneralFormatter()},s.prototype.GetPreferredDisplayFormatter=function(u,f){var o=this,c,h,l;if(f||(f={value:t}),f.value=t,o.Init(),r.IsNullOrEmpty(u))return new s;if(c=u,h=f.value=o.Parse(c),n.util.isType(h,"DateTime")||n.util.isType(h,"TimeSpan")){if((l=o.findDateTimeGeneralFormatter(u,h,e.GeneralMonthDay(),function(){return s.DefaultDMMMFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralYearMonth(),function(){return s.DefaultMMMYYFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralYearMonthDay(),function(){return s.DefaultShortDatePatternFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinute(),function(){return s.DefaultHMMFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecond(),function(){return s.DefaultHMMSSFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondSubSecond(),function(){return s.DefaultHMMSS0Formatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMFormatter)&&(s.defaultShortDatePatternHMMFormatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm")),s.defaultShortDatePatternHMMFormatter}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMSSFormatter)&&(s.defaultShortDatePatternHMMSSFormatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm:ss")),s.defaultShortDatePatternHMMSSFormatter}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondSubSecondWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMSS0Formatter)&&(s.defaultShortDatePatternHMMSS0Formatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm:ss.0")),s.defaultShortDatePatternHMMSS0Formatter})))return l}else if(n.FormatConverter.IsNumber(h))if(c[0]===i.NumberFormatInfo().currencySymbol[0])return n.StringHelper.Contains(c,i.DecimalSeparator)?s.DefaultComboNumberFormatter1():s.DefaultComboNumberFormatter2();else if(n.StringHelper.IndexOf(c,"e",1)>-1)return s.DefaultStandardNumberFormatter();else if(c[0].toString()===i.percentSymbol||c[c.length-1].toString()===i.percentSymbol)return n.StringHelper.Contains(c,i.DecimalSeparator)?s.DefaultStandardPercentFormatter1():s.DefaultStandardPercentFormatter2();else if(n.StringHelper.Contains(c,i.numberGroupSeparator))return n.StringHelper.Contains(c,i.DecimalSeparator)?s.DefaultStandardGroupNumberFormatter1():s.DefaultStandardGroupNumberFormatter2();return s.DefaultGeneralFormatter()},s.prototype.Format=function(u,e){var s,v,c,l,h,a;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();if(e&&(e.value=t),this.Init(),s=this.GetFormatInfo(u),n.util.isCustomType(s,"CustomNumberFormat")&&(v=s.ColorFormatPart(),e&&v&&(e.value=v.ForeColor())),c=0,l=n.FormatConverter.IsNumber(u),l&&(c=n.FormatConverter.ToDouble(u)),s){if(h=t,l&&s===this.NegativeExpression())h=s.Format(o(c)),n.util.isCustomType(s,"CustomNumberFormat")&&(a=n.util.asCustomType(s,"CustomNumberFormat"),a&&a.ConditionFormatPart()&&a.ConditionFormatPart().Value()>0&&c<0&&(h=i.negativeSign+h));else try{h=s.Format(u)}catch(y){n.util.isType(u,"string")&&(h=u.toString())}return h?h:r.Empty}else return l&&c<0?i.HyphenMinus.toString():n.util.isType(u,"string")?u.toString():u===f||u===t?r.Empty:u.toString()},s.prototype.Parse=function(n){var i=this;return(i.Init(),i.formatters&&i.formatters.length>0)?i.formatters[0].Parse(n):t},s.prototype.Init=function(){var n=this;if(!n.isConstructed){n.isConstructed=!0;switch(n.formatModeType){case 0:n.InitExcelCompatibleMode(n.formatCached);break;case 1:n.InitStandardDateTimeMode(n.formatCached);break;case 2:n.InitStandardNumericMode(n.formatCached);break}}},s.prototype.InitStandardDateTimeMode=function(t){var i=new b(t);if(i.EvaluateFormat(t))this.formatters=[],this.formatters.push(i);else throw new Error(n.SR.Exp_FormatIllegal);},s.prototype.InitStandardNumericMode=function(t){var i=new k(t);if(i.EvaluateFormat(t))this.formatters=[],this.formatters.push(i);else throw new Error(n.SR.Exp_FormatIllegal);},s.prototype.InitExcelCompatibleMode=function(t){var u,f,o,e,s;if(r.IsNullOrEmpty(t))throw new Error(n.SR.Exp_FormatIllegal);if(u=this,u.formatters=[],u.isDefault)u.formatters.push(new g);else{if(u.isSingleFormatterInfo=!n.StringHelper.Contains(t,i.FormatSeparator.toString()),f=t.split(i.FormatSeparator),!f)throw new Error(n.SR.Exp_FormatIllegal);if(f.length<1||f.length>5)throw new Error(n.SR.Exp_FormatIllegal);for(o=0,e=0;e<f.length;e++){if(o++,o>4)break;s=new g(f[e],u.customerCultureName);s&&u.formatters.push(s)}if(!u.PositiveExpression())throw new Error(n.SR.Exp_FormatIllegal);}},s.prototype.GetFormatInfo=function(i){var r=this;if(r.FormatMode()===0){if(typeof i=="string"&&isNaN(i))return r.TextExpression()?r.TextExpression():r.PositiveExpression();else if(n.FormatConverter.IsNumber(i)||n.util.isType(i,"boolean")){var f=r.PositiveExpression(),o=r.NegativeExpression(),e=n.FormatConverter.ToDouble(i),s=f&&f.ConditionFormatPart(),h=o&&o.ConditionFormatPart(),u=r.isSingleFormatterInfo?f:t;return f&&(s?f.ConditionFormatPart().IsMeetCondition(e)&&(u=f):(e>0||e===0&&!r.ZeroExpression())&&(u=f)),!u&&r.NegativeExpression()&&(h?o.ConditionFormatPart().IsMeetCondition(e)&&(u=o):e<0&&(u=o)),!u&&r.ZeroExpression()&&e===0&&(u=r.ZeroExpression()),!u&&r.ZeroExpression()&&(u=r.ZeroExpression()),!u&&r.NegativeExpression()&&(u=r.NegativeExpression()),u}}else if((r.FormatMode()===1||r.FormatMode()===2)&&r.formatters&&r.formatters.length===1)return r.formatters[0];return t},s.prototype.RaisePropertyChanged=function(n){var t=this,i,r;if(t.PropertyChanged)for(i=0;i<t.PropertyChanged.length;i++)r=t.PropertyChanged[i],typeof r=="function"&&r(t,n)},s.defaultNumberFormatter=t,s.defaultGeneralFormatter=t,s.defaultShortDatePatternFormatter=t,s.defaultLongTimePatternFormatter=t,s.defaultSXDatetimePatternFormatter=t,s.defaultDMMMFormatter=t,s.defaultMMMYYFormatter=t,s.defaultHMMFormatter=t,s.defaultHMMSSFormatter=t,s.defaultHMMSS0Formatter=t,s.defaultShortDatePatternHMMFormatter=t,s.defaultShortDatePatternHMMSSFormatter=t,s.defaultShortDatePatternHMMSS0Formatter=t,s.defaultComboNumberFormatter1=t,s.defaultComboNumberFormatter2=t,s.defaultStandardNumberFormatter=t,s.defaultStandardPercentFormatter1=t,s.defaultStandardPercentFormatter2=t,s.defaultStandardGroupNumberFormatter1=t,s.defaultStandardGroupNumberFormatter2=t,s}();n.GeneralFormatter=y;var s=function(){function n(n){this._classNames=["FormatPartBase"];this.originalToken=n}return n.prototype.OriginalToken=function(){return this.originalToken},n.prototype.SupportedPartFormat=function(){return n._supportedPartFormat||(n._supportedPartFormat=["ConditionFormatPart","ColorFormatPart","LocaleIDFormatPart"]),n._supportedPartFormat},n.Create=function(n){return ut.EvaluateFormat(n)?new ut(n):ot.EvaluateFormat(n)?new ot(n):ht.EvaluateFormat(n)?new ht(n):et.EvaluateFormat(n)?new et(n):ft.EvaluateFormat(n)?new ft(n):t},n}(),ut=function(u){function f(f){var e,h,v,y,a;if(u.call(this,f),e=this,s.call(e,f),e._classNames.push("ConditionFormatPart"),e._initFileds(),h=i.TrimSquareBracket(f),r.IsNullOrEmpty(h))throw new Error(n.SR.Exp_TokenIllegal);for(var o="",c=0,l=t;c<h.length;c++)if(l=h[c],i.IsOperator(l))o+=l;else break;if(!o)throw new Error(n.SR.Exp_TokenIllegal);v=o;o="";switch(v){case"<":e.compareOperator=4;break;case"<=":e.compareOperator=5;break;case"=":e.compareOperator=0;break;case">=":e.compareOperator=3;break;case">":e.compareOperator=2;break;case"<>":e.compareOperator=1;break;default:throw new Error(n.SR.Exp_TokenIllegal);}for(;c<h.length;c++){if(l=h[c],i.IsOperator(l))throw new Error(n.SR.Exp_TokenIllegal);o+=l}if(!o)throw new Error(n.SR.Exp_TokenIllegal);if(y=o,a=parseFloat(y),isNaN(a))throw new Error(n.SR.Exp_TokenIllegal);else e.value=a}return __extends(f,u),f.prototype._initFileds=function(){this.value=0;this.compareOperator=t},f.prototype.CompareOperator=function(){return this.compareOperator},f.prototype.Value=function(){return this.value},f.prototype.toString=function(){var n="";switch(this.compareOperator){case 0:n+="=";break;case 2:n+=">";break;case 3:n+=">=";break;case 4:n+="<";break;case 5:n+="<=";break;case 1:n+="<>";break;default:throw new Error;}return n+=this.value.toString(),i.AddSquareBracket(n)},f.prototype.IsMeetCondition=function(n){var t=this;switch(t.compareOperator){case 0:return n===t.value;case 2:return n>t.value;case 3:return n>=t.value;case 4:return n<t.value;case 5:return n<=t.value;case 1:return n!==t.value}return!1},f.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var t=i.TrimSquareBracket(n);return!t||t===r.Empty?!1:i.IsOperator(t[0])},f}(s),ft=function(u){function f(f){var o,e,h,c;if(u.call(this,f),this.foreColor="black",this.index=-1,this.colorName=t,o=this,s.call(o,f),o._classNames.push("ColorFormatPart"),e=i.TrimSquareBracket(f),!e||e===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);try{o.foreColor=e;o.colorName=e;return}catch(l){}if(!(e.length>5)||(e=n.StringHelper.Remove(e,0,5),h=-1,c=parseInt(e,10),isNaN(c)||(h=c,!(h>=1)||!(h<=56))))throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.ForeColor=function(){return this.foreColor},f.prototype.toString=function(){var n=this;if(n.index>-1)return i.AddSquareBracket("Color"+n.index);else if(n.colorName)return i.AddSquareBracket(n.colorName);throw new Error;},f.EvaluateFormat=function(t){if(!t||t===r.Empty)return!1;var u=i.TrimSquareBracket(t);return!u||u===r.Empty?!1:u.length<3?!1:isNaN(t[t.length-1])?t[0]!==t[1]:n.StringHelper.StartsWith(t,"Color",1)},f}(s),et=function(u){function f(t){var i,r,e;if(u.call(this,t),i=this,s.call(i,t),i._classNames.push("ABSTimeFormatPart"),i._initFileds(),f.EvaluateFormat(t))if(i.token=t.toLowerCase(),i.token[1]===f.HoursABSContent)i.type=0;else if(i.token[1]===f.MinuteABSContent)i.type=1;else if(i.token[1]===f.SecondABSContent)i.type=2;else throw new Error(n.SR.Exp_TokenIllegal);else throw new Error(n.SR.Exp_TokenIllegal);for(r="",e=0;e<i.token.length-2;e++)r+="0";i.formatString=r}return __extends(f,u),f.prototype._initFileds=function(){this.token=t;this.type=t;this.formatString=t},f.prototype.FormatString=function(){return this.formatString},f.prototype.TimePartType=function(){return this.type},f.prototype.Token=function(){return this.token},f.EvaluateFormat=function(n){var u,e,o,s;if(!n||n===r.Empty||(u=i.TrimSquareBracket(n),!u||u===r.Empty))return!1;for(u=u.toLowerCase(),e=t,o=0;o<u.length;o++)if((e||(e=u[o]),s=f,e!==s.HoursABSContent&&e!==s.MinuteABSContent&&e!==s.SecondABSContent)||e!==u[o])return!1;return!0},f.HoursABSContent="h",f.MinuteABSContent="m",f.SecondABSContent="s",f}(s),l=function(){function n(n,i){var f=this,o,e,u;if(f._classNames=["DBNumber"],o=t,e=t,n)for(f.units=[],u=0;u<n.length;u++)e=n[u],e===0?f.units.push(r.Empty):f.units.push(String.fromCharCode(e));if(i)for(f.numbers=[],u=0;u<i.length;u++)e=i[u],e===0?f.numbers.push(r.Empty):f.numbers.push(String.fromCharCode(e))}return n.ChineseDBNum1=function(){return n.chineseDBNum1||(n.chineseDBNum1=new n(n.ChineseNumberUnitLetter1,n.ChineseNumberLetterValues1)),n.chineseDBNum1},n.ChineseDBNum2=function(){return n.chineseDBNum2||(n.chineseDBNum2=new n(n.ChineseNumberUnitLetter2,n.ChineseNumberLetterValues2)),n.chineseDBNum2},n.ChineseDBNum3=function(){return n.chineseDBNum3||(n.chineseDBNum3=new n(t,n.ChineseNumberLetterValues3)),n.chineseDBNum3},n.JapaneseDBNum1=function(){return n.japaneseDBNum1||(n.japaneseDBNum1=new n(n.JapaneseNumberUnitLetter1,n.JapaneseNumberLetterValues1)),n.japaneseDBNum1},n.JapaneseDBNum2=function(){return n.japaneseDBNum2||(n.japaneseDBNum2=new n(n.JapaneseNumberUnitLetter2,n.JapaneseNumberLetterValues2)),n.japaneseDBNum2},n.JapaneseDBNum3=function(){return n.japaneseDBNum3||(n.japaneseDBNum3=new n(t,n.JapaneseNumberLetterValues3)),n.japaneseDBNum3},n.prototype.Units=function(){return this.units},n.prototype.Numbers=function(){return this.numbers},n.chineseDBNum1=t,n.chineseDBNum2=t,n.chineseDBNum3=t,n.ChineseNumberUnitLetter1=[20806,21315,30334,21313,20159,21315,30334,21313,19975,21315,30334,21313,0],n.ChineseNumberUnitLetter2=[20806,20191,20336,25342,20159,20191,20336,25342,19975,20191,20336,25342,0],n.ChineseNumberLetterValues1=[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],n.ChineseNumberLetterValues2=[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],n.ChineseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],n.japaneseDBNum1=t,n.japaneseDBNum2=t,n.japaneseDBNum3=t,n.JapaneseNumberUnitLetter1=[20806,21315,30334,21313,20740,21315,30334,21313,19975,21315,30334,21313,0],n.JapaneseNumberUnitLetter2=[20806,38433,30334,25342,20740,38433,30334,25342,33836,38433,30334,25342,0],n.JapaneseNumberLetterValues1=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],n.JapaneseNumberLetterValues2=[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],n.JapaneseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],n}(),ot=function(u){function f(r){var e,o,s;if(u.call(this,r),this.token=t,this.type=0,e=this,e._classNames.push("DBNumberFormatPart"),f.EvaluateFormat(r)){if(e.token=r,o=i.TrimSquareBracket(r),s=n.StringHelper.Remove(o,0,5),e.type=parseInt(s,10),e.type<0||e.type>3)throw new Error(n.SR.Exp_TokenIllegal);}else throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.Token=function(){return this.token?this.token:r.Empty},f.prototype.Type=function(){return this.type},f.prototype.ReplaceNumberString=function(u,f,e){var l,p;if(!u||u===r.Empty)return u;var h=u,w=u,s=-1,o=-1,a=!1,c=t,v=t,y=t;for(l=u.length-1;l>=0;l--)p=w[l],isNaN(p)&&(!i.IsEquals(p,i.DecimalSeparator,!1)||a)?o>-1&&s>-1&&(c=w.substr(o,s-o+1),v=parseFloat(c),isNaN(v)||(y=this.NumberString(c,f,e),h=n.StringHelper.Remove(h,o,s-o+1),h=n.StringHelper.Insert(h,o,y)),s=-1,o=-1,a=!1):(i.IsEquals(p,i.DecimalSeparator,!1)&&(a=!0),s===-1&&(s=l),o=l);return o>-1&&s>-1&&(c=w.substr(o,s-o+1),v=parseFloat(c),isNaN(v)||(y=this.NumberString(c,f,e),h=n.StringHelper.Remove(h,o,s-o+1),h=n.StringHelper.Insert(h,o,y)),s=-1,o=-1,a=!1),h},f.prototype.NumberString=function(i,r,u){var e=i.split("."),o,s;if(e)if(e.length===1)return f.FormatNumberString(e[0],r.Numbers(),u?r.Units():t);else if(e.length===2)return o=f.FormatNumberString(e[0],r.Numbers(),u?r.Units():t),s=f.FormatNumberString(e[1],r.Numbers()),o+"."+s;throw new Error(n.SR.Exp_ValueIllegal);},f.prototype.toString=function(){if(this.type>-1)return i.AddSquareBracket("DBNum"+this.type);throw new Error;},f.EvaluateFormat=function(t){if(!t||t===r.Empty)return!1;var u=i.TrimSquareBracket(t);return!u||u===r.Empty?!1:n.StringHelper.StartsWith(u,"DBNum",1)?!0:!1},f.FormatNumberString=function(n,i,u){var w=n,v=0,a=t,y=0,k,g,nt,b,e,c,h,it,tt;if(arguments.length===2){for(k="",v=0;v<w.length;v++)a=w.substr(v,1),y=parseInt(a,10),k+=i[y];return k}else if(arguments.length===3){if(!u)return f.FormatNumberString(n,i);var o=0,d="",l=w.length,p=!1,s=[];for(v=0;v<l;v++)g=u.length-1-v,g>-1?s.push(u[g].toString()):s.push(r.Empty);for(nt=[],e=s.length-1;e>=0;e--)nt[s.length-e-1]=s[e];for(s=nt,b=!1,e=0;e<l;e++)a=w.substr(e,1),y=parseInt(a,10),c=r.Empty,h=r.Empty,l-e-16>0?(c=i[y],h="",b=!0):e!==l-1&&e!==l-5&&e!==l-9&&e!==l-13?a==="0"?(c="",h="",o=o+1):a!=="0"&&o!==0?(c=i[0]+i[y],h=s[e],o=0):(c=i[y],h=s[e],o=0):a!=="0"&&o!==0?(c=i[0]+i[y],h=s[e],o=0):a!=="0"&&o===0||b?(c=i[y],h=s[e],o=0,b=!1):a==="0"&&o>=3?(c="",h="",o=o+1):l>=11?(c="",o=o+1):(c="",h=s[e],o=o+1),it=c+h===r.Empty,it||(p=!1),e!==l-13||p||(h=s[e],p=!0),e!==l-9||p||(h=s[e],p=!0),e===l-1&&(h=s[e],p=!0),d=d+c+h;return(tt=parseInt(n,10),!isNaN(tt)&&tt===0)?i[0]:d}},f}(s),p=function(){function t(){}return t.ParseHexString=function(t){if(!t||t===r.Empty)throw new Error(n.SR.Exp_StringIllegal);return parseInt(t,16)},t.FixJapaneseChars=function(n){return n},t.GetFraction=function(n,t,i,r,u){var l=0,y=0,p=0,f=0,s,h,a,v,e;for(n>0?(f=n-c(n)+1,f==1?(f=0,l=n):l=c(n)-1):n<0&&(l=c(n),f=c(n)-n),s=2,h=9,s=nt(10,t-1),h=nt(10,t)-1,s<2&&(s=2),h<2&&(h=2),a=!1,v=0,e=s;e<=h;e++){var d=e*f,w=vt(d),b=w/e,k=o(b-f);if((a?k<o(v-f):!0)&&(a=!0,v=b,y=w,p=e,k<1e-5))break}return i.value=l,r.value=y,u.value=p,a},t}(),st=function(){function t(){}return t.AllowScience=function(n){return n?!(n.indexOf("ja")===0)&&!(n.indexOf("zh")===0):!0},t.CreateCultureInfo=function(i){switch(i){case 1033:return n._CultureInfo.getCulture(t.EnglishUnitedStates);case 1041:return n._CultureInfo.getCulture(t.JapanneseJapan);case 2052:return n._CultureInfo.getCulture(t.ChinesePRC);default:return n._CultureInfo.currentCulture()}},t.JapanneseJapan="ja-JP",t.EnglishUnitedStates="en-US",t.ChinesePRC="zh-cn",t}(),ht=function(u){function f(f){var o,e,h;if(u.call(this,f),this.currencySymbol=t,this.locateID=-1,this.cultureInfo=t,this.content=t,o=this,s.call(o,f),o._classNames.push("LocaleIDFormatPart"),!f)throw new Error(n.SR.Exp_TokenIsNull);if(f===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);if(o.content=i.TrimSquareBracket(f),e=o.content,!e||e===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);if(i.IsEquals(e[0],i.Dollar,!1))e=n.StringHelper.Remove(e,0,1);else throw new Error(n.SR.Exp_TokenIllegal);if(h=e.indexOf(i.HyphenMinus),h>-1)o.currencySymbol=e.substr(0,h),e=n.StringHelper.Remove(e,0,h);else{o.currencySymbol=e;return}if(i.IsEquals(e[0],i.HyphenMinus,!1))e=n.StringHelper.Remove(e,0,1);else throw new Error(n.SR.Exp_TokenIllegal);if(e.length>0)o.locateID=p.ParseHexString(e);else throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.CultureInfo=function(){var n=this;return n.cultureInfo||(n.cultureInfo=st.CreateCultureInfo(n.locateID),n.currencySymbol&&n.currencySymbol!==r.Empty&&n.cultureInfo&&!n.cultureInfo.NumberFormat().isReadOnly&&(n.cultureInfo.NumberFormat().currencySymbol=n.currencySymbol)),n.cultureInfo},f.prototype.CurrencySymbol=function(){return this.currencySymbol?this.EncodeSymbol(this.currencySymbol):r.Empty},f.prototype.AllowScience=function(){if(this.cultureInfo)return st.AllowScience(this.cultureInfo.Name())},f.prototype.GetDBNumber=function(n){var i=this.locateID&255;switch(i){case 4:switch(n){case 1:return l.ChineseDBNum1();case 2:return l.ChineseDBNum2();case 3:return l.ChineseDBNum3()}break;case 17:switch(n){case 1:return l.JapaneseDBNum1();case 2:return l.JapaneseDBNum2();case 3:return l.JapaneseDBNum3()}break;default:break}return t},f.prototype.toString=function(){return this.content?i.AddSquareBracket(this.content):r.Empty},f.prototype.EncodeSymbol=function(t){return n.StringHelper.Replace(t,"\\.","'.'")},f.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var t=i.TrimSquareBracket(n);return!t||t===r.Empty?!1:i.IsEquals(t[0],i.Dollar,!1)},f}(s),ct=function(){function r(){}return r.prototype.ConvertTo=function(r,u,f,e,o){var s=r,c;return e!=t&&o!=t&&u instanceof Date&&(c=e.GetDBNumber(o.Type()),s=o.ReplaceNumberString(s,c,!0),o.Type()===1&&(s=s.replace(new RegExp(yt,"g"),pt)),s=s.replace(i.ReplacePlaceholder+h.YearFourDigit,new n._DateTimeHelper(u).localeFormat(h.YearFourDigit)),s=s.replace(i.ReplacePlaceholder+h.YearTwoDigit,new n._DateTimeHelper(u).localeFormat(h.YearTwoDigit)),s=o.ReplaceNumberString(s,c,!1)),s},r}(),h=function(e){function o(n,i,r,f,o){e.call(this,r,f,o);this.baseNumberStringConverter=u.prototype.NumberStringConverter;this.baseDateTimeFormatInfo=u.prototype.DateTimeFormatInfo;this.baseCultureName=u.prototype.CultureName;var s=this;s.validDateTimeFormatString=t;s.formatString=t;s.hasJD=!1;s.absoluteTime=t;s.absTimeParts=t;s.hasYearDelay=!1;s.exactlyMatch=!1;s._classNames.push("NumberFormatDateTime");s.exactlyMatch=!1;s.formatString=s.FixFormat(u.TrimNotSupportSymbol(n));s.absTimeParts=i;s._init(n,i,r,f)}return __extends(o,e),o.EvaluateFormat=function(n){return u.ContainsKeywords(n,o.keyWords,o.keyWordsSet())},o.prototype._init=function(t,r,u,f){var s=this,e={value:s.formatString},h=o,a,c,l;if(h.EvaluateFormat(e.value)){if(a=s.ProcessAMPM(e),s.hasJD=s.Replace(e.value,h.MonthJD,'"'+h.PlaceholderMonthJD+'"',!0,!1,e,!1,!1),s.Replace(e.value,h.MonthUnabbreviated,h.StandardMonthUnabbreviated,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthAbbreviation,h.StandardMonthAbbreviation,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthTwoDigit,h.StandardMonthTwoDigit,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthSingleDigit,h.StandardMonthSingleDigit,!0,!1,e,!1,!1),s.Replace(e.value,h.DayWeekDayAbbreviation,h.StandardDayWeekDayAbbreviation,!0,!0,e,!1,!0),s.Replace(e.value,h.DayWeekDayUnabbreviated,h.StandardDayWeekDayUnabbreviated,!0,!0,e,!1,!0),s.Replace(e.value,h.MinuteSingleDigit,h.StandardMinuteSingleDigit,!1,!0,e,!1,!1),a||(s.Replace(e.value,h.HoursSingleDigit,h.StandardHourSingleDigit,!0,!0,e,!1,!1),s.Replace(e.value,h.HoursTwoDigit,h.StandardHourTwoDigit,!0,!0,e,!1,!1)),s.Replace(e.value,h.SecondSingleDigit,h.StandardSecondSingleDigit,!0,!0,e,!1,!0),s.PartDBNumberFormat()&&s.PartLocaleID()&&(s.hasYearDelay=s.hasYearDelay||s.Replace(e.value,h.YearFourDigit,'"'+i.ReplacePlaceholder+h.YearFourDigit+'"',!0,!1,e,!1,!0),s.hasYearDelay=s.hasYearDelay||s.Replace(e.value,h.YearTwoDigit,'"'+i.ReplacePlaceholder+h.YearTwoDigit+'"',!0,!1,e,!1,!0)),s.absTimeParts)for(c=0;c<s.absTimeParts.length;c++)l=s.absTimeParts[c],s.Replace(e.value,l.token,i.ReplacePlaceholder+l.token,!0,!0,e,!1,!0);s.validDateTimeFormatString=e.value}else throw new Error(n.SR.Exp_FormatIllegal);},o.prototype._isJanpaneseCulture=function(){var i=this.PartLocaleID();if(i!==t&&i.CultureInfo()!==t){if(i.CultureInfo()===n._CultureInfo.jaCulture())return!0}else if(this.CultureName()===n._CultureInfo.jaCulture().Name())return!0;return!1},o.prototype.NumberStringConverter=function(n){return arguments.length===0?this.baseNumberStringConverter()?this.baseNumberStringConverter():o.defaultDateTimeNumberStringConverter:(this.baseNumberStringConverter(n),n)},o.prototype.AbsoluteTime=function(){return this.absoluteTime?this.absoluteTime:o.defaultAbsoluteTime},o.prototype.FormatString=function(){return this.formatString},o.prototype.DateTimeFormatInfo=function(t){var r=this;return arguments.length===0?r.baseDateTimeFormatInfo()?r.baseDateTimeFormatInfo():r.PartLocaleID()&&r.PartLocaleID().CultureInfo()?r.PartLocaleID().CultureInfo().DateTimeFormat():r.baseCultureName()?n._CultureInfo.getCulture(r.baseCultureName()).DateTimeFormat():i.DateTimeFormatInfo():(r.baseDateTimeFormatInfo(t),t)},o.prototype.ExcelCompatibleFormatString=function(){var t=this,i=t.formatString,n=o,r={value:i};return t.Replace(i,n.StandardAMPMSingleDigit,t.CurrentAMPM(),!0,!0,r,!1,!0),t.Replace(i,n.StandardMonthUnabbreviated,n.MonthUnabbreviated,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthAbbreviation,n.MonthAbbreviation,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthTwoDigit,n.MonthTwoDigit,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthSingleDigit,n.MonthSingleDigit,!0,!1,r,!1,!0),t.Replace(i,n.StandardDayWeekDayAbbreviation,n.DayWeekDayAbbreviation,!0,!0,r,!1,!0),t.Replace(i,n.StandardDayWeekDayUnabbreviated,n.DayWeekDayUnabbreviated,!0,!0,r,!1,!0),t.Replace(i,n.StandardMinuteSingleDigit,n.MinuteSingleDigit,!1,!0,r,!1,!0),t.Replace(i,n.StandardHourSingleDigit,n.HoursSingleDigit,!0,!0,r,!1,!1),t.Replace(i,n.StandardHourTwoDigit,n.HoursTwoDigit,!0,!0,r,!1,!1),t.Replace(i,n.StandardSecondSingleDigit,n.SecondSingleDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondThreeDigit,n.SubSecondThreeDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondTwoDigit,n.SubSecondTwoDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondSingleDigit,n.SubSecondSingleDigit,!0,!0,r,!1,!0),r.value},o.prototype.CurrentAMPM=function(){var n=t;return(n=this.DateTimeFormatInfo()?this.DateTimeFormatInfo():i.DateTimeFormatInfo(),n&&n.amDesignator&&n.amDesignator!==r.Empty&&n.pmDesignator&&n.pmDesignator!==r.Empty)?r.Format("{0}/{1}",n.amDesignator,n.pmDesignator):o.AMPMTwoDigit},o.prototype.Format=function(u){var l,c,b,y,p,w,a,k;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();var e=this,s=r.Empty,h=t;try{try{h=n.Calc.Convert.DT(u);h?u=h:s=u.toString()}catch(d){s=u.toString()}if(h&&(l=e.validDateTimeFormatString,c=e.validDateTimeFormatString.replace(/%/g,""),c==="H"||c==="h"||c==="m"||c==="M"||c==="d"||c==="s"||c==="y"?(l="%"+c,e.validDateTimeFormatString=l):l=c,s=e.PartLocaleID()&&e.PartLocaleID().CultureInfo()?new n._DateTimeHelper(h).customCultureFormat(l,e.PartLocaleID().CultureInfo()):e.CultureName()?new n._DateTimeHelper(h).customCultureFormat(l,n._CultureInfo.getCulture(e.CultureName())):new n._DateTimeHelper(h).localeFormat(l),e.hasJD&&(b=e._getMonthName(h.getMonth()),s=n.StringHelper.Replace(s,o.PlaceholderMonthJD,b.substr(0,1))),e.absTimeParts))for(y=(n._DateTimeHelper.___toOADate(h)-n._DateTimeHelper.___toOADate(e.AbsoluteTime()))*864e5,p=0;p<e.absTimeParts.length;p++){w=e.absTimeParts[p];a=t;switch(w.TimePartType()){case 0:a=v(y/36e5);break;case 1:a=v(y/6e4);break;case 2:a=v(y/1e3);break}a!==t&&a!==f&&(k=w.token.replace("[","\\[").replace("]","\\]"),s=n.StringHelper.Replace(s,i.ReplacePlaceholder+k,a))}}catch(g){s=n.FormatConverter.toString(u)}return e.NumberStringConverter()&&(e.NumberStringConverter()instanceof ct?s=e.NumberStringConverter().ConvertTo(s,u,!1,e.PartLocaleID(),e.PartDBNumberFormat()):(e.hasYearDelay&&(s=n.StringHelper.Replace(s,i.ReplacePlaceholder+o.YearFourDigit,new n._DateTimeHelper(h).localeFormat(o.YearFourDigit)),s=n.StringHelper.Replace(s,i.ReplacePlaceholder+o.YearTwoDigit,new n._DateTimeHelper(h).localeFormat(o.YearTwoDigit))),s=e.NumberStringConverter().ConvertTo(s,u,!0,e.PartLocaleID(),e.PartDBNumberFormat()))),s},o.prototype._getMonthName=function(n){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[n]},o.prototype.Parse=function(i){var o,u;if(!i||i===r.Empty)return t;var e=this,f=p.FixJapaneseChars(i),s=f.toLowerCase();if(s==="true")return!0;else if(s==="false")return!1;if(e.validDateTimeFormatString&&(o=n._DateTimeHelper.parseExact(f,e.validDateTimeFormatString,n._CultureInfo.getCulture(e.CultureName())),o))return o;if(!e.exactlyMatch)try{return u=n.Calc.Convert.DT(f),u&&!isNaN(u)?u:(u=new Date(f),isNaN(u.valueOf())?f:u)}catch(h){return f}return t},o.prototype.FixFormat=function(t){for(var r,u=t,s="",e=!1,h=n.StringHelper.IndexOf(u,o.HoursSingleDigit[0],1)>-1||n.StringHelper.IndexOf(u,o.SecondSingleDigit[0],1)>-1,c=n.StringHelper.IndexOf(u,o.YearTwoDigit[0],1)>-1||n.StringHelper.IndexOf(u,o.DaySingleDigit[0],1)>-1,f=0;f<u.length;f++)r=u[f],r==='"'?e=!e:e||(r==="Y"||r==="D"||r==="S"||r==="E"||r==="G"?r=r.toLowerCase():r==="M"&&(f>1?i.IsEquals("A",u[f-1],!0)||i.IsEquals("P",u[f-1],!0)||(r=r.toLowerCase()):r=r.toLowerCase())),s+=r;return s},o.prototype.ProcessAMPM=function(t){var u=!1,i,f,r;return n.StringHelper.Contains(t.value,o.AMPMTwoDigit)&&(t.value=n.StringHelper.Replace(t.value,o.AMPMTwoDigit,o.StandardAMPMSingleDigit),u=!0),i=this.DateTimeFormatInfo(),n.StringHelper.Contains(t.value,o.AMPMSingleDigit)&&(t.value=n.StringHelper.Replace(t.value,o.AMPMSingleDigit,o.StandardAMPMSingleDigit),i&&(i.amDesignator=o.AMPMSingleDigit.substr(0,1),i.pmDesignator=o.AMPMSingleDigit.substr(2,1)),u=!0),f=this.CurrentAMPM(),n.StringHelper.Contains(t.value,f)&&(t.value=n.StringHelper.Replace(t.value,f,o.StandardAMPMSingleDigit),r=f.split("/"),r&&r.length===2&&(i.amDesignator=r[0],i.pmDesignator=r[1]),u=!0),u},o.prototype.Replace=function(t,r,u,f,e,s,h,c){var a,w,y,b,tt,v,g;if(s.value=t,f||e){var k=[],p=!0,it=n.StringHelper.IndexOf(s.value,o.HoursSingleDigit[0],1)>-1||n.StringHelper.IndexOf(s.value,o.SecondSingleDigit[0],1)>-1,rt=n.StringHelper.IndexOf(s.value,o.YearTwoDigit[0],1)>-1||n.StringHelper.IndexOf(s.value,o.DaySingleDigit[0],1)>-1;!rt&&it&&(p=!1);for(var d=!1,nt=0,l=0;l<s.value.length;l++){if(a=s.value[l],i.IsEquals(a,o.HoursSingleDigit[0],!0)||i.IsEquals(a,o.SecondSingleDigit[0],!0)?p=!1:(i.IsEquals(a,o.YearTwoDigit[0],!0)||i.IsEquals(a,o.DaySingleDigit[0],!0))&&(p=!0),f&&i.IsEquals(a,r[nt],c)&&p||e&&i.IsEquals(a,r[nt],c)&&!p){for(w=!0,y=0;y<r.length;y++)if(y+l>=t.length||!i.IsEquals(r[y],s.value[y+l],c)){w=!1;break}if(b=l+r.length-1,w&&b+1<s.value.length){for(tt=s.value[b],v=-1,v=b+1;v<s.value.length;v++)if(!i.IsEquals(tt,s.value[v],c))break;v>b+1&&(l=v,w=!1)}w&&!d&&n.ArrayHelper.insert(k,0,l)}a==='"'&&(d=!d)}if(k.length>0){if(!h)for(l=0;l<k.length;l++)g=k[l],s.value=n.StringHelper.Remove(s.value,g,r.length),s.value=n.StringHelper.Insert(s.value,g,u);return!0}else return!1}return!1},o.keyWordsSet=function(){var n=o,i,t;if(!n._keyWordsSet){for(i={},t=0;t<n.keyWords.length;t++)i[n.keyWords[t]]=!0;n._keyWordsSet=i}return n._keyWordsSet},o.defaultDateTimeNumberStringConverter=new ct,o.YearTwoDigit="yy",o.YearSingleDigit="y",o.YearFourDigit="yyyy",o.MonthSingleDigit="m",o.MonthTwoDigit="mm",o.MonthAbbreviation="mmm",o.MonthUnabbreviated="mmmm",o.MonthJD="mmmmm",o.DaySingleDigit="d",o.DayTwoDigit="dd",o.DayWeekDayAbbreviation="aaa",o.DayWeekDayUnabbreviated="aaaa",o.HoursSingleDigit="h",o.HoursTwoDigit="hh",o.MinuteSingleDigit="m",o.MinuteTwoDigit="mm",o.SecondSingleDigit="s",o.SecondTwoDigit="ss",o.SubSecondSingleDigit=".0",o.SubSecondTwoDigit=".00",o.SubSecondThreeDigit=".000",o.EraYear="e",o.AMPMTwoDigit="AM/PM",o.AMPMSingleDigit="A/P",o.StandardYearSingleDigit="%y",o.StandardMonthSingleDigit="%M",o.StandardMonthTwoDigit="MM",o.StandardMonthAbbreviation="MMM",o.StandardMonthUnabbreviated="MMMM",o.StandardAMPMSingleDigit="tt",o.StandardMinuteSingleDigit="%m",o.StandardHourSingleDigit="H",o.StandardHourTwoDigit="HH",o.StandardSecondSingleDigit="%s",o.StandardSubSecondSingleDigit=".f",o.StandardSubSecondTwoDigit=".ff",o.StandardSubSecondThreeDigit=".fff",o.StandardDayWeekDayAbbreviation="ddd",o.StandardDayWeekDayUnabbreviated="dddd",o.PlaceholderMonthJD=i.ReplacePlaceholder+"mmmmm",o.defaultAbsoluteTime=new Date(1899,11,30,0,0,0,0),o.keyWords=[o.YearSingleDigit,o.YearTwoDigit,o.YearFourDigit,o.MonthSingleDigit,o.MonthTwoDigit,o.MonthAbbreviation,o.MonthUnabbreviated,o.MonthJD,o.DaySingleDigit,o.DayTwoDigit,o.DayWeekDayAbbreviation,o.DayWeekDayUnabbreviated,o.HoursSingleDigit,o.HoursTwoDigit,o.MinuteSingleDigit,o.MinuteTwoDigit,o.SecondSingleDigit,o.SecondTwoDigit,"ggg","gg","g","ee","e"],o}(u),kt=function(){function n(){}return n.prototype.ConvertTo=function(n,i,r,u,f){if(u!=t&&f!=t){var e=u.GetDBNumber(f.Type());if(e!=t)return f.ReplaceNumberString(n,e,r)}return n},n}(),w=function(f){function e(e,o,s,h){var c,l,p,w,v,a,y;f.call(this,o,s,h);this.baseNumberStringConverter=u.prototype.NumberStringConverter;this.baseNumberFormatInfo=u.prototype.NumberFormatInfo;this.baseCultureName=u.prototype.CultureName;c=this;c.numberFormatString=t;c.fullFormatString=t;c.isGeneralNumber=!1;c.fractionIntegerFormat=t;c.fractionNumeratorFormat=t;c.fractionDenominatorFormat=t;c.excelFormatString=r.Empty;c._classNames.push("NumberFormatDigital");l=u.TrimNotSupportSymbol(e);c.fullFormatString=i.Filter(e,i.LeftSquareBracket,i.RightSquareBracket);c.excelFormatString=l;o&&(p=l,l=i.ReplaceKeyword(p,c.PartLocaleID().OriginalToken(),c.PartLocaleID().CurrencySymbol()));c.PartDBNumberFormat()&&(c.excelFormatString=i.ReplaceKeyword(c.excelFormatString,c.PartDBNumberFormat().OriginalToken(),c.PartDBNumberFormat().toString()));l=i.Filter(l,i.LeftSquareBracket,i.RightSquareBracket);w=l.indexOf(i.SolidusSign);w>-1&&(l=n.StringHelper.Replace(l,"\\"+i.QuestionMark,i.Zero),v=l.split(i.SolidusSign),v&&v.length===2&&(c.fractionDenominatorFormat=v[1],a=v[0],a&&(y=a.lastIndexOf(i.Space),y>-1?(c.fractionIntegerFormat=a.substr(0,y),c.fractionNumeratorFormat=a.substr(y+1,a.length-y-1)):c.fractionNumeratorFormat=a)));c.numberFormatString=l}return __extends(e,f),e.prototype.NumberStringConverter=function(n){var t=this;return arguments.length===0?t.baseNumberStringConverter()?t.baseNumberStringConverter():e.defaultNumberStringConverter:(t.baseNumberStringConverter(n),n)},e.prototype.FormatString=function(){return this.fullFormatString},e.prototype.NumberFormatInfo=function(t){var r=this;return arguments.length===0?r.baseNumberFormatInfo()?r.baseNumberFormatInfo():r.PartLocaleID()&&r.PartLocaleID().CultureInfo()?r.PartLocaleID().CultureInfo().NumberFormat():r.baseCultureName()?n._CultureInfo.getCulture(r.baseCultureName()).NumberFormat():i.NumberFormatInfo():(r.baseNumberFormatInfo(t),t)},e.prototype.IsGeneralNumber=function(n){return arguments.length===0?this.isGeneralNumber:(this.isGeneralNumber=n,n)},e.prototype.ExcelCompatibleFormatString=function(){return this.excelFormatString},e.prototype.Format=function(u){var f,l,g,o,y,it,w,a,k,ut,v,b;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();if(f=this,l=n.FormatConverter.ToDouble(u),isNaN(l)||!isFinite(l)||isNaN(u))return typeof u=="string"?u:t;if(g=f.NaNSymbol(),o=t,y=f.CultureName()?n._CultureInfo.getCulture(f.CultureName()):n._CultureInfo._currentCulture,f.fractionNumeratorFormat&&f.fractionDenominatorFormat){var p={value:0},s={value:0},h={value:0},ft=f.fractionDenominatorFormat.length;if(e.GetFraction(l,ft,p,s,h))if(it=f.GetGCD(s.value,h.value),it>1&&(s.value/=it,h.value/=it),f.fractionIntegerFormat){if(o="",h.value===1&&(p.value+=s.value,s.value=0,h.value=0),p.value!==0&&(o+=new n._NumberHelper(p.value).customCultureFormat(f.fractionIntegerFormat,y),o+=i.Space),p.value===0&&l<0&&(o+=i.negativeSign),l===0&&(o+="0"),w=f.fractionDenominatorFormat,a=parseFloat(w),isNaN(a)||a>0&&(s.value*=a/h.value,w=r.Empty,h.value=a,v=c(s.value),b=v-s.value,s.value=b<=.5&&b>=0?parseFloat(v.toString()):parseFloat((v-1).toString())),k=f.fractionNumeratorFormat,ut=parseFloat(k),!isNaN(ut)&&ut===0){var nt=k.length,rt=s.value.toString(),tt=rt.length;nt>tt?k=k.substr(0,nt-(nt-tt)):nt<tt&&(rt=rt.substr(0,tt-(tt-nt)),s.value=parseInt(rt,10))}return s.value!==0&&(o+=new n._NumberHelper(s.value).customCultureFormat(k,y).replace(/^0*/,""),o+=i.SolidusSign,o+=new n._NumberHelper(h.value).customCultureFormat(w,y).replace(/^0*/,"")),o===""?"0":o}else{o="";var d=p.value*h.value+s.value,w=f.fractionDenominatorFormat,a=parseFloat(w);return a>0?(d*=a/h.value,w=r.Empty,h.value=a,v=c(d),b=v-d,d=b<=.5&&b>=0?parseFloat(v.toString()):parseFloat((v-1).toString()),o+=d+i.SolidusSign+h.value):(o+=new n._NumberHelper(d).customCultureFormat(f.fractionNumeratorFormat,y).replace(/^0*/,""),o+=i.SolidusSign,o+=new n._NumberHelper(h.value).customCultureFormat(f.fractionDenominatorFormat,y).replace(/^0*/,"")),o===""?"0":o}else return l.toString()}else g=new n._NumberHelper(l).customCultureFormat(f.EncodeNumberFormat(f.numberFormatString),y),f.NumberStringConverter()&&(g=f.NumberStringConverter().ConvertTo(g,u,f.isGeneralNumber,f.PartLocaleID(),f.PartDBNumberFormat()));return g},e.prototype.Parse=function(u){var e=this,d,g,w,c,l,b,k,rt,tt,ut,f,a,ft,it;if(u=e.TrimSpecialSymbol(u),u=e.TrimCurrencySymbol(u),!u||u===r.Empty)return t;if(d=i.numberGroupSeparator,n.StringHelper.EndsWith(u,d)&&!isNaN(u.substr(0,u.length-d.length)))return u;if(g=p.FixJapaneseChars(u),u.toLowerCase()==="true")return!0;else if(u.toLowerCase()==="false")return!1;var s=i.IsDecimal(g,e.NumberFormatInfo()),nt=n.StringHelper.IndexOf(g,i.ExponentialSymbol,1),h=nt>-1;if(e.numberFormatString){if(w={value:0},u=e.TrimPercentSign(u,w),c=u,h&&(c=u.substr(0,nt)),c[0]===i.NumberFormatInfo().positiveSign&&(c=c.substr(1),u=u.substr(1)),l=n.StringHelper.Replace(c,i.numberGroupSeparator,""),b=l.indexOf(i.DecimalSeparator),b===l.lastIndexOf(i.DecimalSeparator)){if(k="#,##0",b!==-1)for(k+=".",rt=l.length-b-1,tt=0;tt<rt;tt++)k+="0";ut=new y(k).Format(l);ut===c&&(u=h?l+u.substr(nt):l)}if(f=parseFloat(u),a=t,f.toString()!==u&&(ft=e.NumberFormatInfo(),it=i.DecimalSeparator,s||h?s&&!h?a=new RegExp("^((\\+|-)?\\d*)"+it+"(\\d*)$","ig"):!s&&h?a=new RegExp("^((\\+|-)?\\d+)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig"):s&&h&&(a=new RegExp("^((\\+|-)?\\d*)"+it+"(\\d*)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig")):a=new RegExp("^((\\+|-)?\\d+)$","ig")),!isNaN(f)&&isFinite(f)&&(!a||a.test(u)))return w.value>0&&(f=f/parseFloat((100*w.value).toString())),f!==0&&o(f-v(f))!==0&&(s=!0),h&&(s=!0),e.ToObject(f,s)}return t},e.prototype.EncodeNumberFormat=function(n){var i,r,t;if(n){for(i=n.split(""),r="",t=0;t<i.length-1;)i[t]==="\\"?(r+=i[t+1],t+=2):(r+=i[t],t++);t===i.length-1&&i[t]!=="\\"&&(r+=i[t]);n=r}return n},e.prototype.ToObject=function(n,t){return t?n:n<=1e22?n:n},e.prototype.TrimPercentSign=function(t,u){if(u.value=0,!t||t===r.Empty)return t;var f=t,e=i.percentSymbol,o=t.indexOf(e);return o===t.length-1&&o===t.lastIndexOf(e)&&(f=n.StringHelper.Replace(f,e,""),u.value+=(t.length-f.length)/e.length),f},e.prototype.TrimSpecialSymbol=function(t){var u,h,e,c,o,f,s;if(!t||t===r.Empty)return t;for(u=t,h=-1,e=0;e<u.length;e++)if(a.IsDigit(u[e])){h=e;break}for(c=-1,o=u.length-1;o>-1;o--)if(a.IsDigit(u[o])){c=o;break}for(f=u.length-1;f>-1;f--)if(s=u[f],this.IsSpecialSymbol(s))a.IsWhiteSpace(s)?(f<h||c<f)&&(u=n.StringHelper.Remove(u,f,1)):u=n.StringHelper.Remove(u,f,1);else if((s==="-"||s==="+")&&f>0&&u[f-1]!=="e"&&u[f-1]!=="E"&&u[f-1]!=="("&&u[f-1].toString()!==i.NumberFormatInfo().currencySymbol)break;return u},e.prototype.IsStandardNumberSymbol=function(n){var t=this.NumberFormatInfo()?this.NumberFormatInfo():i.NumberFormatInfo(),r;return t&&(r=n.toString(),r===t.currencyDecimalSeparator||r===t.currencyGroupSeparator||r===t.currencySymbol||r===t.nanSymbol||r===t.negativeInfinitySymbol||r===t.negativeSign||r===t.numberDecimalSeparator||r===t.numberGroupSeparator||r===t.percentDecimalSeparator||r===t.percentGroupSeparator||r===t.percentSymbol||r===t.perMilleSymbol||r===t.positiveInfinitySymbol||r===t.positiveSign)?!0:!1},e.prototype.IsSpecialSymbol=function(n){return this.IsStandardNumberSymbol(n)?!1:a.IsWhiteSpace(n)?!0:!1},e.prototype.TrimCurrencySymbol=function(n){var t,r,u;return n?(t=this.NumberFormatInfo()?this.NumberFormatInfo():i.NumberFormatInfo(),t&&(r=t.currencySymbol,u=n.toString().indexOf(r),u===0&&u===n.lastIndexOf(r)&&(n=n.substr(1))),n):n},e.keyWordsSet=function(){var n=e,i,t;if(!n._keyWordsSet){for(i={},t=0;t<n.keywords.length;t++)i[n.keywords[t]]=!0;n._keyWordsSet=i}return n._keyWordsSet},e.EvaluateFormat=function(n){return u.ContainsKeywords(n,e.keywords,e.keyWordsSet())},e.GetFraction=function(n,t,i,r,u){return p.GetFraction(n,t,i,r,u)},e.prototype.GetGCD=function(n,t){if(n==0)return o(t);if(t==0)return o(n);for(var r=lt(n,t),i=at(n,t),u=r%i;u!=0;)r=i,i=u,u=r%i;return o(i)},e.defaultNumberStringConverter=new kt,e.keywords=[i.Exponential1,i.Exponential2,i.NumberSign,i.DecimalSeparator,i.numberGroupSeparator,i.percentSymbol,i.Zero,i.SolidusSign],e}(u),e=function(e){function s(r,f,o,h){if(e.call(this,f,o,h),this.digitalFormat=t,this.exponentialDigitalFormat=t,this.fullFormatString=t,this._classNames.push("NumberFormatGeneral"),arguments.length>0)if(s.EvaluateFormat(r)){if(r.indexOf(i.Zero)>=0||r.indexOf(i.NumberSign)>=0||r.indexOf(i.DecimalSeparator)>=0||r.indexOf(i.CommercialAt)>=0)throw n.SR.Exp_FormatIllegal;this.fullFormatString=r}else throw n.SR.Exp_FormatIllegal;else this.fullFormatString=u.General}return __extends(s,e),s.prototype.DigitalFormat=function(){var n=this,t;return n.digitalFormat||(t=n.fullFormatString,t=i.ReplaceKeyword(t,u.General,s.GeneralNumber),n.digitalFormat=new w(t,n.PartLocaleID(),n.PartDBNumberFormat(),n.CultureName()),n.digitalFormat.IsGeneralNumber(!0)),n.digitalFormat},s.prototype.ExponentialDigitalFormat=function(){var n=this;return n.exponentialDigitalFormat||(n.exponentialDigitalFormat=new w("0.#####E+00",n.PartLocaleID(),n.PartDBNumberFormat(),n.CultureName()),n.exponentialDigitalFormat.IsGeneralNumber(!0)),n.exponentialDigitalFormat},s.prototype.FormatString=function(){return n.StringHelper.Replace(this.fullFormatString,s.GeneralPlaceholder,u.General)},s.prototype.Format=function(r){var e=this,h,u,s;if(n.FormatConverter.IsNumber(r)){if(h=e.PartLocaleID()?e.PartLocaleID().AllowScience():!0,u=n.FormatConverter.ToDouble(r),u!==f&&u!==t)return o(u)>99999999999&&h||o(u)<1e-11&&u!==0?e.ExponentialDigitalFormat().Format(r):e.DigitalFormat().Format(r)}else if(n.util.isType(r,"string"))return(s=n.StringHelper.Replace(e.FormatString(),'"',""),s=i.TrimEscape(s),s)?n.StringHelper.Replace(s,"General",r):r;else if(n.util.isType(r,"boolean"))return r.toString().toUpperCase();return""},s.prototype.Parse=function(u){var c,l,a,v;if(r.IsNullOrEmpty(u))return t;if(c=!1,l=n.StringHelper.IndexOf(u,"-"),l>0&&(i.IsEquals(u.charAt(l-1),i.ExponentialSymbol,!0)||(c=!0)),(n.StringHelper.Contains(u,"/")||c||n.StringHelper.Contains(u,":")||n.StringHelper.Contains(u,"-"))&&(a=n._DateTimeHelper.parseLocale(u),a))return a;var s=u,e=t,h=t;if(s.charAt(0)===i.negativeSign?h=!0:s.charAt(0)===i.NumberFormatInfo().positiveSign&&(h=!1),v=!1,h&&s.length>3&&s.charAt(1)===i.LeftParenthesis&&s.charAt(s.length-1)===i.RightParenthesis&&(v=!0),h&&v){if(e=this.DigitalFormat().Parse(n.StringHelper.Remove(u,0,1)),e)return n.util.isType(e,"number")?o(e)*(h?-1:1):e}else if(e=this.DigitalFormat().Parse(u),e!==f&&e!==t)return e;return u},s.GeneralMonthDay=function(){return["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"]},s.GeneralYearMonth=function(){return["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"]},s.GeneralYearMonthDay=function(){return["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"]},s.GeneralHourMinute=function(){return["H:m","h:m tt"]},s.GeneralHourMinuteWithDate=function(){return["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"]},s.GeneralHourMinuteSecond=function(){return["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"]},s.GeneralHourMinuteSecondSubSecond=function(){return["H:m:s.FFF","h:m:s.FFF tt"]},s.GeneralHourMinuteSecondWithDate=function(){return["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"]},s.GeneralHourMinuteSecondSubSecondWithDate=function(){return["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]},s.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var t=u;return t.ContainsKeywords(n,t._keywords,t._keywordsSet)},s.GeneralPlaceholder="@NumberFormat",s.GeneralNumber="##################0.################",s}(u),dt=function(){function n(n,t){this.formatCached=n;this.cultureName=t;this.typeName=""}return n.prototype.Format=function(n,i){return t},n.prototype.Parse=function(n){return t},n.prototype.FormatString=function(){return this.formatCached},n.prototype.toJSON=function(){var t={};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},n.prototype.fromJSON=function(n){if(n)for(var t in n)n[t]!==f&&(this[t]=n[t])},n}();n.CustomFormatterBase=dt})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
