<div class="create-free-text-backdrop absolute-size full-width full-height" ng-click="createRawData.hideFreeText()"></div>



<!--Create from drag and drop / paste raw data STEP 1-->
<div flow-name="createRawData.fileData" flow-init=""
     flow-file-added="createRawData.checkFileExtension($file)"
     flow-drop flow-drop-enabled="!createRawData.pasteData"
     flow-drop ng-class="dropClass2"
     flow-drag-enter="dropClass2='drop-zone-border'" flow-drag-leave="dropClass2='drop-zone-border-transparent'"
     class="create-free-text-wrapper absolute" ng-show="createRawData.step === 1">

    <label class="lg-font sm-padding sm-top-margin" ng-class="{'drop-opacity': dropClass2==='drop-zone-border'}">
        Drag and Drop File(s) or Copy Paste Data Below
        <i class="fa fa-chevron-down"></i>
    </label>

    <div ng-show="dropClass2==='drop-zone-border'" class="full-width center drop-zone-label">
        Drop Files Here
    </div>

    <div class="create-free-text-content absolute left right sm-margin"
         ng-class="{'drop-opacity': dropClass2==='drop-zone-border'}">

        <div class="create-free-text-drop absolute" ng-show="!createRawData.pasteData">
            <div class="drop-title">
                 <span flow-btn
                       class="btn-green md-btn full-width pointer-cursor drop-btn md-top-margin md-z-index pos-relative"
                 ><span>Browse Files</span></span>
            </div>
        </div>

        <div class="absolute-size" ng-show="createRawData.fileData.files.length > 0">
            <div ng-repeat="file in createRawData.fileData.files" class="gallery-box">
                <span class="title">{{file.name}}</span>

                <div class="btn-group">
                    <a class="btn btn-xs btn-danger" style="margin-left:10px"
                       ng-click="file.cancel()">
                        Remove
                    </a>
                </div>
            </div>
        </div>

        <textarea class="full-height full-width" ng-model="createRawData.pasteData" ng-trim="false"></textarea>

    </div>


    <div class="create-free-text-footer left absolute right bottom border-top"
         ng-class="{'drop-opacity': dropClass2==='drop-zone-border'}">
        <button class="sm-btn btn-light pull-left sm-margin smmd-top-margin"
                ng-click="createRawData.hideFreeText()">
            Cancel
        </button>

        <button class="sm-btn btn-light pull-right xs-margin smmd-top-margin" ng-click="createRawData.parseData()"
                ng-class="{'disabled':!createRawData.pasteData&&!createRawData.fileData.files.length > 0}">Next
        </button>

        <button class="sm-btn btn-light pull-right xs-margin smmd-top-margin"
                ng-click="createRawData.showAdvancedOptions = !createRawData.showAdvancedOptions"> Advanced
            Options
        </button>

        <div ng-show="createRawData.showAdvancedOptions">
            <input type="text" class="pull-right create-free-text-form-control inline sm-margin"
                   placeholder="Choose a Delimiter (optional)"
                   ng-model="createRawData.delimiter">
            <label class="pull-right md-top-margin no-bot-margin"> Delimiter </label>
        </div>
    </div>
</div>


<!--Create from drag and drop / paste raw data STEP 2-->
<div class="create-free-text-wrapper absolute" ng-show="createRawData.step === 2">

    <div class="grid12">
        <label class="lg-font sm-padding sm-top-margin">
            Data Selection
        </label>
        <div class="inline pull-right sm-top-margin sm-padding red-font"
             ng-show="!createRawData.cleanHeaders">
            Errors in the column names. See below for more details
        </div>

    </div>

    <!--<div class="create-free-text-engine-name pull-right md-top-padding md-right-padding" ng-show="createRawData.importType !== 'web'">-->
        <!--<label>Enter Database name: <input ng-change="createRawData.updateValidDB()" type="text" ng-model="createRawData.engineName"></label>-->
    <!--</div>-->

    <div class="create-free-text-content absolute left right sm-margin overflow-auto">
        <!--<div ng-show="createRawData.fileData.files.length > 1 || createRawData.insightId !== 'new'">-->
       <div ng-show="false">
            <label>Table Joins: </label>
            <div ng-repeat="(key, value) in createRawData.tableJoins">
                <div>
                    {{key}}:
                    <i class="fa fa-plus pointer" ng-click="createRawData.addTableJoin(key)"></i>
                </div>
                <div ng-repeat="join in value">
                    <select class="quarter-width"
                            ng-options="header.title as header.name for header in join.existingConcept.headers"
                            ng-model="join.existingConcept.selected">
                        <option value="">--Select Existing Columns--</option>
                    </select>
                    <select class="quarter-width"
                            ng-options="item.value as item.display for item in join.joinType.options"
                            ng-model="join.joinType.selected">
                        <option value="">--Select Join Type--</option>
                    </select>
                    <select class="quarter-width"
                            ng-options="header2.title as header2.name for header2 in join.newConcept.headers"
                            ng-model="join.newConcept.selected">
                        <option value="">--Select New Columns--</option>
                    </select>
                    <i class="fa fa-minus pointer" ng-hide="value.length === 1"
                       ng-click="createRawData.removeTableJoin(key, $index)"></i>
                </div>
            </div>
        </div>

        <div class=""
             ng-class="{'create-free-text-data-selection':!createRawData.isEmpty(createRawData.addedNodes)}">
            <div ng-repeat="sheet in createRawData.headerData track by $index" class="sm-margin no-top-margin">

                <div class="lg-font sm-btm-margin"
                     ng-class="{'md-top-margin': $index > 0}"
                     ng-show="sheet.fileName && ($index === 0 || sheet.fileName !== createRawData.headerData[$index-1].fileName)">
                    File Name: {{sheet.fileName}}
                </div>

                <div class="grid12 create-free-text-dropdown">
                    <div class="grid5 bold" ng-click="sheet.open = !sheet.open">
                        <i class="fa" ng-class="{'fa-caret-down': sheet.open, 'fa-caret-right': !sheet.open}"></i>
                        {{sheet.title}}
                    </div>


                    <!--<div class="grid3" ng-if="sheet.open">-->
                        <!--<div class="pull-right">-->
                        <!--Select Column To Bind On:-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<div class="grid4" ng-if="sheet.open">-->
                        <!--<select class="full-width pull-right"-->
                                <!--ng-options="header.title as header.title for header in sheet.headers | filter:header.selected='true'"-->
                                <!--ng-model="sheet.mainColumn">-->
                            <!--<option value="">&#45;&#45;Select Connection Option&#45;&#45;</option>-->
                        <!--</select>-->
                    <!--</div>-->
                </div>


                <div ng-if="sheet.open">
                    <div class="create-free-text-name sm-left-padding inline bold">
                        Column Name
                    </div>
                    <div class="create-free-text-type center inline bold">
                        Data Type
                    </div>
                    <div class="create-free-text-hide center inline bold">
                        Hide
                    </div>

                    <div ng-repeat="header in sheet.headers track by $index">
                        <div class="inline create-free-text-name sm-left-padding overflow-ellipsis"
                             ng-class="{'disabled': !header.selected}"
                             ng-show="false">
                            {{header.title}}
                        </div>

                        <!--header.title === createRawData.changedHeaders[$parent.$index][$index][1]-->
                        <div class="inline create-free-text-name sm-left-padding overflow-ellipsis"
                             ng-class="{'disabled': !header.selected}"
                             ng-show="true">
                            <input type="text" class="create-free-text-form-control-col inline sm-margin"
                                   ng-model="header.title"
                                   ng-change="createRawData.changedHeaderName = true">
                            <div class="inline red-font pointer"
                                 ng-show="header.invalidHeader"
                                 ng-mouseover="header.showInvalidHeaderReason = true"
                                 ng-mouseleave="header.showInvalidHeaderReason = false">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                            <div class="inline orange-font pointer"
                                 ng-show="header.modifiedHeader && header.title === header.originalTitle"
                                 ng-mouseover="header.showModifiedHeaderReason = true"
                                 ng-mouseleave="header.showModifiedHeaderReason = false">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                        </div>

                        <div class="display-invalid-header-reason" ng-show="header.showInvalidHeaderReason">
                            {{header.invalidHeader}}
                        </div>

                        <div class="display-invalid-header-reason" ng-show="header.showModifiedHeaderReason">
                            {{header.modifiedHeader}}
                        </div>

                        <div class="inline create-free-text-type" ng-class="{'disabled': !header.selected}">
                            <button class="btn-flat" ng-class="{'btn-flat-selected':header.type ==='STRING'}"
                                    ng-click="header.type = 'STRING'">
                                <i class="fa fa-font"></i> String
                            </button>
                            <button class="btn-flat" ng-class="{'btn-flat-selected':header.type ==='DOUBLE'}"
                                    ng-click="header.type = 'DOUBLE'">
                                <i class="fa fa-hashtag"></i> Number
                            </button>
                            <button class="btn-flat" ng-class="{'btn-flat-selected':header.type ==='DATE'}"
                                    ng-click="header.type = 'DATE'">
                                <i class="fa fa-calendar"></i> Date
                            </button>
                        </div>
                        <button class="btn-flat create-free-text-hide inline"
                                ng-click="header.selected = !header.selected">
                            <i class="fa" ng-class="{'fa-plus': !header.selected, 'fa-times':header.selected}"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!--- Comment out Till Functionality Exists -->
        <!--<div class="create-free-text-connections absolute" ng-if="!createRawData.isEmpty(createRawData.addedNodes)">
            <div class="grid12 bold">
                Select Column To Connect On
            </div>
            <div class="grid5">
                <select class="font-family xs-top-margin ng-pristine full-width form-control"
                        ng-options="v as k for (k, v) in createRawData.addedNodes"
                        ng-model="createRawData.connectionFrom">
                    <option value="">&#45;&#45;Select Connection Option&#45;&#45;</option>
                </select>
            </div>
            <div class="grid2 center">
                To
            </div>
            <div class="grid5">
                <select class="font-family xs-top-margin ng-pristine full-width form-control"
                        ng-options="header.title as header.title for header in createRawData.tableHeaders | filter:chart.selected='true'"
                        ng-model="createRawData.connectionTo">
                    <option value="">&#45;&#45;Select Connection Option&#45;&#45;</option>
                </select>
            </div>
        </div>-->
    </div>


    <div class="create-free-text-footer left absolute right bottom border-top">
        <button class="sm-btn btn-light pull-left sm-margin smmd-top-margin"
                ng-click="createRawData.navigateToFirstStep()">
            Back
        </button>

        <!--createRawData.isEmpty(createRawData.engineName) || !isValidDB-->

        <button class="sm-btn btn-light pull-right sm-margin smmd-top-margin"
                ng-disabled="createRawData.checkValidJoins()"
                ng-click="createRawData.checkHeaders()">
            Load
        </button>

    </div>


</div>