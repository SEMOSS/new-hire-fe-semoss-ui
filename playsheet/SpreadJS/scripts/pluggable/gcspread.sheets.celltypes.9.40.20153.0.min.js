/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){var gi,nr,tr,ii,ir,ri,ui,fi;n.feature("celltype",["core.common","core.sheet_action","core.basecelltype"]);var cr="undefined",t=null,i=undefined,l=Math.max,bt=Math.min,ht=Math.floor,hi=Math.round,r=window.document,s="position",h="absolute",tt="margin",c="font",u="left",at="right",e="top",lr="bottom",vt="alphabetic",ar="middle",kt="center",d="gcUIElement",et="tabindex",a="none",w="0",ci="#F6FAFB",li="#D2DBEB",v=".gcEditingInput",dt="keydown"+v,gt="keyup"+v,ni="mousedown"+v,ti="mouseup"+v,ai="mouseout"+v,vi="mousemove"+v,yi="click"+v,b="width",y="height",ot="padding",it="hidden",vr="visibility",yr="word-wrap",rt="overflow",yt="resize",ut="border",ft="outline",pt="box-shadow",g="box-sizing",k="color",pi="border-width",wi="border-style",bi="border-color",ct="white-space",f="background-color",st="z-index",ki="max-width",di="max-height";(function(n){n[n.Text=0]="Text";n[n.Index=1]="Index";n[n.Value=2]="Value"})(n.EditorValueType||(n.EditorValueType={}));gi=n.EditorValueType,function(n){n[n.top=0]="top";n[n.bottom=1]="bottom";n[n.left=2]="left";n[n.right=3]="right"}(n.CheckBoxTextAlign||(n.CheckBoxTextAlign={}));nr=n.CheckBoxTextAlign,function(n){n[n.Blank=0]="Blank";n[n.Self=1]="Self";n[n.Parent=2]="Parent";n[n.Top=3]="Top"}(n.HyperLinkTargetType||(n.HyperLinkTargetType={}));tr=n.HyperLinkTargetType;ii=function(o){function v(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="5";n._checkboxSize=12;n._caption="";n._textTrue="";n._textIndeterminate="";n._textFalse="";n._textAlign=3;n._isThreeState=!1}return __extends(v,o),v.prototype.paintValue=function(r,f,e,o,s,h,c,l){var et,rt;if(r){r.save();r.rect(e,o,s,h);r.clip();r.beginPath();var y=this,d=this.getText(f,l),g=0,p=0,ft=l.sheet;ft&&(g=ft._getStringWidthByCanvas(d,c.font),p=ft._getFontHeight(c.font),d&&(et=d.split(/\r\n|\r|\n/),p*=et.length));var a=y._checkboxSize/2,ot=new n.Rect(++e,++o,--s,--h),w=parseInt((e+y._getCheckBoxLeft(c,ot,g)).toString()),v=parseInt((o+y._getCheckBoxTop(c,ot,p)).toString()),it=u,nt=w+1;c.hAlign===1?(it=kt,nt+=a):c.hAlign===2&&(it=at,nt+=a*2);rt=c.font;rt&&r.font!==rt&&(r.font=rt);c.foreColor&&(r.fillStyle=c.foreColor);var b=c.textDecoration,tt=l.fontInfo.fontSize,ut=tt>8?ht((tt-8)/5+2):1,k=p/2-tt/2+ut-1;r.textBaseline!==vt&&(r.textBaseline=vt);y._textAlign===2?(r.textAlign=at,r.fillText(d,w+1-2,v+a+p/2-k),b&&y._renderTextDecoration(r,b,w+1-2,v+a+p/2-k,g,tt,ut)):y._textAlign===0&&(r.textAlign=it,r.fillText(d,nt,v-2-k),b&&y._renderTextDecoration(r,b,nt,v-2-k,g,p));r.save();r.strokeStyle="black";r.strokeRect(w+.5,v+.5,a*2+.05,a*2+.05);r.fillStyle="white";r.fillRect(w+1,v+1,a*2-1,a*2-1);y._isThreeState&&(f===t||f===i)?(r.beginPath(),r.fillStyle="green",r.rect(w+3,v+3,(a-2.5)*2,(a-2.5)*2),r.fill()):!!f==!0&&(r.beginPath(),r.lineWidth=2.5,r.moveTo(w+3,v+a),r.lineTo(w+a,v+a*2-3.5),r.lineTo(w+a*2-1.5,v+3),r.stroke());r.restore();c.foreColor&&(r.fillStyle=c.foreColor);y._textAlign===3?(r.textAlign=u,r.fillText(d,w+1+a*2+2,v+a+p/2-k),b&&y._renderTextDecoration(r,b,w+1+a*2+2,v+a+p/2-k,g,tt,ut)):y._textAlign===1&&(r.textAlign=it,r.fillText(d,nt,v+a*2+2+p-k),b&&y._renderTextDecoration(r,b,nt,v+a*2+2+p-k,g,tt,ut));r.restore()}},v.prototype.getText=function(n,t){return this._getDisplayText(n)},v.prototype.focus=function(n,t){n&&n.focus()},v.prototype._formatEditorValue=function(n,t,i,r){return i},v.prototype._getCheckBoxLeft=function(t,i,r,u){var f=i.x-1,s=i.width+1,h=0,e=0,o=this,c;return o._textAlign===0||o._textAlign===1?(e=f+5,t.hAlign===1?e=f+s/2-o._checkboxSize/2:t.hAlign===2&&(e=f+s-5-o._checkboxSize)):o._textAlign===2?(h=o._checkboxSize+r,e=f+5+r,t.hAlign===1?e=f+s/2-h/2+r:t.hAlign===2&&(e=f+s-5-h+r)):(h=o._checkboxSize+r,e=f+5,t.hAlign===1?e=f+s/2-h/2:t.hAlign===2&&(e=f+s-5-h)),c=e-f,u&&n.util.browser.msie&&(c-=3),c},v.prototype._getCheckBoxTop=function(t,i,r,u){var f=i.y-1,o=i.height+1,s=0,e=0,h=this,c;return h._textAlign===0?(s=h._checkboxSize+r,e=f+5+r,t.vAlign===1?e=f+o/2-s/2+r:t.vAlign===2&&(e=f+o-5-s+r)):h._textAlign===1?(s=h._checkboxSize+r,e=f+5,t.vAlign===1?e=f+o/2-s/2:t.vAlign===2&&(e=f+o-5-s)):(e=f+5,t.vAlign===1?e=f+o/2-h._checkboxSize/2:t.vAlign===2&&(e=f+o-5-h._checkboxSize)),c=e-f,u&&n.util.browser.msie&&(c-=3),c},v.prototype.createEditorElement=function(t){var l=r.createElement("div"),v=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,p=n.util.getPreferredZIndex(v)+1e3,i=n.GC$(l),u,e,o;return i.css(s,h).css(tt,w).css(ot,w).css(rt,it).css(yt,a).css(ut,"2px #5292f7 solid").css(ft,a).css(pt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css(st,p).attr(et,1).attr(d,"gcEditingInput"),u=n.GC$(r.createElement("input")),u.attr("type","checkbox"),i.append(u),e=n.GC$(r.createElement("span")),e.css(s,h).css(c,"normal 11pt calibri").css("cursor","default").css(ct,"nowrap"),i.append(e),o=n.GC$(r.createElement("div")),o.css(s,h).css(f,"green").css(b,(this._checkboxSize/2-2.5)*2).css(y,(this._checkboxSize/2-2.5)*2),i.append(o),l},v.prototype._getNextState=function(n){return this._isThreeState?n===t||n===i?!1:!!n==!0?t:!0:!n},v.prototype.setEditorValue=function(r,u,f){if(r&&r.children[0]&&r.children[1]&&r.children[2]){var e=f&&f.sheet&&f.sheet._startEditByKeydown;e||(u=this._getNextState(u));this._isThreeState?u===t||u===i?(r.children[0].checked=!1,n.GC$(r.children[2]).show()):(r.children[0].checked=!!u,n.GC$(r.children[2]).hide()):r.children[0].checked=!!u;n.GC$(r.children[1]).text(this._getDisplayText(u))}},v.prototype.getEditorValue=function(i,r){return i&&i.children[0]&&i.children[1]&&i.children[2]?this._isThreeState?n.GC$(i.children[2]).isVisible()?t:i.children[0].checked:i.children[0].checked:t},v.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r})},v.prototype.activateEditor=function(t,i,r,o){var h=t&&o&&o.sheet,s;if(h){var c=n.GC$(t),l=h._eventHandler._getCanvasPosition(),a=h.getBounds();c.css(e,l.top+a.y+r.y-2).css(u,l.left+a.x+r.x-2).css(f,i.backColor?i.backColor:"white");s=this;c.bind(ni,function(t){n.util.cancelDefault(t)});c.bind(ti,function(n){var u=s.getEditorValue(t,o);s.setEditorValue(t,u,o);s.updateEditor(t,i,r,o);s._triggerButtonClicked(h,h._activeRowIndex,h._activeColIndex,o.sheetArea)});c.bind(dt,function(t){if(t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey)t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t);else return s._isKeyDown=!0,n.util.cancelDefault(t),!1});c.bind(gt,function(n){if(s._isKeyDown&&n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey){s._isKeyDown=!1;var u=s.getEditorValue(t,o);s.setEditorValue(t,u,o);s.updateEditor(t,i,r,o);s._triggerButtonClicked(h,h._activeRowIndex,h._activeColIndex,o.sheetArea)}});t.children[0]&&n.GC$(t.children[0]).bind("click",function(t){n.util.cancelDefault(t)})}},v.prototype.updateEditor=function(i,r,f,o){var a=i&&o&&o.sheet,w,g,v,y,b,ut,l,p,ft,et;if(a){n.GC$(i).width(f.width).height(f.height);var ot=n.GC$(i),nt=a._render,tt=a._eventHandler._getCanvasPosition(),it=a.getBounds();ot.css(e,tt.top+it.y+f.y-2).css(u,tt.left+it.x+f.x-2);var s=i.children[0],rt=i.children[1],d=i.children[2];if(s&&rt&&d){w=n.GC$(rt);g=w.text();r.foreColor&&w.css(k,r.foreColor);v=t;v=r.font?r.font:nt._getDefaultFont();a._zoomFactor>1&&(v=nt._getZoomFont(v));w.css(c,v);y=a._getStringWidth(g,v);b=a._getFontHeight(v);g&&(ut=g.split(/\r\n|\r|\n/),b*=ut.length);var h=this,st=h._getCheckBoxLeft(r,f,y,!0),ht=h._getCheckBoxTop(r,f,b,!0);n.GC$(s).css("margin-left",st).css("margin-top",ht);l=0;p=0;h._textAlign===0?(l=s.offsetLeft,r.hAlign===1?l=s.offsetLeft+h._checkboxSize/2-y/2:r.hAlign===2&&(l=s.offsetLeft+h._checkboxSize-y),p=s.offsetTop-b):h._textAlign===1?(l=s.offsetLeft,r.hAlign===1?l=s.offsetLeft+h._checkboxSize/2-y/2:r.hAlign===2&&(l=s.offsetLeft+h._checkboxSize-y),p=s.offsetTop+s.offsetHeight):h._textAlign===2?(l=s.offsetLeft-y-2,p=s.offsetTop+h._checkboxSize/2-b/2):(l=s.offsetLeft+s.offsetWidth+2,p=s.offsetTop+h._checkboxSize/2-b/2);n.util.browser.msie&&(l+=3,p+=3);w.css(u,l).css(e,p);h._isThreeState?(ft=s.offsetLeft+(s.offsetWidth-d.offsetWidth)/2,et=s.offsetTop+(s.offsetHeight-d.offsetHeight)/2,n.GC$(d).css(u,ft).css(e,et).toggle().toggle()):n.GC$(d).hide();r.textDecoration&&h._setEditStatusTextDecoration(w,r.textDecoration)}}},v.prototype.caption=function(n){return arguments.length===0?this._caption:(this._caption=n,this)},v.prototype.textTrue=function(n){return arguments.length===0?this._textTrue:(this._textTrue=n,this)},v.prototype.textIndeterminate=function(n){return arguments.length===0?this._textIndeterminate:(this._textIndeterminate=n,this)},v.prototype.textFalse=function(n){return arguments.length===0?this._textFalse:(this._textFalse=n,this)},v.prototype._getDisplayText=function(n){var r=this;return r._isThreeState&&(n===t||n===i)?r._textIndeterminate||r._caption:!!n==!0?r._textTrue||r._caption:r._textFalse||r._caption},v.prototype.textAlign=function(n){return arguments.length===0?this._textAlign:(this._textAlign=n,this)},v.prototype.isThreeState=function(n){return arguments.length===0?this._isThreeState:(this._isThreeState=n,this)},v.prototype.getHitInfo=function(n,r,u,f,e){if(e){var o=e.sheetArea;if(o===t||o===i||o===3)return{x:n,y:r,row:e.row,col:e.col,cellRect:f,sheetArea:o,isReservedLocation:!0,sheet:e.sheet}}return t},v.prototype.processMouseDown=function(n){if(!n)return!1;n.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},v.prototype.processMouseUp=function(r){var e,f;if(!r)return!1;if(e=this,f=r.sheet,e._isMouseDownReservedLocation&&f&&r.isReservedLocation){e._isMouseDownReservedLocation=!1;var s=r.row,h=r.col,o=r.sheetArea,u=f._getModel(o).getNode(s,h,!0);if(u._isFirstMouseUp)delete u._isFirstMouseUp,u._mouseupToken&&(window.clearTimeout(u._mouseupToken),delete u._mouseupToken);else{if(o===t||o===i||o===3){var c=f.getValue(s,h,o),l=e._getNextState(c),a={row:s,col:h,newValue:l,autoFormat:!0},v=new n.UndoRedo.CellEditUndoAction(f,a);f._doCommand(v)}return e._triggerButtonClicked(f,s,h,r.sheetArea),u._isFirstMouseUp=!0,u._mouseupToken=window.setTimeout(function(){delete u._isFirstMouseUp;u._mouseupToken&&(window.clearTimeout(u._mouseupToken),delete u._mouseupToken)},250),!0}}return!1},v.prototype.processMouseLeave=function(n){if(!n)return!1;this._isMouseDownReservedLocation=!1},v.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},v.prototype.processKeyUp=function(t,i){var r=i.sheet;if(!r)return!1;var u=r.getActiveRowIndex(),f=r.getActiveColumnIndex(),e=r._getSheetArea(r.activeRowViewportIndex,r.activeColViewportIndex),o=r.getValue(u,f,e),s=this._getNextState(o),h={row:u,col:f,newValue:s,autoFormat:!0},c=new n.UndoRedo.CellEditUndoAction(r,h);return r._doCommand(c),this._triggerButtonClicked(r,u,f,i.sheetArea),!0},v.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitWidth(t,e._getDisplayText(t),r,u,f);return e._textAlign===0||e._textAlign===1?o=l(o,e._checkboxSize):o+=e._checkboxSize,o+5+2},v.prototype.getAutoFitHeight=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitHeight(t,e._getDisplayText(t),r,u,f);return e._textAlign===0||e._textAlign===1?o+=e._checkboxSize:o=l(o,e._checkboxSize),o+5},v.prototype._cancelDefaultKeydown=function(t){t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)},v.prototype.isImeAware=function(n){return!1},v.prototype._isDefaultValue=function(n,t){switch(n){case"caption":return t==="";case"textTrue":return t==="";case"textIndeterminate":return t==="";case"textFalse":return t==="";case"textAlign":return t===3;case"isThreeState":return t===!1;default:return!1}},v.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,caption:n.caption(),textTrue:n.textTrue(),textIndeterminate:n.textIndeterminate(),textFalse:n.textFalse(),textAlign:n.textAlign(),isThreeState:n.isThreeState()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},v.prototype.fromJSON=function(n,r){if(n){var u=this;n.caption&&u.caption(n.caption);n.textTrue&&u.textTrue(n.textTrue);n.textIndeterminate&&u.textIndeterminate(n.textIndeterminate);n.textFalse&&u.textFalse(n.textFalse);n.textAlign!==t&&n.textAlign!==i&&u.textAlign(n.textAlign);n.isThreeState!==t&&n.isThreeState!==i&&u.isThreeState(n.isThreeState)}},v}(n.TextCellType);n.CheckBoxCellType=ii,function(n){n[n.Normal=0]="Normal";n[n.Hover=1]="Hover";n[n.Pressed=2]="Pressed"}(n.ButtonState||(n.ButtonState={}));ir=n.ButtonState;ri=function(o){function l(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="6";n._marginTop=2;n._marginRight=2;n._marginBottom=2;n._marginLeft=2;n._text="";n._buttonBackColor=t;n._buttonBorderColor="#707070";n._buttonHoverColor="#A6F4FF";n._buttonPressedColor="#34B4E3";n._buttonState=0;n._eventNameSpace=".buttonCellType"}return __extends(l,o),l.prototype.paintValue=function(n,t,i,r,u,f,e,s){var p,a,w;if(n){var h=this,c=i+h._marginLeft,l=r+h._marginTop,v=u-h._marginLeft-h._marginRight,y=f-h._marginTop-h._marginBottom,b=c+v>i&&c<i+u&&l+y>r&&l<r+f;v-2>0&&y-2>0&&b&&(n.save(),(c<i||c+v>i+u||l<r||l+y>r+f)&&(n.rect(i,r,u,f),n.clip()),n.beginPath(),p=h._buttonBorderColor,p&&n.strokeStyle!==p&&(n.strokeStyle=p),n.strokeRect(c+.5,l+.5,v-1,y-1),h._buttonState===2?a=h._buttonPressedColor:h._buttonState===1?a=h._buttonHoverColor:(a=h._buttonBackColor,a||(w=n.createLinearGradient(i+u/2,r,i+u/2,r+f),w.addColorStop(.125,ci),w.addColorStop(1,li),a=w)),n.fillStyle!==a&&(n.fillStyle=a),n.fillRect(c+1,l+1,v-2,y-2),n.restore(),h._text&&o.prototype.paintValue.call(this,n,h._text,c,l,v,y,e,s))}},l.prototype.focus=function(n,t){n&&n.focus()},l.prototype._formatEditorValue=function(n,t,i,r){return i},l.prototype.createEditorElement=function(t){var f=r.createElement("div"),o=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,l=n.util.getPreferredZIndex(o)+1e3,e=n.GC$(f),i,u;return e.css(s,h).css(tt,w).css(ot,w).css(rt,it).css(yt,a).css(ut,"2px #5292f7 solid").css(ft,a).css(pt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css("user-select",a).css(st,l).attr(et,1).attr(d,"gcEditingInput"),i=n.GC$(r.createElement("div")),i.css(s,h).css(rt,it).css(ut,"1px "+this._buttonBorderColor+" solid"),e.append(i),u=n.GC$(r.createElement("span")),u.css(s,h).css(ct,"nowrap").css(c,"normal 11pt calibri").css("cursor","default"),i.append(u),f},l.prototype.setEditorValue=function(t,i,r){var u=t&&t.children[0]&&t.children[0].children[0];u&&n.GC$(u).html(this._text)},l.prototype.getEditorValue=function(n,i){return n?n._oldValue:t},l.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r})},l.prototype._setButtonBackgroundColor=function(n,t){n.removeClass("gradientButton");t?n.css(f,t):n.addClass("gradientButton")},l.prototype.activateEditor=function(t,i,r,o){var c=t&&o&&o.sheet,s,l,h;if(c){var a=n.GC$(t),v=c._eventHandler._getCanvasPosition(),y=c.getBounds();a.css(e,v.top+y.y+r.y-2).css(u,v.left+y.x+r.x-2).css(f,i.backColor?i.backColor:"white");s=this;l=t.children[0];l&&(h=n.GC$(l),a.bind(dt,function(t){if(t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey)t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t);else return s._isKeyDown||s._setButtonBackgroundColor(h,s._buttonPressedColor),s._isKeyDown=!0,n.util.cancelDefault(t),!1}),a.bind(gt,function(n){!s._isKeyDown||n.keyCode!==32||n.ctrlKey||n.shiftKey||n.altKey||(s._isKeyDown=!1,s._setButtonBackgroundColor(h,s._buttonBackColor),s._triggerButtonClicked(c,c._activeRowIndex,c._activeColIndex,o.sheetArea))}),h.bind(ni,function(n){n.button!==2&&(s._isMouseDown=!0,s._setButtonBackgroundColor(h,s._buttonPressedColor))}),h.bind(ti,function(n){n.button!==2&&(s._isMouseDown=!1,s._setButtonBackgroundColor(h,s._buttonHoverColor))}),h.bind(yi,function(n){s._triggerButtonClicked(c,c._activeRowIndex,c._activeColIndex,o.sheetArea)}),h.bind(vi,function(n){s._isMouseDown?s._setButtonBackgroundColor(h,s._buttonPressedColor):s._setButtonBackgroundColor(h,s._buttonHoverColor)}),h.bind(ai,function(n){var t=n.relatedTarget;t!==l&&t!==l.children[0]&&s._setButtonBackgroundColor(h,s._buttonBackColor)}))}},l.prototype.updateEditor=function(i,r,f,o){var h=i&&o&&o.sheet,y,s,l,d,v,a,g,p,rt,w,b;if(h){var ut=n.GC$(i),nt=h._render,tt=h._eventHandler._getCanvasPosition(),it=h.getBounds();ut.css(e,tt.top+it.y+f.y-2).css(u,tt.left+it.x+f.x-2).width(f.width).height(f.height);y=i.children[0];y&&(s=this,l=n.GC$(y),l.width(f.width-s._marginLeft-s._marginRight).height(f.height-s._marginTop-s._marginBottom).css("margin-top",s._marginTop-1).css("margin-left",s._marginLeft-1),s._setButtonBackgroundColor(l,s._buttonBackColor),d=y.children[0],d&&(v=n.GC$(d),r.foreColor&&v.css(k,r.foreColor),a=t,a=r.font?r.font:nt._getDefaultFont(),h._zoomFactor>1&&(a=nt._getZoomFont(a)),v.css(c,a),g=h._getStringWidth(s._text,a),p=h._getFontHeight(a),s._text&&(rt=s._text.split(/\r\n|\r|\n/),p*=rt.length),w=0,r.vAlign===1?w=l.height()/2-p/2:r.vAlign===2&&(w=l.height()-p),b=0,r.hAlign===1?b=l.width()/2-g/2:r.hAlign===2&&(b=l.width()-g),v.css(e,w).css(u,b),r.textDecoration&&s._setEditStatusTextDecoration(v,r.textDecoration)))}},l.prototype.marginTop=function(n){return arguments.length===0?this._marginTop:(this._marginTop=n,this)},l.prototype.marginRight=function(n){return arguments.length===0?this._marginRight:(this._marginRight=n,this)},l.prototype.marginBottom=function(n){return arguments.length===0?this._marginBottom:(this._marginBottom=n,this)},l.prototype.marginLeft=function(n){return arguments.length===0?this._marginLeft:(this._marginLeft=n,this)},l.prototype.text=function(n){return arguments.length===0?this._text:(this._text=n,this)},l.prototype.buttonBackColor=function(n){return arguments.length===0?this._buttonBackColor:(this._buttonBackColor=n,this)},l.prototype.buttonState=function(n){return arguments.length===0?this._buttonState:(this._buttonState=n,this)},l.prototype.getHitInfo=function(n,r,u,f,e){var s=this,o;if(!e)return t;if(o=e.sheetArea,(o===t||o===i||o===3)&&f){var c=f.x+s._marginLeft,l=f.x+f.width-s._marginRight,a=f.y+s._marginTop,v=f.y+f.height-s._marginBottom,h={x:n,y:r,row:e.row,col:e.col,cellRect:f,sheetArea:o,sheet:e.sheet};return c<=n&&n<=l&&a<=r&&r<=v&&(h.isReservedLocation=!0),h}return t},l.prototype.processMouseDown=function(n){if(!n)return!1;var t=this,i=n.sheet;return i&&n.isReservedLocation&&!t._isMouseDownReservedLocation?(t._isMouseDownReservedLocation=!0,t._buttonState=2,i.repaint(n.cellRect),!0):!1},l.prototype.processMouseUp=function(n){var i,r;if(!n)return!1;if(i=this,r=n.sheet,i._isMouseDownReservedLocation&&r&&n.isReservedLocation){i._buttonState=0;r.repaint(n.cellRect);i._isMouseDownReservedLocation=!1;var u=n.row,f=n.col,e=n.sheetArea,t=r._getModel(e).getNode(u,f,!0);if(t._isFirstMouseUp)delete t._isFirstMouseUp,t._mouseupToken&&(window.clearTimeout(t._mouseupToken),delete t._mouseupToken);else return i._triggerButtonClicked(r,u,f,n.sheetArea),t._isFirstMouseUp=!0,t._mouseupToken=window.setTimeout(function(){delete t._isFirstMouseUp;t._mouseupToken&&(window.clearTimeout(t._mouseupToken),delete t._mouseupToken)},250),!0}return!1},l.prototype.processMouseLeave=function(n){if(!n)return!1;var t=this,i=n.sheet;i&&t._isMouseDownReservedLocation&&(t._buttonState=0,i.repaint(n.cellRect),t._isMouseDownReservedLocation=!1)},l.prototype.processKeyDown=function(t,i){var r=i&&i.sheet,u;if(!r)return!1;if(u=this,!u._isKeyPressed){var e=r.getActiveRowIndex(),o=r.getActiveColumnIndex(),f=r.getCellRect(e,o,r.activeRowViewportIndex,r.activeColViewportIndex);return u._buttonState=2,r.repaint(f),r._bind(n.Events.SelectionChanged+u._eventNameSpace,function(t,i){r._unbind(n.Events.SelectionChanged+u._eventNameSpace);u._isKeyPressed=!1;u._buttonState=0;r.repaint(f)}),u._isKeyPressed=!0,!0}return!1},l.prototype.processKeyUp=function(t,i){var r=i.sheet,u;if(!r)return!1;if(u=this,u._isKeyPressed){var f=r.getActiveRowIndex(),e=r.getActiveColumnIndex(),o=r.getCellRect(f,e,r.activeRowViewportIndex,r.activeColViewportIndex);return u._buttonState=0,r.repaint(o),r._unbind(n.Events.SelectionChanged+u._eventNameSpace),u._triggerButtonClicked(r,f,e,i.sheetArea),u._isKeyPressed=!1,!0}return!1},l.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},l.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitWidth(t,e._text,r,u,f);return o+e._marginLeft+e._marginRight},l.prototype.getAutoFitHeight=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitHeight(t,e._text,r,u,f);return o+e._marginTop+e._marginBottom},l.prototype._cancelDefaultKeydown=function(t){t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)},l.prototype.isImeAware=function(n){return!1},l.prototype._isDefaultValue=function(n,i){switch(n){case"marginTop":return i===2;case"marginRight":return i===2;case"marginBottom":return i===2;case"marginLeft":return i===2;case"text":return i==="";case"buttonBackColor":return i===t;default:return!1}},l.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,marginTop:n.marginTop(),marginRight:n.marginRight(),marginBottom:n.marginBottom(),marginLeft:n.marginLeft(),text:n.text(),buttonBackColor:n.buttonBackColor()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},l.prototype.fromJSON=function(n,r){if(n){var u=this;n.marginTop!==t&&n.marginTop!==i&&u.marginTop(n.marginTop);n.marginRight!==t&&n.marginRight!==i&&u.marginRight(n.marginRight);n.marginBottom!==t&&n.marginBottom!==i&&u.marginBottom(n.marginBottom);n.marginLeft!==t&&n.marginLeft!==i&&u.marginLeft(n.marginLeft);n.text&&u.text(n.text);n.buttonBackColor&&u.buttonBackColor(n.buttonBackColor)}},l}(n.TextCellType);n.ButtonCellType=ri;ui=function(o){function v(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="8";n._link="";n._linkColor="#0066cc";n._visitedLinkColor="#3399ff";n._text="";n._linkToolTip="";n._id=v._getUniqueId();n._target=0}return __extends(v,o),v.prototype.paintValue=function(t,i,r,f,e,o,s,h){var v=this,p,tt,it,k,d,pt,g,et,c,dt,nt;if(!v._actived&&t&&(p=v.getText(i,h),p)){p=p.replace(/\s+/g," ");var ot=!1,st=h.sheet._getModel().getNode(h.row,h.col),ct=st&&st.hyperlinkInfo;ct&&(v._id===ct.id?ot=ct.visited:delete st.hyperlinkInfo);t.save();t.beginPath();tt=ot?v._visitedLinkColor:v._linkColor;tt&&t.fillStyle!==tt&&(t.fillStyle=tt);it=s.font;it&&t.font!==it&&(t.font=it);var rt=s.hAlign,lt=s.vAlign,w=t.measureText(p).width,y=h.lineHeight,ut=v._calcPosition(new n.Rect(r,f,e,o),w,y,rt,lt),b={x:r,y:f,width:e,height:o};(ut.x+w>b.width||ut.y+y>b.height)&&(t.rect(b.x,b.y,b.width,b.height),t.clip(),t.beginPath());k=2;d=u;rt===1?w<e-3&&(k=e/2,d=kt):rt===2&&w<e-3&&(k=e-2,d=at);t.textAlign!==d&&(t.textAlign=d);var a=n.util.browser.mozilla?5:2,wt=vt,ft=h.fontInfo.fontSize,bt=ft>8?ht((ft-8)/5+2):1,yt=y/2-ft/2+bt-1;a+=y-yt;lt===1?y<o&&(a=n.util.browser.mozilla?o/2+1:n.util.browser.msie?o/2+.5:o/2,ht(a)!==a&&(a=a+.5),a+=y/2-yt):lt===2&&(a=o-2.5-yt);t.textBaseline!==wt&&(t.textBaseline=wt);t.fillText(p,r+k,f+a);pt=s.textDecoration;pt&&v._renderTextDecoration(t,pt,r+k,f+a,w,ft,bt);g=r+ut.x;et=g+w;rt===2||(g=g+1,et=et+1);c=f+ut.y+y;s.vAlign===2&&(c=c-.5);c=c-l(0,hi(y/9)-1);ht(c)===c&&(c=c+.5);dt=c;t.beginPath();nt=v._linkColor;ot&&(nt=v._visitedLinkColor);nt&&t.strokeStyle!==nt&&(t.strokeStyle=nt);t.lineWidth=1;t.moveTo(g,c);t.lineTo(et,dt);t.stroke();t.restore()}},v.prototype.getText=function(n,t){return this._text||n},v.prototype.createEditorElement=function(t){var u=r.createElement("div"),o=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,c=n.util.getPreferredZIndex(o)+1e3,f=n.GC$(u),i,e;f.css(tt,w).css(ot,w).css(ut,a).css(s,h).css(rt,it).css(g,"content-box").css(ct,"nowrap").css(st,c).attr(d,"gcEditor").attr(et,1).css(ft,a);switch(this._target){case 0:i="_blank";break;case 1:i="_self";break;case 2:i="_parent";break;case 3:i="_top";break}return e=r.createElement("a"),n.GC$(e).css(tt,w).css(ft,a).css("display","block").attr("target",i).appendTo(f),u},v.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&(n._startEditByKeydown||u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r}))},v.prototype.activateEditor=function(i,o,c,l){var a,y,v,b,nt,p,ut;if(i&&c){if(a=l&&l.sheet,y=n.GC$(i),y.css(f,o&&o.backColor||"white"),a){var ft=a._eventHandler._getCanvasPosition(),et=a.getBounds(),ot=ft.top+et.y+c.y,st=ft.left+et.x+c.x;y.css(e,ot).css(u,st)}y.bind("keydown",function(t){t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)});v=this;b=i.firstChild;b&&(nt=n.GC$(b),nt.bind("click",function(){if(nt.css(k,v._visitedLinkColor),a){var n=a._activeRowIndex,t=a._activeColIndex,i=a._getModel().getNode(n,t,!0);i.hyperlinkInfo={id:v._id,visited:!0};v._triggerButtonClicked(a,n,t,l.sheetArea)}}));p=r.createElement("div");n.GC$(p).css(tt,w).css(s,h).css(rt,it).css(g,"content-box").attr(d,"gcEditingInput").css(pi,"1px").css(wi,"solid").css(f,"transparent");ut=a&&a._getHost();ut&&ut.insertBefore(p,t);v._clip=p;v._actived=!0}},v.prototype.deactivateEditor=function(t,i){var r=i&&i.sheet,u,f;this._clip&&(u=r&&r._getHost(),u&&u.removeChild(this._clip));t&&(n.GC$(t).unbind("keydown"),f=t.firstChild,f&&n.GC$(f).unbind("click"));o.prototype.deactivateEditor.call(this,t,i);this._actived=!1;r&&r.repaint()},v.prototype.updateEditor=function(i,r,f,o){var l,w,b,y,a;if(i&&f){var s=this,h=o&&o.sheet,p=h&&h._render,ut=i,v=n.GC$(ut),d=i.firstChild;if(d&&(l=n.GC$(d),s._link&&l.attr("href",s._link),w=s._text||s._link,w&&l.text(w),l.attr("title",s._linkToolTip),b=!1,y=h?h._getModel().getNode(h._activeRowIndex,h._activeColIndex):t,y&&y.hyperlinkInfo&&(s._id===y.hyperlinkInfo.id?b=y.hyperlinkInfo.visited:delete y.hyperlinkInfo),b?l.css(k,s._visitedLinkColor):l.css(k,s._linkColor),a=r&&r.font?r.font:t,!a&&p&&(a=p._getDefaultFont()),p&&h._zoomFactor>1&&(a=p._getZoomFont(a)),a&&l.css(c,a)),r&&h){v.css(ki,f.width-2);v.css(di,f.height-2);var g=h._eventHandler._getCanvasPosition(),nt=h.getBounds(),tt=g.top+nt.y+f.y,it=g.left+nt.x+f.x,rt=s._calcPosition(f,v.width(),v.height(),r.hAlign,r.vAlign);v.css(e,tt+rt.y).css(u,it+rt.x);s._clip&&n.GC$(s._clip).css(e,tt).css(u,it).height(f.height-3).width(f.width-3).css(bi,r.backColor||"white");r.textDecoration&&s._setEditStatusTextDecoration(v,r.textDecoration)}}},v.prototype.getEditorValue=function(n,t){return this._link},v.prototype.setEditorValue=function(n,t,i){this._link=t},v.prototype._formatEditorValue=function(n,t,i,r){return i},v.prototype.getHitInfo=function(n,r,u,f,e){if(e){var o=e.sheetArea;if((o===t||o===i||o===3)&&u&&f)return{x:n,y:r,row:e.row,col:e.col,cellStyle:u,cellRect:f,sheetArea:o,isFocusAware:!0,sheet:e.sheet}}return t},v.prototype.processMouseDown=function(n){if(n){var t=n.sheet;t&&!t.isEditing()&&(n.isReservedLocation=this._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation&&(this._isMouseDownLink=!0))}},v.prototype.processMouseUp=function(n){var t,i,r,u;if(n&&(t=n.sheet,t&&!t.isEditing())){if(i=this,n.isReservedLocation=i._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation&&i._isMouseDownLink){if(r=t.getValue(n.row,n.col,n.sheetArea),r)switch(i._target){case 0:window.open(r,"_blank");break;case 1:window.open(r,"_self");break;case 2:window.open(r,"_parent");break;case 3:window.open(r,"_top");break}u=t._getModel(n.sheetArea).getNode(n.row,n.col,!0);u.hyperlinkInfo={id:i._id,visited:!0};t.repaint(n.cellRect);i._triggerButtonClicked(t,n.row,n.col,n.sheetArea)}i._isMouseDownLink=!1}},v.prototype.processMouseMove=function(n){var t,r,i;n&&(t=n.sheet,t)&&(t.isEditing()&&t.getActiveRowIndex()===n.row&&t.getActiveColumnIndex()===n.col||(n.isReservedLocation=this._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation?(this._showLinkToolTip(t,n),i=t._getCanvas(),i&&(r=t.getValue(n.row,n.col,n.sheetArea),i.style.cursor=r?"pointer":"text")):(this._hideLinkToolTip(t),i=t._getCanvas(),i&&(i.style.cursor="default"))))},v.prototype.processMouseLeave=function(n){var t,i;this._isMouseDownLink=!1;t=n.sheet;this._hideLinkToolTip(t);t&&(i=t._getCanvas(),i&&(i.style.cursor="default"))},v.prototype._isHitHyperlink=function(n,t){var f=n.cellStyle,i=n.cellRect,o=t._render,s=n.x,h=n.y,r=this._text||this._link,e;if(r||(r=t.getValue(n.row,n.col,n.sheetArea)),!r)return!1;r=r.replace(/\s+/g," ");e=f&&f.font?f.font:o._getDefaultFont();t._zoomFactor>1&&(e=o._getZoomFont(e));var u=this._getLinkRect(r,f.hAlign,f.vAlign,e,i,t),c=i.x+u.x,l=bt(i.x+u.x+u.width,i.x+i.width),a=i.y+u.y,v=bt(i.y+u.y+u.height,i.y+i.height);return c<=s&&s<l&&a<=h&&h<v?!0:!1},v.prototype._showLinkToolTip=function(i,r){var o,f,s;if(this._linkToolTip){o=this._getLinkToolTipElement();f=n.GC$(o);f.text(this._linkToolTip);var h=i._eventHandler._getCanvasPosition(),c=h.left+r.x,l=h.top+r.y+20;f.parent().length()===0&&(s=i&&i._getHost(),s&&s.insertBefore(o,t),f.css(e,l).css(u,c))}},v.prototype._hideLinkToolTip=function(n){if(this._linkToolTipElement){var i=n&&n._getHost();i&&this._linkToolTipElement.parentElement===i&&i.removeChild(this._linkToolTipElement);this._linkToolTipElement=t}},v.prototype._getLinkToolTipElement=function(){if(!this._linkToolTipElement){var t=r.createElement("div");t.className="gcHyperLinkCellTypeToolTip";n.GC$(t).css(s,h).css(tt,w).css(ot,2).css(ut,"1px #c0c0c0 solid").css(pt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css(f,"#ffffff").css(c,"9pt Arial");this._linkToolTipElement=t}return this._linkToolTipElement},v.prototype._getLinkRect=function(t,i,r,u,f,e){var l=v._getEditorElement(e),a=n.GC$(l),y=l.firstChild,o,h;y&&(o=n.GC$(y),o.text(t?t:""),u&&o.css(c,u));var p=a.width(),w=a.height(),s={x:0,y:0,width:p,height:w};return f&&(h=this._calcPosition(f,p,w,i,r),s.x=h.x,s.y=h.y),s},v.prototype._calcPosition=function(n,t,i,r,u){var f=1,e=1,o=n.width-3,s=n.height-3;return r===1?f=f+l(0,(o-t)/2):r===2&&(f=f+l(0,o-t)),u===1?e=e+l(0,(s-i)/2):u===2&&(e=e+l(0,s-i)),{x:f,y:e}},v.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},v.prototype.processKeyUp=function(n,t){var i=t.sheet,o;if(!i)return!1;var u=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),e=i._getSheetArea(i.activeRowViewportIndex,i.activeColViewportIndex),r=i.getValue(u,f,e),s=i.getCellRect(u,f,i.activeRowViewportIndex,i.activeColViewportIndex);if(r){r=r.toString();switch(this._target){case 0:window.open(r,"_blank");break;case 1:window.open(r,"_self");break;case 2:window.open(r,"_parent");break;case 3:window.open(r,"_top");break}}return o=i._getModel(e).getNode(u,f,!0),o.hyperlinkInfo={id:this._id,visited:!0},i.repaint(s),this._triggerButtonClicked(i,u,f,t.sheetArea),!0},v.prototype.linkColor=function(n){return arguments.length===0?this._linkColor:(this._linkColor=n,this)},v.prototype.visitedLinkColor=function(n){return arguments.length===0?this._visitedLinkColor:(this._visitedLinkColor=n,this)},v.prototype.text=function(n){return arguments.length===0?this._text:(this._text=n,this)},v.prototype.linkToolTip=function(n){return arguments.length===0?this._linkToolTip:(this._linkToolTip=n,this)},v.prototype.target=function(n){return arguments.length===0?this._target:(this._target=n,this)},v.prototype.getAutoFitWidth=function(n,t,i,r,u){var f=u&&u.sheet;if(f){var e=this,o=f._render,s=e._text||n,h=i&&i.font?i.font:o._getZoomFont(o._getDefaultFont()),c=e._getLinkRect(s,i.hAlign,i.vAlign,h,null,f);return c.width}else return 0},v.prototype.getAutoFitHeight=function(n,t,i,r,u){var f=u&&u.sheet,s;if(f){var h=this._text||n,o=f._render,e=i&&i.font?i.font:o._getDefaultFont();return r>1&&(e=o._getZoomFont(e)),s=this._getLinkRect(h,i.hAlign,i.vAlign,e,null,f),s.height}else return 0},v.prototype.isImeAware=function(n){return!1},v.prototype._isDefaultValue=function(n,t){switch(n){case"linkColor":return t==="#0066cc";case"visitedLinkColor":return t==="#3399ff";case"text":return t==="";case"linkToolTip":return t==="";case"target":return t===0;default:return!1}},v.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,linkColor:n._linkColor,visitedLinkColor:n._visitedLinkColor,text:n._text,linkToolTip:n._linkToolTip,target:n._target},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},v.prototype.fromJSON=function(n,r){if(n){var u=this;n.linkColor!==i&&n.linkColor!==t&&(u._linkColor=n.linkColor);n.visitedLinkColor!==i&&n.visitedLinkColor!==t&&(u._visitedLinkColor=n.visitedLinkColor);n.text!==i&&n.text!==t&&(u._text=n.text);n.linkToolTip!==i&&n.linkToolTip!==t&&(u._linkToolTip=n.linkToolTip);n.target!==i&&n.target!==t&&(u._target=n.target)}},v._getUniqueId=function(){var n=this;return(n._id===i||n._id===t)&&(n._id=0),"id_"+n._id++},v._getEditorElement=function(n){var f=this,i,u;return f._editorElement||(i=v.prototype.createEditorElement({sheet:n}),u=i.style,r.body.insertBefore(i,t),u.visibility=it,u.top="-10000px",u.left="-10000px",i.className="gcHyperLinkCellTypeEditor",f._editorElement=i),f._editorElement},v}(n.TextCellType);n.HyperLinkCellType=ui;fi=function(t){function r(){t.call(this);this.typeName=""}return __extends(r,t),r.prototype.paint=function(t,r,u,f,e,o,s,h){var l,v,a,p,y,w,c;t&&(n.CellTypeContext.paintBackground(t,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),l=h.sheetArea,(l===2||l===1)&&(v=0,h.visualState!==i&&(v=h.visualState),a="columnHeader",l===2&&(a="rowHeader"),p=this.getThemeStyle(h.visualState,"gc-"+a+"-"+n.VisualState[v].toLowerCase()),n.HeaderCellType.prototype._paintGridline(t,u,f,e,o,s,a,p,l)),y=n.CellTypeContext.paintConditionalFormats(t,r,u,f,e,o,s,h),h.showBarIconOnly=y,n.CellTypeContext.paintSparkline(t,u,f,e,o,h.sparkline),w=n.CellTypeContext.paintSparklineEx(t,r,u,f,e,o,h.sheet),h.cellOverflowLayout||y||w||(c=new n.Rect(u,f,e,o),n.CellTypeContext.adjustRectForIconSet(s.hAlign,h.sheet,h.row,h.col,h.sheetArea,c),this.paintValue(t,r,c.x,c.y,c.width,c.height,s,h)))},r.prototype.createEditorElement=function(n){},r.prototype.getEditorValue=function(n,t){},r.prototype.setEditorValue=function(n,t,i){},r.prototype.activateEditor=function(t,i,r,u){var f=t&&u&&u.sheet,e;if(f){e=f._eventHandler;this.isImeAware(u)&&e._resetFocusHolder();var o=e._getCanvasPosition(),s=f.getBounds(),h=o.top+s.y+r.y-2,c=o.left+s.x+r.x-2;n.GC$(t).css("top",h).css("left",c)}},r.prototype.deactivateEditor=function(n,t){var i,r;n&&(i=n._editingLocator,i&&(r=t&&t.sheet&&t.sheet._getHost(),r&&r.removeChild(i)))},r.prototype.updateEditor=function(t,i,r,u){t&&n.GC$(t).width(r.width).height(r.height)},r.prototype.updateImeMode=function(n,i,r){t.prototype.updateImeMode.call(this,n,i,r)},r.prototype.getHitInfo=function(n,t,i,r,u){return null},r.prototype.processMouseDown=function(n){},r.prototype.processMouseMove=function(n){},r.prototype.processMouseUp=function(n){},r.prototype.processMouseEnter=function(n){},r.prototype.processMouseLeave=function(n){},r.prototype.isReservedKey=function(n,t){return!1},r.prototype.processKeyDown=function(n,t){return!1},r.prototype.processKeyUp=function(n,t){return!1},r.prototype.isEditingValueChanged=function(n,t,i){return n!==t},r.prototype.getAutoFitWidth=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitWidth(t,i,r,u,f)},r.prototype.getAutoFitHeight=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitHeight(t,i,r,u,f)},r.prototype.isImeAware=function(n){return!1},r.prototype.toJSON=function(){var t={};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},r.prototype.fromJSON=function(n){if(n)for(var t in n)n[t]!==i&&(this[t]=n[t])},r}(n.BaseCellType);n.CustomCellType=fi;var nt=17,rr=20,p=1,lt=4,ei=2,oi=lt,ur=function(r){function u(){r.call(this);var n=this;n.typeName="7";n._editorValueType=0;n._items=[];n._itemHeight=22;n._editable=!1;n._autoFormatValue=!1;n._hasInPlaceEditor=!1}return __extends(u,r),u.prototype.editorValueType=function(n){return arguments.length===0?this._editorValueType:(this._editorValueType=n,this)},u.prototype.items=function(n){return arguments.length===0?this._items:(this._items=n,this)},u.prototype.itemHeight=function(n){return arguments.length===0?this._itemHeight:(this._itemHeight=n,this)},u.prototype.editable=function(n){return arguments.length===0?this._editable:(this._editable=n,this)},u.prototype.isReservedKey=function(n,t){return this._hasInPlaceEditor?!0:!1},u.prototype.paint=function(t,i,r,u,f,e,o,s){var c,l,h;t&&(n.CellTypeContext.paintBackground(t,r,u,f,e,o.backColor,o.backgroundImage,o.backgroundImageLayout,s.imageLoader),c=n.CellTypeContext.paintConditionalFormats(t,i,r,u,f,e,o,s),s.showBarIconOnly=c,n.CellTypeContext.paintSparkline(t,r,u,f,e,s.sparkline),l=n.CellTypeContext.paintSparklineEx(t,i,r,u,f,e,s.sheet),s.cellOverflowLayout||c||l||(h=new n.Rect(r,u,f,e),n.CellTypeContext.adjustRectForIconSet(o.hAlign,s.sheet,s.row,s.col,s.sheetArea,h),this.paintValue(t,i,h.x,h.y,h.width,h.height,o,s)))},u.prototype.paintValue=function(n,t,i,u,f,e,o,s){var h=nt,c=l(0,f-h-1);o.hAlign===3&&(o.hAlign=0);o.wordWrap&&(o.wordWrap=!1);c>0&&e>0&&r.prototype.paintValue.call(this,n,this.getText(t,s),i,u,c,e,o,s);n.save();(h>f||h>e)&&(n.rect(i,u,f,e),n.clip());n.beginPath();n.beginPath();n.lineWidth=2;n.fillStyle="#000000";n.moveTo(i+f-h+4,u+(e-2)/2-2.5);n.lineTo(i+f-h+7,u+(e-2)/2+3.5);n.lineTo(i+f-h+10,u+(e-2)/2-2.5);n.fill();n.restore()},u.prototype.getText=function(n,t){return n},u.prototype.createEditorElement=function(t){var f=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,e=n.util.getPreferredZIndex(f)+1e3,u=t.sheet.defaults,i=new fr(0,0,u.colWidth,u.rowHeight,e),r;return i.editorValueType(this._editorValueType),i.items(this._items),i.itemHeight(this._itemHeight),i.editable(this._editable),r=i.getComboBox(),Object.defineProperty(r,"comboBox",{value:i,writable:!1}),r},u.prototype.getEditorValue=function(n,t){var i=n.comboBox;return i&&(this._autoFormatValue=!i._isEditorValueInItems),i&&i.editorValue()},u.prototype.setEditorValue=function(n,t,i){var r=n.comboBox;r&&r.editorValue(t)},u.prototype.focus=function(n,t){if(n){var i=n.comboBox;i&&i.focus()}},u.prototype.selectAll=function(n,t){if(n){var i=n.comboBox;i&&i.selectAll()}},u.prototype.activateEditor=function(t,i,r,u){var e=u.sheet,l=u.row,a=u.col,f=t.comboBox,s,h,c;f&&(f.editorValueType(this._editorValueType),f.items(this._items),f.itemHeight(this._itemHeight),f.editable(this._editable),s=f._dropDownList,s.bind(o,function(t,i){var u=e._getKeyAction(i.keyCode,!1,!1,!1,!1),r;u?(r=u.action,(r===n.SpreadActions.navigationLeft||r===n.SpreadActions.navigationRight)&&(e._editorStatus=1),r.apply(e)):i.isMouse===!0&&f._isDisplayMode===!0&&e.endEdit()}),h=f._comboBoxEditor,h.bind(o,function(n,t){t.isMouse===!0&&e.endEdit()}),c=f._dropDownButton,c.bind(o,function(n,t){t.isMouse===!0&&e.endEdit()}));this._hasInPlaceEditor=!0},u.prototype.deactivateEditor=function(n,t){var i,r,u;if(n&&(i=n.comboBox,i)){var f=i._dropDownList,e=i._comboBoxEditor,s=i._dropDownButton;f.unbind(o);e.unbind(o);s.unbind(o);i.closeDropDownList();i._isDisplayMode=!1;r=n._editingLocator;r&&(u=t&&t.sheet&&t.sheet._getHost(),u&&u.removeChild(r))}this._hasInPlaceEditor=!1},u.prototype.updateEditor=function(n,t,i,r){var f=n&&r&&r.sheet,u,e,o,s;f&&(u=n.comboBox,t&&u&&(e=f._render,u.updateStyle(t.backColor,t.foreColor,e._getZoomFont(t.font||e._getDefaultFont()))),i&&u&&(o=f._eventHandler._getCanvasPosition(),s=f.getBounds(),u.updateLocationAndSize(o.left+s.x+i.x-1,o.top+s.y+i.y-1,i.width+1,i.height+1)))},u.prototype.format=function(n,u,f,e){var a,h,c,o;if(n===t||n===i)return"";var v=this,l=v._editorValueType,s=v._items;if(s&&(a=s.length,l!==0))if(l===1)h=parseInt(n),0<=h&&h<a&&(o=s[h],o!==i&&o!==t&&(n=o.hasOwnProperty("text")?o.text:o));else if(l===2)for(c=0;c<a;c++)if(o=s[c],o&&o.hasOwnProperty("value")&&o.value===n){n=o.text;break}return r.prototype.format.call(this,n,u,f)},u.prototype.parse=function(n,t,i){var c=this,s=c._editorValueType,o=c._items,e=r.prototype.parse.call(this,n,t),h,f,u;if(o)if(h=o.length,s===0)return e;else if(s===1){for(f=0;f<h;f++)if(u=o[f],u&&u.hasOwnProperty("text")&&u.text===e||u===e)return f}else if(s===2)for(f=0;f<h;f++)if(u=o[f],u&&u.hasOwnProperty("text")&&u.text===e)return u.value;return e},u.prototype.getHitInfo=function(n,r,u,f,e){var o,c,s,h;return e?(o=e.sheetArea,c=e.sheet,(o===t||o===i||o===3)&&f)?(s=f.x+f.width,h={x:n,y:r,row:e.row,col:e.col,cellStyle:u,cellRect:f,sheetArea:o,sheet:c},s-nt<=n&&n<s&&(h.isReservedLocation=!0),h):t:t},u.prototype.processMouseDown=function(r){var f=r.sheet,e=r.sheetArea,o,u,s;(e===t||e===i||e===3)&&r.isReservedLocation&&f&&(f.startEdit(),o=f._editor,u=o&&o.comboBox,u&&(s=n.util.browser&&n.util.browser.mozilla,s&&(u._dropDownButton._showTime=(new Date).valueOf()),u.showDropDownList(),u._isDisplayMode=!0))},u.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=n.CellTypeContext.getAutoFitWidth(t,i,r,u,f);return e+nt},u.prototype.getAutoFitHeight=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitHeight(t,i,r,u,f)},u.prototype.isImeAware=function(n){return!0},u.prototype._isDefaultValue=function(n,t){switch(n){case"editorValueType":return t===0;case"items":return t===[];case"itemHeight":return t===22;case"editable":return t===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,editorValueType:n.editorValueType(),items:n.items(),itemHeight:n.itemHeight(),editable:n.editable()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(n,r){n&&(n.editorValueType!==t&&n.editorValueType!==i&&this.editorValueType(n.editorValueType),n.items!==t&&n.items!==i&&this.items(n.items),n.itemHeight!==t&&n.itemHeight!==i&&this.itemHeight(n.itemHeight),n.editable!==t&&n.editable!==i&&this.editable(n.editable))},u}(n.BaseCellType);n.ComboBoxCellType=ur;var si="click",wt="keydown",pr="keyup",o="EndEdit"+v,fr=function(){function f(t,i,f,o,s){var h=this,a,c;h._DOMObject=r.createElement("div");h._DOMObject.className="gcComboBox";h._bindEvent();h._setDefaultCSS(s);n.GC$(h._DOMObject).css(u,t).css(e,i).css(b,f).css(y,o);a=l(0,f-nt);h._comboBoxEditor=new er(this,0,0,a,o);h._comboBoxEditor.appendTo(this._DOMObject);h._dropDownButton=new or(this,a,0,f-a,o);h._dropDownButton.appendTo(this._DOMObject);c=new hr(0,o-2*p,f-2*p,o,s);c.bind(c.CloseDropDown,function(){h._comboBoxEditor.focus()});c.bind(c.ShowDropDown,function(){h._comboBoxEditor.focus()});c.bind(c.SelectedIndexChanged,function(n){h.onSelectedIndexChanged(n)});c.appendTo(this._DOMObject);h._dropDownList=c;h._editorValueType=0;h._items=[]}return f.prototype._bindEvent=function(){var t=this,i=n.GC$(this._DOMObject);i.bind(wt,function(n){t._onKeydown.call(t,n)})},f.prototype._onKeydown=function(n){this._dropDownList&&this._dropDownList._onKeydown(n)},f.prototype._setDefaultCSS=function(t){n.GC$(this._DOMObject).css(s,h).css(st,t||0).attr(d,"gcComboBox")},f.prototype.getComboBox=function(){return this._DOMObject},f.prototype.updateLocationAndSize=function(t,i,r,f){var o,s;n.GC$(this._DOMObject).css(u,t).css(e,i).css(b,r).css(y,f);o=l(0,r-nt);this._comboBoxEditor.updateLocationAndSize(0,0,o,f);this._dropDownButton.updateLocationAndSize(o,0,r-o,f);s=this._dropDownList;s.updateLocation(0,f-2*p);s.width(r-2*p);s._updateItemWidth()},f.prototype.updateStyle=function(n,t,i){this._comboBoxEditor.updateStyle(n,t,i);this._dropDownButton.updateStyle(n,t,i);this._dropDownList.updateStyle(n,t,i)},f.prototype.isDropDownListShown=function(){return this._dropDownList.isShown()},f.prototype.showDropDownList=function(){this._dropDownList.show()},f.prototype.closeDropDownList=function(){this._dropDownList.close()},f.prototype.toggleDropDownListShow=function(){this._dropDownList.toggleShow()},f.prototype.items=function(n){return arguments.length===0?this._items:(this._items=n,this._dropDownList.items(n),this)},f.prototype.itemHeight=function(n){return arguments.length===0?this._dropDownList.itemHeight():(this._dropDownList.itemHeight(n),this)},f.prototype.editable=function(n){return arguments.length===0?this._comboBoxEditor.editable():(this._comboBoxEditor.editable(n),this)},f.prototype.editorValueType=function(n){return arguments.length===0?this._editorValueType:(this._editorValueType=n,this)},f.prototype.editorValue=function(n){return arguments.length===0?this._editorValue:(n!==this._editorValue&&(this._editorValue=n,this._updateEditorValue(n)),this)},f.prototype._updateEditorValue=function(n){var t=this,i=t.valueToText(n);t._comboBoxEditor.text(i);t._dropDownList.selectByText(i)},f.prototype.valueToText=function(n){var u,f=this,s=f._items,h=s.length,c=f._editorValueType,e,o,r;f._isEditorValueInItems=!0;switch(c){case 1:r=s[n];u=r&&r.hasOwnProperty("text")?r.text:r;u===i&&(u=n,f._isEditorValueInItems=!1);break;case 0:for(u=n,e=0;e<h;e++)if(r=s[e],r&&r.hasOwnProperty("text")&&r.text===n||r===n)break;e>=h&&(f._isEditorValueInItems=!1);break;case 2:for(o=0;o<h;o++)if(r=s[o],r&&r.hasOwnProperty("value")&&r.value===n){u=r.text;break}o>=h&&(u=n,f._isEditorValueInItems=!1);break;default:break}return(n===t||n===i)&&(u=""),u},f.prototype.textToValue=function(n){var s=this,e=s._items,h=e.length,o=s._editorValueType,u=n,r,f,t;if(o!==0)if(o===1)for(r=0;r<h;r++)t=e[r],(t&&t.hasOwnProperty("text")&&t.text===n||t===n)&&(u=r);else if(o===2)for(f=0;f<h;f++)t=e[f],t&&t.hasOwnProperty("text")&&t.text===n?u=t.value:t===n&&(u=i);return u},f.prototype.onSelectedIndexChanged=function(n){var r=this,f=r._dropDownList,e=f.selectedIndex(),u=f.getSelectedValue(e,r._items,r._editorValueType);u!==t&&u!==i&&r.editorValue(u)},f.prototype.autoSelectByText=function(n){var t,r,u,i;if(n){for(r=this._items,u=r.length,t=0;t<u;t++)if(i=r[t],i.hasOwnProperty("text")&&(i=i.text),i.toString().substr(0,n.length)===n)break;t>=u&&(t=-1)}else t=-1;this._dropDownList.setSelectedIndexInternal(t)},f.prototype.focus=function(){this._comboBoxEditor.focus()},f.prototype.selectAll=function(){this._comboBoxEditor.selectAll()},f}(),er=function(){function t(n,t,i,u,f){var e=this;e._comboBox=n;e._editable=!1;e._divObject=r.createElement("div");e._textareaObject=r.createElement("textarea");e._DOMObject=e._divObject;e._DOMObject.className="gcComboBoxEditor";e._setDefaultCSS();e._bindEvent();e.updateLocationAndSize(t,i,u,f)}return t.prototype._setDefaultCSS=function(){var t=p+"px solid black";n.GC$(this._DOMObject).css(tt,0).css(rt,"hidden").css(yt,a).css(s,h).css("border-bottom",t).css("border-left",t).css("border-top",t).css(ot,ei+"px 0px 0px "+lt+"px").css(ft,a).css(f,"white").css(ct,"nowrap").css(g,"content-box").attr(d,"gcComboBoxEditor").attr(et,-1)},t.prototype._bindEvent=function(){var t=this;n.GC$(this._textareaObject).bind("keyup",function(n){var i=t._DOMObject.value,r;t._text=i;r=t._comboBox.textToValue(i);t._comboBox.editorValue(r);t._comboBox.autoSelectByText(i);t._removeTip()}).bind("mouseover",function(){t._updateTip()}).bind("mouseout",function(){t._removeTip()});n.GC$(this._divObject).bind("click",function(n){t._comboBox._isDisplayMode?t._trigger(o,{isMouse:!0}):t._comboBox.toggleDropDownListShow()}).bind("mouseover",function(){t._updateTip()}).bind("mouseout",function(){t._removeTip()})},t.prototype._removeTip=function(){n.GC$(this._DOMObject).removeAttr("title")},t.prototype._updateTip=function(){if(this._comboBox&&this._comboBox._dropDownList){var i=this._comboBox._dropDownList.measureText(this._text),t=n.GC$(this._DOMObject),r=t.width();i>r+lt?t.attr("title",this._text):t.removeAttr("title")}},t.prototype.updateLocationAndSize=function(t,i,r,f){r-=p;f-=2*p;n.GC$(this._DOMObject).css(u,t).css(e,i).css(b,r-lt).css(y,f-ei)},t.prototype._getLocationAndSize=function(){var t=n.GC$(this._DOMObject);return{left:parseInt(t.css(u)),top:parseInt(t.css(e)),width:parseInt(t.css(b)),height:parseInt(t.css(y))}},t.prototype._getStyle=function(){var t=n.GC$(this._DOMObject);return{backColor:t.css(f),foreColor:t.css(k),font:t.css(c)}},t.prototype.updateStyle=function(t,i,r){n.GC$(this._DOMObject).css(f,t).css(k,i).css(c,r)},t.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},t.prototype.editable=function(n){if(arguments.length===0)return this._editable;else if(this._editable!==n)return this._editable=n,this._changeEditor(n),this},t.prototype._changeEditor=function(t){var i=this,f=i._comboBox.getComboBox(),r=i._getLocationAndSize(),u=i._getStyle();f.removeChild(i._DOMObject);i._DOMObject=t?i._textareaObject:i._divObject;n.GC$(i._DOMObject).appendTo(f);i._setDefaultCSS();i.updateStyle(u.backColor,u.foreColor,u.font);i.updateLocationAndSize(r.left,r.top,r.width,r.height)},t.prototype.text=function(n){if(arguments.length===0)return this._text;else if(n!==this._text){this._text=n;var t=this._DOMObject.tagName.toUpperCase();t==="DIV"?this._DOMObject.textContent=n:this._DOMObject.value=n}},t.prototype.focus=function(){var n=this._DOMObject;n.focus();n.tagName.toUpperCase()==="TEXTAREA"&&(n.selectionStart=n.value.length)},t.prototype.selectAll=function(){var n=this._DOMObject;n.tagName.toUpperCase()==="TEXTAREA"&&n.select()},t.prototype.bind=function(t,i,r){n.GC$(this._DOMObject).bind(t,i,r)},t.prototype.unbind=function(t,i){n.GC$(this._DOMObject).unbind(t,i)},t.prototype._trigger=function(t,i){n.GC$(this._DOMObject).trigger(t,i)},t}(),or=function(){function t(n,t,i,u,f){this._comboBox=n;this._DOMObject=r.createElement("div");this._DOMObject.className="gcDropDownButton";this._setDefaultCSS();this._bindEvent();var e=r.createElement("canvas");e.className="gcDropDownButtonIcon";this._canvas=e;this.updateLocationAndSize(t,i,u,f);this._DOMObject.appendChild(e)}return t.prototype._setDefaultCSS=function(){var t=p+"px solid black";n.GC$(this._DOMObject).css("border-top",t).css("border-right",t).css("border-bottom",t).css(s,h).css(f,"white").css(g,"content-box").attr(d,"gcDropDownButton")},t.prototype._bindEvent=function(){var t=this;n.GC$(this._DOMObject).bind(si,function(n){var r,u;t._showTime!==i&&(r=t._showTime,t._showTime=i,u=(new Date).valueOf(),u-r<100)||(t._comboBox._isDisplayMode?t._trigger(o,{isMouse:!0}):t._comboBox.toggleDropDownListShow())})},t.prototype._paintIcon=function(){var t=this._canvas;if(t){var i=t.width,r=t.height,n=t.getContext("2d");n.beginPath();n.lineWidth=2;n.fillStyle="#000000";n.moveTo(i-nt+4,(r-2)/2-2.5);n.lineTo(i-nt+7,(r-2)/2+3.5);n.lineTo(i-nt+10,(r-2)/2-2.5);n.fill()}},t.prototype.updateLocationAndSize=function(t,i,r,f){r-=p;f-=2*p;n.GC$(this._DOMObject).css(u,t).css(e,i).css(b,r).css(y,f);n.GC$(this._canvas).attr(b,r).attr(y,f);this._paintIcon()},t.prototype.updateStyle=function(t,i,r){n.GC$(this._DOMObject).css(f,t).css(k,i).css(c,r)},t.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},t.prototype.bind=function(t,i,r){n.GC$(this._DOMObject).bind(t,i,r)},t.prototype.unbind=function(t,i){n.GC$(this._DOMObject).unbind(t,i)},t.prototype._trigger=function(t,i){n.GC$(this._DOMObject).trigger(t,i)},t}(),sr=function(){function t(t,i,u,f,e){this._DOMObject=r.createElement("div");this._isShown=!1;this._setDefaultCSS(e);this._width=u;this._height=f;n.GC$(this._DOMObject).css(b,u).css(y,f);this.updateLocation(t,i)}return t.prototype._setDefaultCSS=function(t){n.GC$(this._DOMObject).css(s,h).css(ut,"1px solid").css(f,"white").css(st,t||0).css(ft,a).css("display","none").css("cursor","default").css(g,"content-box").attr(d,"gcDropDownWindow").attr(et,-1)},t.prototype.show=function(){this.isShown(!0)},t.prototype.close=function(){this.isShown(!1)},t.prototype.toggleShow=function(){this.isShown(!this._isShown)},t.prototype.isShown=function(n){return arguments.length===0?this._isShown:(n!==this._isShown&&(this._isShown=n,this._updateIsShown()),this)},t.prototype._updateIsShown=function(){this._isShown?this._show():this._close()},t.prototype._show=function(){n.GC$(this._DOMObject).show()},t.prototype._close=function(){n.GC$(this._DOMObject).hide()},t.prototype.width=function(n){if(arguments.length===0)return this._width;else n>0&&(this._width=n,this._updateWidth())},t.prototype._updateWidth=function(){n.GC$(this._DOMObject).css(b,this._width)},t.prototype.height=function(n){if(arguments.length===0)return this._height;else n>0&&(this._height=n,this._updateHeight())},t.prototype._updateHeight=function(){n.GC$(this._DOMObject).css(y,this._height)},t.prototype.font=function(n){if(arguments.length===0)return this._font;else this._font=n,this._updateFont()},t.prototype._updateFont=function(){n.GC$(this._DOMObject).css(c,this._font)},t.prototype.updateLocation=function(t,i){n.GC$(this._DOMObject).css(u,t).css(e,i)},t.prototype.updateStyle=function(t,i,r){n.GC$(this._DOMObject).css(f,t).css(k,i);this.font(r)},t.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},t}(),hr=function(u){function e(t,i,f,e,o){u.call(this,t,i,f,e,o);this._itemCount=0;this.SCROLLBAR_SIZE=18;this.HOVER_COLOR="lightgrey";this.SELECTED_COLOR="#1E90FF";this.ShowDropDown="ShowDropDown"+v;this.CloseDropDown="CloseDropDown"+v;this.SelectedIndexChanged="SelectedIndexChanged"+v;this._DOMObject.className="gcDropDownList";this._divList=r.createElement("div");this._divList.className="gcDivList";this._DOMObject.appendChild(this._divList);this._scrollablePanel=new n.ScrollablePanel(this._DOMObject,this._divList);this._itemHeight=22;this._itemCountPerPage=rr;this._selectedIndex=-1}return __extends(e,u),e.prototype._show=function(){u.prototype._show.call(this);this._bindEvent();this._isNeedVScrollbar=!1;this._updateItemHeight();this._updateItemWidth();this._isNeedVScrollbar&&(this._scrollablePanel.verticalSmallChange(n.GC$(this._divList.children).height()),this._scrollablePanel.refreshLayout(!1));this._addSelectedEffect();this._trigger(this.ShowDropDown,{})},e.prototype._close=function(){this._unbindEvent();this._removeSelectedEffect();u.prototype._close.call(this);this._trigger(this.CloseDropDown,{})},e.prototype.items=function(n){if(arguments.length===0)return this._items;else if(n)return this._items=n,this._updateItems(),this},e.prototype._updateItems=function(){this._removeDivListItems();this._addAllItems()},e.prototype._appendMeasureSpanToBody=function(){this._measureSpan=r.createElement("span");n.GC$(this._measureSpan).css("display","none").css(c,this.font());r.body.appendChild(this._measureSpan)},e.prototype._removeMeasureSpanFromBody=function(){r.body.removeChild(this._measureSpan)},e.prototype._measureTextWidth=function(t){return this._measureSpan.textContent=t,n.GC$(this._measureSpan).width()+2+oi},e.prototype._measureTextHeight=function(t){return this._measureSpan.textContent=t,n.GC$(this._measureSpan).height()},e.prototype._addAllItems=function(){var i=this._items,n,r,t;if(i)for(n=0,r=i.length;n<r;n++)t=i[n],this._addItem(t.hasOwnProperty("text")?t.text:t)},e.prototype._addItem=function(t){var e="gcItem"+this._itemCount,i=r.createElement("div"),u,f;i.className=e;u=r.createElement("span");u.textContent=t.toString();u.style.paddingLeft=oi+"px";i.appendChild(u);this._divList.appendChild(i);this._itemCount++;f=this;n.GC$(i).bind(si,function(n){f._onMouseClickItem(this,n)}).bind("mouseover",function(n){f._onMouseEnterItem(this,n)}).bind("mouseout",function(n){f._onMouseLeaveItem(this,n)})},e.prototype._onMouseClickItem=function(t,i){var r=n.GC$(t).index();this.selectedIndex(r);this.close();this._trigger(o,{isMouse:!0})},e.prototype._onMouseEnterItem=function(t,i){var r=n.GC$(t);t.oldBackColor=r.css(f);r.css(f,this.HOVER_COLOR)},e.prototype._onMouseLeaveItem=function(t,i){n.GC$(t).css(f,t.oldBackColor||"")},e.prototype._addSelectedEffect=function(){var t=this._selectedIndex;0<=t&&t<this._itemCount&&(n.GC$(this._divList.children[t]).css(f,this.SELECTED_COLOR),this.scrollToIndex(t))},e.prototype._removeSelectedEffect=function(){var t=this._selectedIndex;0<=t&&t<this._itemCount&&n.GC$(this._divList.children[t]).css(f,"")},e.prototype._bindEvent=function(){var t=this;n.GC$(this._DOMObject).bind(wt,function(n){t._onKeydown.call(t,n)})},e.prototype._unbindEvent=function(){n.GC$(this._DOMObject).unbind(wt)},e.prototype._onKeydown=function(n){this._navigation(n)},e.prototype._navigation=function(t){if(!t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey){var f=this.isShown(),e=1,u=this._itemCount,r=this._selectedIndex,i=0;switch(t.which){case 38:r>=0&&r<u&&(i=r-e);i>=0&&i<u&&this.selectedIndex(i);f&&this.scrollToIndex(i);n.util.cancelDefault(t);break;case 40:r>=0&&r<u&&(i=r+e);i>=0&&i<u&&this.selectedIndex(i);f&&this.scrollToIndex(i);n.util.cancelDefault(t);break;case 13:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 27:this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 37:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 39:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 9:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;default:break}}},e.prototype._removeDivListItems=function(){while(this._divList.firstChild)this._divList.removeChild(this._divList.firstChild);this._itemCount=0},e.prototype.getSelectedValue=function(n,r,u){var f=r[n],e;if(f!==t&&f!==i)switch(u){case 1:e=n;break;case 0:e=f.hasOwnProperty("text")?f.text:f;break;case 2:f.hasOwnProperty("value")&&(e=f.value);break;default:break}return e},e.prototype.setSelectedIndexInternal=function(n){this._removeSelectedEffect();this._selectedIndex=n;this._addSelectedEffect()},e.prototype.selectedIndex=function(n){if(arguments.length===0)return this._selectedIndex;else 0<=n&&n<this._itemCount&&(this.setSelectedIndexInternal(n),this._trigger(this.SelectedIndexChanged,{}))},e.prototype.selectByText=function(n){var r=this._items,t,i;if(r){for(t=0;t<r.length;t++)if(i=r[t],i.hasOwnProperty("text")&&(i=i.text),n===i)break;this.setSelectedIndexInternal(t)}},e.prototype.itemCountPerPage=function(n){if(arguments.length===0)return this._itemCountPerPage;else n>0&&(this._itemCountPerPage=n)},e.prototype._recalcHeight=function(n,t){var i,r=this._itemCount;r<=t?i=r*n:(i=t*n,this._isNeedVScrollbar=!0);this.height(i)},e.prototype.measureText=function(n){this._appendMeasureSpanToBody();var t=this._measureTextWidth(n);return this._removeMeasureSpanFromBody(),t},e.prototype.getLongestItemWidth=function(){var n,u,t,i,f,r;if(this._appendMeasureSpanToBody(),n=0,t=this._items,t)for(i=0,f=t.length;i<f;i++)r=t[i],u=this._measureTextWidth(r.hasOwnProperty("text")?r.text:r),u>n&&(n=u);return this._removeMeasureSpanFromBody(),n},e.prototype._updateWidth=function(){u.prototype._updateWidth.call(this);this._scrollablePanel.refreshLayout(!1)},e.prototype._updateHeight=function(){u.prototype._updateHeight.call(this);this._scrollablePanel.refreshLayout(!1)},e.prototype.itemHeight=function(n){if(arguments.length===0)return this._itemHeight;else n>0&&(this._itemHeight=n)},e.prototype._updateItemHeight=function(){var r,u;this._appendMeasureSpanToBody();r=this._items[0];(r===t||r===i)&&(r="");u=l(this._itemHeight,this._measureTextHeight(r));n.GC$(this._divList.children).css(y,u);this._recalcHeight(u,this._itemCountPerPage);this._removeMeasureSpanFromBody()},e.prototype._updateItemWidth=function(){var n=this.getLongestItemWidth(),t=this.SCROLLBAR_SIZE;this.width()<n+t&&this.width(n+t)},e.prototype.scrollToIndex=function(n){if(n>=0&&n<this._itemCount){var t=this._divList.childNodes[n];this._scrollablePanel.scrollChildIntoView(t)}},e.prototype.bind=function(t,i,r){n.GC$(this._DOMObject).bind(t,i,r)},e.prototype.unbind=function(t,i){n.GC$(this._DOMObject).unbind(t,i)},e.prototype._trigger=function(t,i){n.GC$(this._DOMObject).trigger(t,i)},e}(sr)})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
