/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var GcSpread;(function(n){(function(n){var p,e,l,a,r,o,v,y;n.feature("group",["core.common","core.stringResource"]);var t=null,f=undefined,i=Math.max,u=Math.min,s="undefined",h="gc-group",c="gc-group-box";(function(n){n[n.Expanded=0]="Expanded";n[n.Collapsed=1]="Collapsed"})(n.GroupState||(n.GroupState={}));p=n.GroupState;e=function(){function n(n,i,r,u){var f=this;f.model=t;f.children=t;f.parent=t;f.start=0;f.end=0;f.level=0;f.model=n;f.start=i;f.end=r;f.level=u}return n.prototype.getState=function(){return this.model?this.model.getState(this):0},n.prototype.setState=function(n){this.model&&this.model.expand(this.level,n===0)},n.prototype.contains=function(n){return this.start<=n&&n<=this.end},n.prototype.addChild=function(n){var t=this;n&&(t.children||(t.children=[]),t.children.push(n),n.parent=t)},n}();n.RangeGroupInfo=e;l=function(){function n(){this.count=0}return n.prototype.addRef=function(){this.count++},n.prototype.release=function(){this.count--},n.prototype.isWorking=function(){return this.count>0},n}();n.WorkingState=l;a=function(){function i(n){var i=this;i.head=t;i.tail=t;i.items=t;i._rootCached=t;i.direction=1;i.suspendAddingGroup=new l;i.items=new Array(n);i._empty=!0}return i.prototype.setDirection=function(n){this.direction=n},i.prototype.getDirection=function(){return this.direction},i.prototype._getCount=function(){var n=this.items;return n?n.length:0},i.prototype.group=function(i,u){var f=this,e,s,o;if(!f._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);if(!f._isIndexValid(i+u-1))throw new Error(n.SR.Exp_InvalidCount);for(f._rootCached=t,e=0;e<u;e++)s=i+e,o=f._getModelIndexFromViewIndex(s),f.items[o]?f.items[o].level++:f.items[o]=new r;f._rootCached=f.createRangeGroup();f._empty=!1;f.groupChangeHandler&&f.groupChangeHandler()},i.prototype.ungroupRange=function(i,r){var u=this,k,g,v,nt,y,p,w;if(!u._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);if(!u._isIndexValid(i+r-1))throw new Error(n.SR.Exp_InvalidCount);var h=!1,e=t,c=-1;if(u.direction===1){if(c=i+r,h=u._isIndexValid(c),h){var l=i+r-1,b=l,o=t;do k=u._getModelIndexFromViewIndex(l),o=u.items[k],o!==f&&o!==t&&(b=l),l--;while((o===f||o===t)&&l>=i);o!==f&&o!==t&&(e=u._findImp(u._rootCached,b,o.level),e&&(c=e.end+1),h=e&&(e.end===i+r-1||u.getState(e)===1))}}else if(u.direction===0&&(c=i-1,h=u._isIndexValid(c),h)){var a=i,d=a,s=t;do g=u._getModelIndexFromViewIndex(a),s=u.items[g],s!==f&&s!==t&&(d=a),a++;while((s===f||s===t)&&a<i+r);s!==f&&s!==t&&(e=u._findImp(u._rootCached,d,s.level),e&&(c=e.start-1),h=e&&(e.start===i||u.getState(e)===1))}for(u._rootCached=t,v=0;v<r;v++)nt=i+v,y=u._getModelIndexFromViewIndex(nt),u.items[y]&&u.items[y].level>-1&&u.items[y].level--;h&&(p=u._getModelIndexFromViewIndex(c),w=u.items[p],w&&w.level===e.level&&(u.items[p]=t));u._rootCached=u.createRangeGroup();u.groupChangeHandler&&u.groupChangeHandler()},i.prototype.ungroup=function(){var n=this,i;n._rootCached=t;i=n._getCount();n.items=new Array(i);n._rootCached=n.createRangeGroup();n._empty=!0;n.groupChangeHandler&&n.groupChangeHandler()},i.prototype._expand=function(t,i,r){if(!this._isIndexValid(t))throw new Error(n.SR.Exp_InvalidIndex);if(i<-1)throw new Error(n.SR.Exp_InvalidLevel);var u=this.find(t,i);u&&this.expandGroup(u,r)},i.prototype.expand=function(t,i){if(t<-1)throw new Error(n.SR.Exp_InvalidLevel);for(var r=new o(this);r.moveNext();)this._expand(r.current,t,i)},i.prototype.expandGroup=function(t,i){if(!t)throw new Error(n.SR.Exp_GroupInfoIsNull);var r=-1;switch(this.direction){case 0:r=t.start-1;break;case 1:r=t.end+1;break}this.setCollapsed(r,!i)},i.prototype.isCollapsed=function(n){var i=this.getLevel(n),t;if(i>-1)for(t=this._findImp(this._rootCached,n,i);t;){if(t.getState()===1)return!0;t=t.parent}return!1},i.prototype.find=function(i,r){var u=this._rootCached;if(u){if(r===-1)return u;if(!this._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);return this._findImp(u,i,r)}return t},i.prototype.getLevel=function(t){if(!this._isIndexValid(t))throw new Error(n.SR.Exp_InvalidIndex);var r=this._getModelIndexFromViewIndex(t),i=this.items[r];return i?i.level:-1},i.prototype.getCollapsed=function(n){var i=this._getModelIndexFromViewIndex(n),t=this.items[i];return t?!!t.collapsed:!1},i.prototype.setCollapsed=function(n,i){var u=this,s=!1,f,o;if(n<0)f=u.head,f||(f=u.head=new r),f.collapsed!==i&&(f.collapsed=i,s=!0);else if(n>-1&&n<u._getCount()){var h=u._getModelIndexFromViewIndex(n),c=u.items,e=c[h];e||(e=c[h]=new r,e.level=-1);e.collapsed!==i&&(e.collapsed=i,s=!0)}else n>=u._getCount()&&(o=u.tail,o||(o=u.tail=new r),o.collapsed!==i&&(o.collapsed=i,s=!0));s&&(u._rootCached=t,u.refresh(),u.groupChangeHandler&&u.groupChangeHandler())},i.prototype.getMaxLevel=function(){for(var t=-1,u=this.items,f=u.length,i,n,r=0;r<f;r++)i=u[r],n=i&&i.level,typeof n!==s&&n>t&&(t=n);return t},i.prototype._move=function(i,u,f){var e=this,s,o,l,h,c;if(f>0){if(i<0&&(i=0),u<0&&(u=0),i===u)return;for(s=[],o=n.ArrayHelper.nextNonEmptyIndex(e.items,i-1);o>=0&&o<i+f;)l=new r(e.items[o]),s.push({index:o-i,value:l}),o=n.ArrayHelper.nextNonEmptyIndex(e.items,o);if(n.ArrayHelper.clear(e.items,i,f),n.ArrayHelper.clear(e.items,u,f),s.length>0)for(h=0;h<s.length;h++)c=s[h],e.items[u+c.index]=c.value;e._rootCached=t;e.refresh()}},i.prototype._copy=function(i,u,f){var e=this,s,o,l,h,c;if(f>0){if(i<0&&(i=0),u<0&&(u=0),i===u)return;for(s=[],o=n.ArrayHelper.nextNonEmptyIndex(e.items,i-1);o>=0&&o<i+f;)l=new r(e.items[o]),s.push({index:o-i,value:l}),o=n.ArrayHelper.nextNonEmptyIndex(e.items,o);if(n.ArrayHelper.clear(e.items,u,f),s.length>0)for(h=0;h<s.length;h++)c=s[h],e.items[u+c.index]=c.value;e._rootCached=t;e.refresh()}},i.prototype._add=function(n,i){var u=this,e,s,h,c,f,o;if(i>0){for(e=u._getModelIndexFromViewIndex(n),s=e>1?u.items[e-1]:t,h=0;h<i;h++)u.items.splice(e,0,!s?t:new r(s));if(!u.suspendAddingGroup.isWorking()&&n>0&&(c=u._getModelIndexFromViewIndex(n-1),f=t,f=c<0?u.head:u.items[c],f))for(o=0;o<i;o++)u.items[n+o]=new r({collapsed:f.collapsed,level:f.level});u._rootCached=t;u.refresh()}},i.prototype._remove=function(n,i){i>0&&(this.items.splice(n,i),this._rootCached=t,this.refresh())},i.prototype.equals=function(n){var t=this,i=n,r;if(i){if(!t.items&&i.items&&i.items.length>0||!i.items&&t.items&&t.items.length>0||!t.rangeGroupItemInfoEquals(t.head,i.head)||!t.rangeGroupItemInfoEquals(t.tail,i.tail))return!1;if(t.items&&i.items){if(t.direction!==i.direction||t.items.length!==i.items.length)return!1;for(r=0;r<t.items.length;r++)if(!t.items[r]&&i.items[r]||t.items[r]&&!i.items[r])return!1}return!0}return!1},i.prototype._isEmpty=function(){return this._empty},i.prototype.refresh=function(){this._isEmpty()||(this._rootCached=this.createRangeGroup())},i.prototype._setCount=function(n){var i=this,u,f,e;if(i.items||(i.items=new Array(n)),i._rootCached=t,u=i._getCount(),n<u)i.items.splice(n,u-n);else if(n>u)if(f=i.items[i.items.length-1],f)for(e=0;e<n-u;e++)i.items.push(new r(f));else i.items=i.items.concat(new Array(n-u));i.refresh()},i.prototype.getState=function(n){var r=this,i=-1,u,f,e;switch(r.direction){case 1:i=n.end+1;break;case 0:i=n.start-1;break}return u=t,f=r._getCount(),i<0&&(u=r.head),i>-1&&i<f?(e=r._getViewIndexFromModelIndex(i),u=r.items[e]):i>=f&&(u=r.tail),u&&u.collapsed?1:0},i.prototype._setLevel=function(n,i){var u=this,f;n<0?(u.head||(u.head=new r),u.head.level=i):n>-1&&n<u._getCount()?(f=u._getModelIndexFromViewIndex(n),u.items[f]||(u.items[f]=new r,u.items[f].level=-1),u.items[f].level=i):n>=u._getCount()&&(u.tail||(u.tail=new r),u.tail.level=i);u._rootCached=t;u.refresh()},i.prototype.suspendAdding=function(){this.suspendAddingGroup.addRef()},i.prototype.resumeAdding=function(){this.suspendAddingGroup.release()},i.prototype._getViewIndexFromModelIndex=function(n){return n},i.prototype._getModelIndexFromViewIndex=function(n){return n},i.prototype.rangeGroupItemInfoEquals=function(n,t){return n?t?n.level===t.level&&n.collapsed===t.collapsed:!1:!t},i.prototype.createRangeGroup=function(){for(var n=this,i=new e(n,0,n._getCount()-1,-1),r=new o(n),t;r.moveNext();)t=n._createRangeGroup(r,0),t&&t.level>-1&&i.addChild(t);return i},i.prototype._createRangeGroup=function(n,i){var f=this,u=t,h;do{var r=n.current,c=f._getModelIndexFromViewIndex(r),o=f.items[c],s=n.nextToCurrent();if(o.level<i)continue;else o.level>=i&&(u||(u=new e(f,r,r,i)));if(o.level>i&&(h=f._createRangeGroup(n,i+1),n.current>-1?(r=n.current,s=n.nextToCurrent()):(r=h.end,s=-1),u.addChild(h)),r>u.end&&(u.end=r),f.isGroupEnd(r,s,i))return u}while(n.moveNext());return u},i.prototype.isGroupEnd=function(n,t,i){var r=this,h=r._getModelIndexFromViewIndex(n),e=r.items[h],s,u,o,f;if(!r._isIndexValid(t)||(s=r._getModelIndexFromViewIndex(t),u=r.items[s],!u))return!0;if(u.level<e.level){if(o=e.level-u.level,f=e.level-i,o===f)return!1;if(f>=0&&f<o)return!0}return!1},i.prototype._isIndexValid=function(n){return n>=-1&&n<this._getCount()},i.prototype._findImp=function(n,i,r){var u,f,o,e;if(n)for(u=[],u.unshift(n);u.length>0;){if(n=u.pop(),n.level===r&&n.contains(i))return n;if(f=n.children,o=f&&f.length,o>0)for(e=0;e<o;e++)u.unshift(f[e])}return t},i.prototype.fromJSON=function(n,i){var u,h,c,s,e,o;if(n){if(u=this,h=u.items,n.itemsData)for(c=n.itemsData.length,s=0;s<c;s++)if(e=n.itemsData[s],e.count>0&&e.index>=0&&e.info){for(o=0;o<e.count;o++){if(e.index+o>=h.length)break;h[e.index+o]=new r(e.info)}u._empty=!1}n.direction!==t&&n.direction!==f&&(u.direction=n.direction);n.head&&(u.head=n.head);n.tail&&(u.tail=n.tail);u._rootCached=t;u.refresh()}},i.prototype.toJSON=function(){for(var h,o,s,c,u=this,r=[],t=-1,e=u.items,i=0;i<e.length;i++)e[i]&&(t>=0&&i===r[t].count+r[t].index&&e[i].level===r[t].info.level&&e[i].collapsed===r[t].info.collapsed?r[t].count++:(t++,r[t]={index:i,count:1,info:e[i]}));h={itemsData:r,direction:u.direction,head:u.head,tail:u.tail};o={};for(s in h)c=h[s],u._isDefaultValue(s,c)||(o[s]=c);return n.GC$.isEmptyObject(o)?f:o},i.prototype._isDefaultValue=function(n,i){switch(n){case"head":return i===t;case"tail":return i===t;case"direction":return i===1;case"itemsData":return i.length===0;default:return!1}},i}();n.RangeGroup=a;r=function(){function n(n){var t=this;t!==n&&n&&(t.level=n.level,t.collapsed=n.collapsed);n||(t.level=0,t.collapsed=!1)}return n}();n.RangeGroupItemInfo=r;o=function(){function n(n){this.isEOF=!1;this.rangeGroup=t;this.current=-1;this.rangeGroup=n}return n.prototype.nextToCurrent=function(){return this.current+1},n.prototype.moveNext=function(){var n=this,i,t,r;if(n.isEOF||!n.rangeGroup||!n.rangeGroup.items)return!1;for(i=!1,t=n.current+1;t<n.rangeGroup.items.length;t++)if(r=n.rangeGroup._getModelIndexFromViewIndex(t),n.rangeGroup.items[r]){i=!0;n.current=t;break}return i||(n.current=-1),n.current>-1?!0:(n.isEOF=!0,!1)},n.prototype.reset=function(){this.isEOF=!1;this.current=-1},n}();n.GroupedItemIndexEnumerator=o;v=function(){function r(n,i,r,u){var f=this;f.PADDING=2;f.LINE_SIZE=2;f.STARTLINE_SIZE=6;f._groupLineInfos=t;f._groupDotInfos=t;f._groupButtonInfos=t;f._sheet=n;f._rowGroup=i;f._viewportIndex=r;f._maxLevel=typeof u===s?i?n.rowRangeGroup.getMaxLevel():n.colRangeGroup.getMaxLevel():u}return r.prototype.createGroupInfo=function(){var n=this,i,r,t;if(n._groupLineInfos=[],n._groupDotInfos=[],n._groupButtonInfos=[],i=n._rowGroup,r=n._maxLevel,r!==-1){var u=n._sheet._getGroupLayout(),s=n._calcMinWidthOrHeight({width:u.width,height:u.height},i),f=n.getGroupsByLevel(0,i),e=f.length,o;if(e>0)for(t=0;t<e;t++)o=f[t],n._measureGroups(o,s)}},r.prototype.paintGroups=function(n){this._rowGroup?this._paintRowGroups(n):this._paintColumnGroups(n)},r.prototype._calcMinWidthOrHeight=function(n,t){var r=0,u=this._maxLevel;return r=t?(n.width-this.PADDING*2)/(u+2):(n.height-this.PADDING*2)/(u+2),i(0,r)},r.prototype._measureGroups=function(r,f){var c=this,st=c._rowGroup,s=c.getGroupDirection(st),y=c.getViewportStartIndex(st),p=c.getViewportEndIndex(st),a=r.start,v=r.end,o,e,h,k,d,g,nt,ht,l,w,b,it,ct,rt,ut,ft,et,ot,vt,yt;if(r.getState()===0){if(k=!0,d=r.parent,d&&(s===0&&a===d.start||s===1&&v===d.end)&&(k=!1),k&&(o={isExpanded:!0,level:r.level,paintLine:!0},s===1?(e=v+1,e>=y&&e<=p&&(o.index=e,o.lineDirection=1,c._groupButtonInfos.push(o))):s===0&&(e=a-1,e>=y&&e<=p&&(o.index=e,o.lineDirection=0,c._groupButtonInfos.push(o)))),a<=p&&v>=y){for(g=i(y,a),nt=u(p,v),k&&(ht={start:g,end:nt,level:r.level,startLine:t},(s===1&&g===a||s===0&&nt===v)&&(ht.startLine=!0),c._groupLineInfos.push(ht)),l=[],h=g;h<=nt;h++)l.push(h);if(w=r.children,b=w&&w.length,b>0)for(h=0;h<b;h++){var tt=w[h],lt=tt.start,at=tt.end;if(tt.getState()===1)for(it=lt;it<=at;it++)n.ArrayHelper.remove(l,it);s===1?n.ArrayHelper.remove(l,at+1):s===0&&n.ArrayHelper.remove(l,lt-1);c._measureGroups(tt,f)}if(ct=!0,b>0)for(rt=0;rt<b;rt++)if(ut=w[rt],ut)if(ft=ut.start,et=ut.end,ft===a&&et===v){ct=!1;break}else if(s===1&&et===v||s===0&&ft===a)for(ot=ft;ot<=et;ot++)n.ArrayHelper.remove(l,ot);if(ct&&l.length>0)for(h=0;h<l.length;h++)vt=l[h],yt={index:vt,level:r.level+1},c._groupDotInfos.push(yt)}}else r.getState()===1&&(o={isExpanded:!1,level:r.level},s===1?(e=v+1,e>=y&&e<=p&&(o.index=e,o.lineDirection=1,c._groupButtonInfos.push(o))):s===0&&(e=a-1,e>=y&&e<=p&&(o.index=e,o.lineDirection=0,c._groupButtonInfos.push(o))))},r.prototype._paintRowGroups=function(r){var v=this,ei=v._maxLevel,tt,st,ht,dt,gt,ii,lt,ri,at,ft,vt,k,d,g,b,ui,fi,yt;if(ei!==-1){var et=v._sheet,f=et._getGroupLayout(),y=v._calcMinWidthOrHeight({width:f.width,height:f.height},!0);if(y!==0){r.save();var pt=v.STARTLINE_SIZE,wt=v.PADDING,w=v.LINE_SIZE,ot=i(0,(y-pt)/2)+wt,s,e,l,o,nt=et._getRowLayout(v._viewportIndex,3),oi=n.ThemeStyleHelper.getCssClassThemeStyle(h),bt=oi.color,kt=n.ThemeStyleHelper.getCssClassThemeStyle(c);if(r.fillStyle=bt,tt=v._groupDotInfos,st=tt&&tt.length,st>0)for(l=0;l<st;l++)ht=tt[l],o=nt.findRow(ht.index),o&&o.height>=w&&(s=ht.level*y+ot,e=o.y+i(0,(o.height-w)/2),dt=w,gt=w,r.fillRect(f.x+s+.5,f.y+e,dt,gt));var ni=et.rowRangeGroup.direction,ct=v._groupLineInfos,ti=ct&&ct.length;if(ti>0)for(l=0;l<ti;l++){var it=ct[l],rt=it.start,ut=it.end,p=t,a=t;do p=nt.findRow(rt),rt++;while(!p&&rt<=ut);do a=nt.findRow(ut),ut--;while(!a&&ut>=rt);if(p||a)!p&&a?p=a:p&&!a&&(a=p);else continue;s=it.level*y+ot;e=p.y;ni===1&&(e+=1);ii=w;lt=i(0,a.y+a.height-p.y);r.fillRect(f.x+s+.5,f.y+e,ii,lt);ri=it.startLine;ri&&(at=u(pt,y-w),at>0&&(ni===0&&(e=e+lt-w),e>=p.y&&e<a.y+a.height&&r.fillRect(f.x+s+.5,f.y+e,at,w)))}if(ft=v._groupButtonInfos,vt=ft&&ft.length,vt>0)for(l=0;l<vt;l++)(k=ft[l],o=nt.findRow(k.index),!o||o&&o.height<=0)||(d=i(0,(o.height-y)/2),s=k.level*y+wt,e=o.y+d,g=y,b=u(y,o.height),r.strokeStyle=kt.borderTopColor,r.lineWidth=1,r.fillStyle=kt.backgroundColor,r.fillRect(f.x+s,f.y+e,g,b),r.strokeRect(f.x+s+.5,f.y+e,g,b),r.fillStyle=bt,k.isExpanded||r.fillRect(f.x+s+g/2-1+.5,f.y+e+4,2,b-8),r.fillRect(f.x+s+4+.5,f.y+e+b/2-1,g-8,2),ui=k.paintLine,ui&&b<o.height&&(s=k.level*y+ot,e=o.y,fi=w,yt=d,k.lineDirection===0&&(e+=d+b,yt=o.height-b-d),r.fillRect(f.x+s+.5,f.y+e,fi,yt)));r.stroke();r.beginPath();r.restore()}}},r.prototype._paintColumnGroups=function(r){var v=this,fi=v._maxLevel,et,wt,ot,bt,kt,st,ni,ti,ht,ct,ii,k,d,b,g,ri,lt,ui;if(fi!==-1){var ut=v._sheet,f=ut._getGroupLayout(),y=v._calcMinWidthOrHeight({width:f.width,height:f.height},!1);if(y!==0){var at=v.STARTLINE_SIZE,vt=v.PADDING,w=v.LINE_SIZE,ft=i(0,(y-at)/2)+vt,e,s,l,o,nt=ut._getColumnLayout(v._viewportIndex,3),ei=n.ThemeStyleHelper.getCssClassThemeStyle(h),yt=ei.color,pt=n.ThemeStyleHelper.getCssClassThemeStyle(c);for(r.save(),r.fillStyle=yt,et=v._groupDotInfos,wt=et.length,l=0;l<wt;l++)ot=et[l],o=nt.findCol(ot.index),o&&o.width>=w&&(e=o.x+i(0,(o.width-w)/2),s=ot.level*y+ft,bt=w,kt=w,r.fillRect(f.x+e,f.y+s+.5,bt,kt));var dt=ut.colRangeGroup.direction,gt=v._groupLineInfos,oi=gt.length;for(l=0;l<oi;l++){var tt=gt[l],it=tt.start,rt=tt.end,p=t,a=t;do p=nt.findCol(it),it++;while(!p&&it<=rt);do a=nt.findCol(rt),rt--;while(!a&&rt>=it);if(p||a)!p&&a?p=a:p&&!a&&(a=p);else continue;e=p.x;dt===1&&(e+=1);s=tt.level*y+ft;st=i(0,a.x+a.width-p.x);ni=w;r.fillRect(f.x+e,f.y+s+.5,st,ni);ti=tt.startLine;ti&&(ht=u(at,y-w),ht>0&&(dt===0&&(e=e+st-w),e>=p.x&&e<a.x+a.width&&r.fillRect(f.x+e,f.y+s+.5,w,ht)))}for(ct=v._groupButtonInfos,ii=ct.length,l=0;l<ii;l++)(k=ct[l],o=nt.findCol(k.index),!o||o&&o.width<=0)||(d=i(0,(o.width-y)/2),e=o.x+d,s=k.level*y+vt,b=u(y,o.width),g=y,r.strokeStyle=pt.borderTopColor,r.lineWidth=1,r.fillStyle=pt.backgroundColor,r.fillRect(f.x+e,f.y+s,b,g),r.strokeRect(f.x+e,f.y+s+.5,b,g),r.fillStyle=yt,k.isExpanded||r.fillRect(f.x+e+b/2-1,f.y+s+4.5,2,g-8),r.fillRect(f.x+e+4,f.y+s+g/2-.5,b-8,2),ri=k.paintLine,ri&&b<o.width&&(e=o.x,s=k.level*y+ft,lt=d,ui=w,k.lineDirection===0&&(e+=d+b,lt=o.width-b-d),r.fillRect(f.x+e,f.y+s+.5,lt,ui)));r.beginPath();r.restore()}}},r.prototype.getRowOrColumnStartIndex=function(n){var f=this._sheet,e=this._viewportIndex,t,o,r,s;if(n){if(t=f._getRowLayout(e),t&&t.length>0)return o=t[0].row,i(0,o-1)}else if(r=f._getColumnLayout(e),r&&r.length>0)return s=r[0].col,u(0,s-1);return-1},r.prototype.getRowOrColumnCount=function(n){var r=this._sheet,f=this._viewportIndex,t,e,i,o;if(n){if(t=r._getRowLayout(f),t&&t.length>0)return e=t[t.length-1].row,u(r.getRowCount(),e+2)}else if(i=r._getColumnLayout(f),i&&i.length>0)return o=i[i.length-1].col,u(r.getColumnCount(),o+2);return-1},r.prototype.getGroupsByLevel=function(n,t){for(var i=this,f=[],r=i.getRowOrColumnStartIndex(t),e=i.getRowOrColumnCount(t),o=t?i._sheet.rowRangeGroup:i._sheet.colRangeGroup,u;r<e;)u=o.find(r,n),u?(r=u.end+1,f.push(u)):r++;return f},r.prototype.getGroupDirection=function(n){return n?this._sheet.rowRangeGroup.direction:this._sheet.colRangeGroup.direction},r.prototype.getViewportStartIndex=function(n){var t=this._sheet,i=this._viewportIndex;if(n){if(i===0)return 0;else if(i===1)return t.getFrozenRowCount();else if(i===2)return t.getRowCount()-t.getFrozenTrailingRowCount()}else if(i===0)return 0;else if(i===1)return t.getFrozenColumnCount();else if(i===2)return t.getColumnCount()-t.getFrozenTrailingColumnCount();return-1},r.prototype.getViewportEndIndex=function(n){var t=this._sheet,i=this._viewportIndex;if(n){if(i===0)return t.getFrozenRowCount()-1;else if(i===1)return t.getRowCount()-t.getFrozenTrailingRowCount()-1;else if(i===2)return t.getRowCount()-1}else if(i===0)return t.getFrozenColumnCount()-1;else if(i===1)return t.getColumnCount()-t.getFrozenTrailingColumnCount()-1;else if(i===2)return t.getColumnCount()-1;return-1},r.prototype._processTouch=function(n){n&&this._sheet._isTouchMode&&(n.x-=2,n.y-=2,n.width+=4,n.height+=4)},r.prototype.getRowGroupButton=function(r,f){var e=this,g=e._maxLevel,c,l,o,b;if(g===-1)return t;var v=e._sheet,s=v._getGroupLayout(),h=e._calcMinWidthOrHeight({width:s.width,height:s.height},!0);if(h===0)return t;var y,p,nt=v._getRowLayout(e._viewportIndex,3),a=e._groupButtonInfos,w=a&&a.length;if(w>0)for(c=0;c<w;c++)if(l=a[c],o=nt.findRow(l.index),o&&(!o||!(o.height<=0))){b=i(0,(o.height-h)/2);y=l.level*h+e.PADDING;p=o.y+b;var k=h,tt=u(k,o.height),d=new n.Rect(s.x+y+.5,s.y+p+.5,k,tt);if(e._processTouch(d),d.contains(r,f))return l}return t},r.prototype.getColGroupButton=function(r,f){var e=this,g=e._maxLevel,c,l,o,b;if(g===-1)return t;var v=e._sheet,s=v._getGroupLayout(),h=e._calcMinWidthOrHeight({width:s.width,height:s.height},!1);if(h===0)return t;var y,p,nt=v._getColumnLayout(e._viewportIndex,3),a=e._groupButtonInfos,w=a&&a.length;if(w>0)for(c=0;c<w;c++)if(l=a[c],o=nt.findCol(l.index),o&&(!o||!(o.width<=0))){b=i(0,(o.width-h)/2);y=o.x+b;p=l.level*h+e.PADDING;var k=h,tt=u(k,o.width),d=new n.Rect(s.x+y+.5,s.y+p+.5,tt,k);if(e._processTouch(d),d.contains(r,f))return l}return t},r}();n._RangeGroupPresenter=v;y=function(){function r(n,i,r){var u=this;u._sheet=t;u._rowGroup=t;u._maxLevel=-1;u.PADDING=2;u._sheet=n;u._rowGroup=i;u._maxLevel=typeof r===s?i?n.rowRangeGroup.getMaxLevel():n.colRangeGroup.getMaxLevel():r}return r.prototype.paintGroupHeader=function(t){var v=this,a=v._sheet,g=v._maxLevel;if(a&&!(g<0)){var nt=v._rowGroup,r=a._getGroupLayout(),e=v._calcMinWidthOrHeight({width:r.width,height:r.height},nt);if(e!==0){var tt=g+2,w,b,o,u,s,l,y,p,d,f=a._getSheetLayout(),it=n.ThemeStyleHelper.getCssClassThemeStyle(h),k=n.ThemeStyleHelper.getCssClassThemeStyle(c);if(t.fillStyle=it.backgroundColor,t.strokeStyle=k.borderTopColor,t.font="8.25pt Arial",t.lineWidth=1,nt){if(t.fillRect(r.x,r.y,r.width,f.height),t.strokeRect(r.x-.5,r.y-.5,r.width,f.height+1),t.strokeRect(r.x-.5,f.headerY-.5,r.width,f.colHeaderHeight),a.colHeaderVisible&&f.colHeaderHeight>=e)for(w=v.PADDING,b=i(0,f.headerY+(f.colHeaderHeight-e)/2),o=0;o<tt;o++)u=e-1,s=r.x+w+.5,l=r.y+b,t.fillStyle=k.backgroundColor,t.fillRect(s,l,u,u),t.strokeRect(s,l,u,u),t.fillStyle=k.color,y=""+(o+1),p=t.measureText(y).width,d=a._getFontHeight(t.font),u>=p&&e>=d&&(t.textBaseline="middle",t.fillText(y,s+(u-p)/2,l+u/2)),w+=e}else if(t.fillRect(r.x,r.y,f.width,r.height),t.strokeRect(r.x-.5,r.y-.5,f.width+1,r.height),t.strokeRect(f.headerX-.5,r.y-.5,f.rowHeaderWidth,r.height),a.rowHeaderVisible&&f.rowHeaderWidth>=e)for(w=i(0,f.headerX+(f.rowHeaderWidth-e)/2),b=v.PADDING,o=0;o<tt;o++)u=e-1,s=r.x+w,l=r.y+b+.5,t.fillStyle=k.backgroundColor,t.fillRect(s,l,u,u),t.strokeRect(s,l,u,u),t.fillStyle=k.color,y=""+(o+1),p=t.measureText(y).width,d=a._getFontHeight(t.font),u>=p&&e>=d&&(t.textBaseline="middle",t.fillText(y,s+(u-p)/2,l+u/2)),b+=e}}},r.prototype.getGroupButton=function(r,u){var s=this,c=s._sheet,p=s._maxLevel,y,l,a,e,v,o;if(!c||p<0)return t;var w=s._rowGroup,h=c._getGroupLayout(),f=s._calcMinWidthOrHeight({width:h.width,height:h.height},w);if(f===0)return t;if(y=p+2,o=c._getSheetLayout(),w){if(c.colHeaderVisible&&o.colHeaderHeight>=f)for(l=s.PADDING,a=i(0,o.headerY+(o.colHeaderHeight-f)/2),e=0;e<y;e++){if(v=new n.Rect(h.x+l,h.y+a,f,f),v.contains(r,u))return{index:e};l+=f}}else if(c.rowHeaderVisible&&o.rowHeaderWidth>=f)for(l=i(0,o.headerX+(o.rowHeaderWidth-f)/2),a=s.PADDING,e=0;e<y;e++){if(v=new n.Rect(h.x+l,h.y+a,f,f),v.contains(r,u))return{index:e};a+=f}return t},r.prototype._calcMinWidthOrHeight=function(n,t){var r=0,u=this._maxLevel;return r=t?(n.width-this.PADDING*2)/(u+2):(n.height-this.PADDING*2)/(u+2),i(0,r)},r}();n._RangeGroupHeaderPresenter=y})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
