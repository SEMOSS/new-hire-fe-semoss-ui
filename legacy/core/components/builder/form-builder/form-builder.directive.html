<div class="form-builder" ng-if="form.mode === 'build'" id="form-builder">
    <div id="form-builder__left" class="form-builder__left">
        <smss-accordion class="form-builder__left__accordion" resizable>
            <smss-accordion-item
                ng-repeat="menu in form.menu track by $index"
                name="menu.name"
                size="menu.height"
            >
                <smss-scroll
                    static-x="true"
                    ng-class="{'form-builder__left__accordion__data-fields': menu.name === 'Data Fields'}"
                >
                    <div class="smss-spacing">
                        <smss-search
                            ng-if="menu.components.length > 0"
                            model="menu.search.name"
                            aria-label="Search"
                        >
                        </smss-search>
                    </div>
                    <div class="form-builder__tile-container">
                        <div
                            ng-repeat="component in menu.components | filter: menu.search track by $index"
                            dnd-draggable="component"
                            dnd-dragstart="form.left.options.start()"
                            dnd-dragend="form.left.options.dragend()"
                            ng-dblclick="form.addComponent(component, form.content.items.length);"
                            class="smss-tile form-builder__tile"
                            title="{{component.name | replaceUnderscores}}"
                        >
                            <div class="smss-tile__image">
                                <img ng-src="{{component.icon}}" />
                            </div>
                            <div class="smss-tile__text">
                                <span>
                                    {{component.name |
                                    replaceUnderscores}}</span
                                >
                            </div>
                        </div>
                    </div>
                </smss-scroll>
                <div ng-if="menu.name === 'Data Fields'">
                    <smss-btn
                        class="form-builder__left__accordion__data-fields__add-multi smss-btn--outline smss-btn--compact"
                        ng-click="form.openDataFields = true"
                    >
                        Add Multiple
                    </smss-btn>
                </div>
            </smss-accordion-item>
        </smss-accordion>
    </div>

    <div id="{{'form-content-' + form.uniqueId}}" class="form-builder__content">
        <ul
            id="form-builder__middle"
            class="form-builder__middle"
            ng-style="form.formBackground"
            ng-class="{'form-builder__middle--dragging': form.left.dragging}"
            dnd-list="form.content.items"
            dnd-drop="form.content.options.stop(index, item, event)"
            ng-show="!form.editSource"
        >
            <li
                class="form-builder__middle__item {{item.class}}"
                ng-style="item.style"
                ng-click="form.selectComponent($index)"
                ng-class="{'form-builder__middle__item--selected': form.content.selected === $index}"
                ng-repeat="item in form.content.items track by $index"
                dnd-draggable="item"
                dnd-dragstart="form.content.options.start($index)"
                dnd-dragend="form.content.options.dragend()"
            >
                <div class="form-builder__component__icon__remove">
                    <smss-btn
                        title="Remove Component"
                        ng-click="form.removeComponent($index)"
                        class="smss-btn--icon"
                    >
                        <i class="fa fa-times smss-color__text--error"></i>
                    </smss-btn>
                </div>
                <div
                    class="form-builder__middle__item__dynamic"
                    dynamic="form.cleanHTML(item.html, $index)"
                ></div>
            </li>
            <li
                class="dndPlaceholder form-builder__middle__item"
                ng-style="form.content.items[form.content.selected].style"
            ></li>
        </ul>

        <div ng-show="form.editSource" class="form-builder__middle__source">
            <smss-textarea
                ng-model="form.sourceCode"
                class="form-builder__middle__source"
            ></smss-textarea>
        </div>
    </div>

    <div id="form-builder__right" class="form-builder__right">
        <smss-accordion class="form-builder__left__accordion" resizable>
            <smss-accordion-item name="'Data Model'" size="50">
                <smss-scroll class="form-builder__right__data" static-x="true">
                    <div
                        class="form-builder__right__data__content"
                        ng-show="form.content.items.length > 0 && (form.content.selected || form.content.selected === 0) && !form.editSource"
                    >
                        <smss-field ng-show="form.newComponent.selected.name">
                            <label> Component Type: </label>
                            <content>
                                <smss-dropdown
                                    model="form.newComponent.selected"
                                    display="name"
                                    change="form.changeComponent(form.content.selected, form.newComponent.selected)"
                                    placeholder="Select an option"
                                    options="form.newComponent.list"
                                >
                                </smss-dropdown>
                            </content>
                        </smss-field>
                        <smss-field
                            ng-show="form.content.items[form.content.selected].model !== undefined"
                        >
                            <label> Model: </label>
                            <content>
                                <smss-input
                                    ng-model="form.content.items[form.content.selected].model"
                                    ng-change="form.updateFormModel(form.content.selected)"
                                ></smss-input>
                            </content>
                        </smss-field>
                        <smss-field ng-show="form.showModelBinding()">
                            <label> Select Variable to Bind: </label>
                            <content>
                                <smss-dropdown
                                    model="form.dataBinding[form.content.selected].name"
                                    display="name"
                                    value="name"
                                    change="form.updateDataBinding(form.content.selected)"
                                    placeholder="Select an option"
                                    options="form.dataVariableList"
                                >
                                </smss-dropdown>
                            </content>
                        </smss-field>
                        <smss-field
                            ng-show="!form.isEmpty(form.pixelBinding[form.content.selected])"
                        >
                            <label> Select Pixel to Run: </label>
                            <content>
                                <div
                                    ng-repeat="(key, value) in form.pixelBinding[form.content.selected]"
                                >
                                    <smss-field>
                                        <label>{{key}}:</label>
                                        <content>
                                            <smss-dropdown
                                                model="value.name"
                                                display="name"
                                                value="name"
                                                change="form.updatePixelBinding(key)"
                                                options="form.pixelVariableList"
                                                placeholder="Select an option"
                                            >
                                            </smss-dropdown>
                                        </content>
                                    </smss-field>
                                </div>
                            </content>
                        </smss-field>
                        <div
                            class="smss-spacing"
                            ng-show="form.content.items[form.content.selected].data"
                        >
                            <smss-checkbox
                                model="form.dataModel[form.content.items[form.content.selected].data].autoPopulate"
                                change="form.toggleAutoPopulate(form.content.items[form.content.selected].data)"
                            >
                                Auto Populate
                            </smss-checkbox>
                        </div>
                        <div
                            class="smss-spacing"
                            ng-show="form.content.items[form.content.selected].data &&
                                        form.dataModel[form.content.items[form.content.selected].data] &&
                                        form.dataModel[form.content.items[form.content.selected].data].config.table"
                        >
                            <smss-checkbox
                                model="form.dataModel[form.content.items[form.content.selected].data].useFullList"
                                change="form.toggleUseFullList(form.content.items[form.content.selected].data)"
                            >
                                Use Full List
                            </smss-checkbox>
                        </div>
                        <div
                            class="smss-spacing"
                            ng-show="form.content.items[form.content.selected].data"
                        >
                            <smss-checkbox
                                model="form.dataModel[form.content.items[form.content.selected].data].required"
                                change="form.toggleRequired()"
                            >
                                Required Field
                            </smss-checkbox>
                        </div>
                        <smss-field
                            ng-if="form.content.items[form.content.selected].data"
                        >
                            <label> Select Dependencies: </label>
                            <content>
                                <smss-checklist
                                    options="form.dependList"
                                    class="form-builder__list-height"
                                    model="form.dataModel[form.content.items[form.content.selected].data].dependsOn"
                                    change="form.updatePixelDependency(form.content.items[form.content.selected].data, form.dataModel[form.content.items[form.content.selected].data].dependsOn);
                                        form.setOptions(form.content.items[form.content.selected].data);"
                                    multiple
                                >
                                </smss-checklist>
                            </content>
                        </smss-field>
                        <div
                            ng-if="form.content.items[form.content.selected].group.model"
                        >
                            <div class="smss-spacing">
                                <smss-checkbox
                                    model="form.content.items[form.content.selected].autoPopulate"
                                    change="form.toggleGroupAutoPopulate(form.content.selected)"
                                >
                                    Auto Populate
                                </smss-checkbox>
                            </div>
                            <div class="smss-spacing">
                                <smss-checkbox
                                    model="form.content.items[form.content.selected].useFullList"
                                    change="form.toggleGroupUseFullList(form.content.selected)"
                                >
                                    Use Full List
                                </smss-checkbox>
                            </div>
                            <smss-field>
                                <label> Select Dependencies: </label>
                                <content>
                                    <smss-checklist
                                        options="form.dependList"
                                        class="form-builder__list-height"
                                        model="form.content.items[form.content.selected].dependsOn"
                                        change="form.updateGroupPixelDependency(form.content.selected);"
                                        multiple
                                    >
                                    </smss-checklist>
                                </content>
                            </smss-field>
                        </div>
                    </div>
                    <div class="form-builder__right__data__edit">
                        <smss-btn
                            class="form-builder__right__data__edit__btn smss-btn--outline smss-btn--compact"
                            ng-click="form.toggleVariableBinding('data')"
                        >
                            Data Variables
                        </smss-btn>
                        <smss-btn
                            class="form-builder__right__data__edit__btn smss-btn--outline smss-btn--compact"
                            ng-click="form.toggleVariableBinding('pixel')"
                        >
                            Pixel Variables
                        </smss-btn>
                    </div>
                </smss-scroll>
            </smss-accordion-item>
            <smss-accordion-item name="'Styling'" size="25">
                <smss-scroll static-x="true">
                    <div
                        ng-if="form.content.items.length > 0 && (form.content.selected || form.content.selected === 0) && !form.editSource"
                    >
                        <smss-tab-group>
                            <smss-tab
                                ng-click="form.customStyles = false"
                                style="margin-right: 8px"
                                ng-class="{'smss-tab--selected': !form.customStyles}"
                                class="smss-left form-builder__right__styling__tab"
                            >
                                Standard
                            </smss-tab>
                            <smss-tab
                                ng-click="form.customStyles = true"
                                ng-class="{'smss-tab--selected': form.customStyles}"
                                class="smss-left form-builder__right__styling__tab"
                            >
                                Custom
                            </smss-tab>
                        </smss-tab-group>
                        <div
                            ng-show="!form.customStyles"
                            class="form-builder__right__styling__standard smss-collapsible-group"
                        >
                            <div
                                ng-repeat="(name, style) in form.styleTemplates track by style.id"
                            >
                                <div
                                    ng-if="!style.collapsible"
                                    dynamic="style.html"
                                ></div>
                            </div>
                            <smss-collapsible
                                ng-repeat="section in form.styleCollapsible"
                                model="section.opened"
                            >
                                <smss-collapsible-header
                                    >{{section.display}}</smss-collapsible-header
                                >
                                <smss-collapsible-content>
                                    <div
                                        ng-repeat="(name, style) in form.styleTemplates track by style.id"
                                    >
                                        <div
                                            ng-if="style.collapsible && style.collapsible === section.value"
                                            dynamic="style.html"
                                        ></div>
                                    </div>
                                </smss-collapsible-content>
                            </smss-collapsible>
                        </div>
                        <div ng-show="form.customStyles">
                            <smss-field>
                                <label> CSS Classes: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.content.items[form.content.selected].class"
                                    ></smss-input>
                                </content>
                            </smss-field>
                            <smss-field>
                                <label
                                    class="form-builder__right__styling__new"
                                >
                                    Styles:
                                    <smss-btn
                                        ng-click="form.addEmptyStyle(form.content.selected)"
                                        class="smss-btn--text smss-btn--compact"
                                    >
                                        Add Style
                                    </smss-btn>
                                </label>
                                <content>
                                    <div
                                        ng-repeat="style in form.styleModel[form.content.selected]"
                                        class="form-builder__right__items"
                                    >
                                        <smss-input
                                            class="form-builder__right__items__label"
                                            ng-model="style.name"
                                            ng-change="form.updateStyleFromModel()"
                                        ></smss-input>
                                        :
                                        <smss-input
                                            class="form-builder__right__items__input"
                                            ng-model="style.value"
                                            ng-change="form.updateStyleFromModel()"
                                        ></smss-input>
                                        <smss-btn
                                            ng-click="form.removeStyle($index)"
                                            title="Remove Style"
                                            class="smss-btn--icon"
                                        >
                                            <i
                                                class="fa fa-times smss-color--error"
                                            ></i>
                                        </smss-btn>
                                    </div>
                                    <div
                                        ng-if="form.styleModel[form.content.selected].length === 0"
                                        class="smss-caption--center"
                                    >
                                        No Styles Applied
                                    </div>
                                </content>
                            </smss-field>
                        </div>
                    </div>
                    <smss-collapsible>
                        <smss-collapsible-header>
                            Background Styles
                        </smss-collapsible-header>
                        <smss-collapsible-content>
                            <smss-field>
                                <label> Image: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.formBackground['background-image']"
                                    ></smss-input>
                                </content>
                            </smss-field>
                            <smss-field>
                                <label> Color: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.formBackground['background-color']"
                                    ></smss-input>
                                </content>
                            </smss-field>
                            <smss-field>
                                <label> Size: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.formBackground['background-size']"
                                    ></smss-input>
                                </content>
                            </smss-field>
                            <smss-field>
                                <label> Position: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.formBackground['background-position']"
                                    ></smss-input>
                                </content>
                            </smss-field>
                            <smss-field>
                                <label> Repeat: </label>
                                <content>
                                    <smss-input
                                        ng-model="form.formBackground['background-repeat']"
                                    ></smss-input>
                                </content>
                            </smss-field>
                        </smss-collapsible-content>
                    </smss-collapsible>
                </smss-scroll>
            </smss-accordion-item>
            <smss-accordion-item name="'Themes'" size="25">
                <smss-scroll static-x="true">
                    <div class="form-builder__tile-container">
                        <div
                            ng-repeat="(name, theme) in form.themes.list"
                            class="smss-tile form-builder__tile"
                            ng-click="form.applyTheme(name)"
                            ng-class="{'smss-tile--selected': form.themes.selected === name}"
                        >
                            <div class="smss-tile__image">
                                <img ng-src="{{theme.icon}}" />
                            </div>
                            <div class="smss-tile__text">
                                <span> {{theme.name}}</span>
                            </div>
                        </div>
                    </div>
                </smss-scroll>
            </smss-accordion-item>
        </smss-accordion>
    </div>

    <smss-overlay open="form.openDataFields">
        <smss-overlay-header>Add Data Fields</smss-overlay-header>
        <smss-overlay-body>
            <div class="form-builder__component__overlay__data-fields">
                <div
                    class="form-builder__component__overlay__data-fields__half"
                >
                    <smss-field>
                        <label>Select Data Fields to Add:</label>
                        <content>
                            <smss-checklist
                                model="form.selectedDataFields"
                                options="form.dataFieldComponents"
                                display="name"
                                multiple
                                searchable
                                quickselect
                                class="form-builder__component__overlay__data-fields__half__content"
                            >
                            </smss-checklist>
                        </content>
                    </smss-field>
                </div>
                <div
                    class="form-builder__component__overlay__data-fields__half"
                >
                    <smss-field>
                        <label>Selected Data Fields:</label>
                        <content>
                            <smss-list
                                options="form.selectedDataFields"
                                display="name"
                                class="form-builder__component__overlay__data-fields__half__content"
                            >
                            </smss-list>
                        </content>
                    </smss-field>
                </div>
            </div>
        </smss-overlay-body>
        <smss-overlay-footer>
            <smss-btn
                ng-click="form.openDataFields = false;"
                class="smss-btn--text"
            >
                Cancel
            </smss-btn>
            <smss-btn
                ng-click="form.addMultiComponents(form.selectedDataFields);"
            >
                Add
            </smss-btn>
        </smss-overlay-footer>
    </smss-overlay>

    <smss-overlay
        open="form.openInput"
        ng-if="form.openInput"
        ng-class="{'form-builder__overlay': form.tempComponent.id.indexOf('form-submit') > -1}"
    >
        <smss-overlay-header>
            Add {{form.tempComponent.name}}
        </smss-overlay-header>
        <smss-overlay-body>
            <div
                ng-show="form.tempComponent.id.indexOf('form-header') > -1 || form.tempComponent.id.indexOf('form-text') > -1 || form.tempComponent.id.indexOf('form-iframe') > -1 || form.tempComponent.id.indexOf('form-image') > -1 || form.tempComponent.id.indexOf('form-css') > -1 || form.tempComponent.id.indexOf('form-js') > -1"
            >
                <smss-field>
                    <label>
                        {{form.tempComponent.id.indexOf('form-text') > -1 ||
                        form.tempComponent.id.indexOf('form-header') > -1 ?
                        'Text:' : 'Source:'}}
                    </label>
                    <content>
                        <smss-input
                            ng-model="form.inputs.data.source"
                        ></smss-input>
                    </content>
                </smss-field>
            </div>

            <div ng-show="form.tempComponent.id.indexOf('data-field') > -1">
                <smss-field>
                    <label> Select Field Type: </label>
                    <content class="form-builder__tile-container">
                        <div
                            ng-repeat="component in form.menu[0].components track by $index"
                            ng-dblclick="form.processInput()"
                            class="smss-tile form-builder__component__overlay__tiles"
                            ng-class="{'smss-tile--selected': form.inputs.data.source.name === component.name}"
                            ng-hide="component.name === 'Submit' || component.name === 'Text' || component.name === 'Field Group' || component.name === 'Header'"
                            title="{{component.name}}"
                            ng-click="form.inputs.data.source = component"
                        >
                            <div class="smss-tile__image">
                                <img ng-src="{{component.icon}}" />
                            </div>
                            <div class="smss-tile__text">
                                <span> {{component.name}}</span>
                            </div>
                        </div>
                    </content>
                </smss-field>
            </div>

            <div ng-show="form.tempComponent.id.indexOf('form-group') > -1">
                <table>
                    <tr>
                        <th>Data Binding</th>
                        <th>Component Type</th>
                        <th>Label</th>
                        <th class="smss--icon"></th>
                    </tr>
                    <tr ng-repeat="row in form.inputs.group track by $index">
                        <td>
                            <smss-dropdown
                                model="form.inputs.group[$index].data"
                                display="name"
                                placeholder="Select an option"
                                options="form.dataFieldComponents"
                                change="form.inputs.group[$index].label = (form.inputs.group[$index].data.name + ':')"
                            >
                            </smss-dropdown>
                        </td>
                        <td>
                            <smss-dropdown
                                model="form.inputs.group[$index].type"
                                display="name"
                                placeholder="Select an option"
                                options="form.newComponent.list"
                            >
                            </smss-dropdown>
                        </td>
                        <td>
                            <smss-input
                                ng-model="form.inputs.group[$index].label"
                            ></smss-input>
                        </td>
                        <td>
                            <smss-btn
                                ng-click="form.inputs.group.splice($index, 1)"
                                class="smss-btn--icon"
                                ><i class="fa fa-trash-o"></i
                            ></smss-btn>
                        </td>
                    </tr>
                </table>
                <smss-btn
                    class="smss-btn--outline"
                    ng-click="form.inputs.group.push({'data': '', 'type': ''})"
                    >Add Field</smss-btn
                >
            </div>
            <div
                ng-if="form.tempComponent.id.indexOf('form-submit') > -1"
                ng-init="form.setPixelHelper()"
            >
                <div class="form-builder__helper">
                    <smss-field class="form-builder__helper__list">
                        <label> Select action: </label>
                        <content>
                            <div
                                ng-repeat="item in form.pixelHelpers.options[form.pixelHelpers.selected].list track by $index"
                            >
                                <div
                                    class="form-builder__helper__list__items"
                                    ng-class="{'form-builder__helper__list__items--selected':($index === form.pixelHelpers.options[form.pixelHelpers.selected].selected)}"
                                    ng-click="form.pixelHelpers.options[form.pixelHelpers.selected].selected = $index"
                                >
                                    {{item.name}}
                                </div>
                            </div>
                        </content>
                    </smss-field>
                    <div
                        ng-repeat="item in form.pixelHelpers.options[form.pixelHelpers.selected].list track by $index"
                        ng-if="$index === form.pixelHelpers.options[form.pixelHelpers.selected].selected"
                        class="form-builder__helper__steps"
                    >
                        <div
                            dynamic="item.steps.list[item.steps.selected].html"
                        ></div>
                    </div>
                </div>
            </div>
        </smss-overlay-body>
        <smss-overlay-footer>
            <div ng-show="form.tempComponent.id.indexOf('form-submit') === -1">
                <smss-btn class="smss-btn--text" ng-click="form.closeInput()"
                    >Cancel</smss-btn
                >
                <smss-btn ng-click="form.processInput()">Add</smss-btn>
            </div>

            <div ng-if="form.tempComponent.id.indexOf('form-submit') > -1">
                <div
                    ng-repeat="item in form.pixelHelpers.options[form.pixelHelpers.selected].list track by $index"
                    ng-if="$index === form.pixelHelpers.options[form.pixelHelpers.selected].selected"
                >
                    <smss-btn
                        class="smss-btn--text"
                        ng-if="item.steps.selected !== 0"
                        ng-click="form.navigateHelper('back')"
                    >
                        Back
                    </smss-btn>
                    <smss-btn
                        ng-if="item.steps.selected !== item.steps.list.length - 1"
                        ng-click="form.navigateHelper('next')"
                    >
                        Next
                    </smss-btn>
                    <smss-btn
                        ng-if="item.steps.selected === item.steps.list.length - 1"
                        ng-click="form.processInput()"
                    >
                        Add
                    </smss-btn>
                </div>
            </div>
        </smss-overlay-footer>
    </smss-overlay>

    <smss-overlay open="form.variableBinding.show">
        <smss-overlay-header>
            <div
                ng-if="form.variableBinding.type === 'data' && !form.tempPixel.type"
            >
                Data Variables
            </div>
            <div
                ng-if="form.variableBinding.type === 'pixel' && !form.tempPixel.type"
            >
                Pixel Variables
            </div>
            <div ng-if="form.tempPixel.type === 'data' && form.tempPixel.isNew">
                Add Data Variable
            </div>
            <div
                ng-if="form.tempPixel.type === 'pixel' && form.tempPixel.isNew"
            >
                Add Pixel Variable
            </div>
            <div
                ng-if="form.tempPixel.type === 'data' && !form.tempPixel.isNew"
            >
                Edit Data Variable
            </div>
            <div
                ng-if="form.tempPixel.type === 'pixel' && !form.tempPixel.isNew"
            >
                Edit Pixel Variable
            </div>
        </smss-overlay-header>
        <smss-overlay-body>
            <div ng-if="form.variableBinding.type === 'data'">
                <div ng-show="!form.tempPixel.type">
                    <div class="form-builder__binding__search">
                        <smss-search
                            model="form.dataVariableSearch"
                            placeholder="Search variables..."
                            ng-disabled="form.dataVariableList.length === 0"
                        ></smss-search>
                        <smss-btn
                            class="smss-btn--outline"
                            ng-click="form.tempPixel.type = 'data'; form.tempPixel.isNew = true; form.showManualOptions = false; form.showValuePixel = false"
                        >
                            Add Variable
                        </smss-btn>
                    </div>
                    <div
                        ng-show="form.dataVariableList.length > 0"
                        class="form-builder__component__overlay__data-binding"
                    >
                        <table>
                            <tr>
                                <th title="Variable Name">Variable Name</th>
                                <th title="Data">Data</th>
                                <th class="smss--icon" title="Edit"></th>
                                <th class="smss--icon" title="Delete"></th>
                            </tr>
                            <tr
                                ng-repeat="variable in form.dataVariableList | filter: form.dataVariableSearch"
                                ng-init="tempSelected = variable.selected"
                            >
                                <td>{{variable.name}}</td>
                                <td>
                                    <smss-dropdown
                                        model="tempSelected"
                                        placeholder="Select an option"
                                        options="variable.options"
                                    >
                                    </smss-dropdown>
                                </td>
                                <td>
                                    <smss-btn
                                        class="smss-btn--icon"
                                        ng-click="form.editDataBinding(variable);"
                                    >
                                        <i class="fa fa-edit"></i>
                                    </smss-btn>
                                </td>
                                <td>
                                    <smss-btn
                                        class="smss-btn--icon"
                                        ng-click="form.deleteDataBinding(variable);"
                                    >
                                        <i class="fa fa-trash-o"></i>
                                    </smss-btn>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div
                        ng-show="!form.dataVariableList || form.dataVariableList.length === 0"
                        class="smss-caption--center"
                    >
                        No data bindings are currently available.
                    </div>
                </div>
            </div>
            <div ng-if="form.variableBinding.type === 'pixel'">
                <div ng-show="!form.tempPixel.type">
                    <div class="form-builder__binding__search">
                        <smss-btn
                            class="smss-btn--outline"
                            ng-click="form.tempPixel.type = 'pixel'; form.tempPixel.isNew = true;"
                        >
                            Add Variable
                        </smss-btn>
                    </div>
                    <div ng-show="form.pixelVariableList.length > 0">
                        <table>
                            <tr>
                                <th>Variable Name</th>
                                <th>Pixel</th>
                                <th class="smss--icon" title="Edit">Edit</th>
                                <th class="smss--icon" title="Delete">
                                    Delete
                                </th>
                            </tr>
                            <tr ng-repeat="variable in form.pixelVariableList">
                                <td>{{variable.name}}</td>
                                <td class="form-builder__binding__select">
                                    {{variable.pixel}}
                                </td>
                                <td>
                                    <smss-btn
                                        class="smss-btn--icon"
                                        ng-click="form.editPixelBinding(variable);"
                                    >
                                        <i class="fa fa-edit"></i>
                                    </smss-btn>
                                </td>
                                <td>
                                    <smss-btn
                                        class="smss-btn--icon"
                                        ng-click="form.deletePixelBinding(variable);"
                                    >
                                        <i class="fa fa-trash-o"></i>
                                    </smss-btn>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div
                        ng-show="!form.pixelVariableList || form.pixelVariableList.length === 0"
                        class="smss-caption--center"
                    >
                        No pixel bindings are currently available.
                    </div>
                </div>
            </div>
            <div ng-show="form.tempPixel.type">
                <smss-field>
                    <label> Name: </label>
                    <description>
                        *Do not use special characters or begin with a number.
                    </description>
                    <content>
                        <smss-input
                            ng-model="form.tempPixel.name"
                            ng-change="form.cleanBindingName(form.tempPixel)"
                        ></smss-input>
                    </content>
                </smss-field>
                <div
                    class="smss-spacing"
                    ng-show="form.tempPixel.type === 'data'"
                >
                    <smss-checkbox
                        model="form.showManualOptions"
                        change="form.tempPixel.pixel = ''; form.tempPixel.manualOptions = ''; form.tempPixel.dependsOn = []"
                    >
                        Set Manual Options
                    </smss-checkbox>
                </div>
                <div
                    class="smss-spacing"
                    ng-show="form.tempPixel.type === 'data'"
                >
                    <smss-checkbox
                        model="form.showValuePixel"
                        change="form.tempPixel.valuePixel = ''; form.tempPixel.defaultValue = '';"
                    >
                        Set Default Value Pixel
                    </smss-checkbox>
                </div>
                <div
                    class="smss-spacing"
                    ng-show="form.tempPixel.type === 'data'"
                >
                    <smss-checkbox model="form.tempPixel.autoPopulate">
                        Auto Populate
                    </smss-checkbox>
                </div>
                <div
                    class="smss-spacing"
                    ng-show="form.tempPixel.type === 'data' && form.dataModel[form.tempPixel.name] && form.dataModel[form.tempPixel.name].config.table"
                >
                    <smss-checkbox model="form.tempPixel.useFullList">
                        Use Full List
                    </smss-checkbox>
                </div>
                <smss-field ng-show="!form.showManualOptions">
                    <label> Pixel: </label>
                    <content>
                        <smss-textarea
                            ng-model="form.tempPixel.pixel"
                            style="resize: vertical"
                        ></smss-textarea>
                    </content>
                </smss-field>
                <smss-field
                    ng-show="form.showValuePixel && form.tempPixel.type === 'data'"
                >
                    <label> Value Pixel: </label>
                    <content>
                        <smss-textarea
                            ng-model="form.tempPixel.valuePixel"
                            style="resize: vertical"
                        ></smss-textarea>
                    </content>
                </smss-field>
                <smss-field
                    ng-show="form.showManualOptions && form.tempPixel.type === 'data'"
                >
                    <label>
                        Manual Options:
                        <i
                            title="Enter comma separated values."
                            class="fa fa-info-circle"
                        ></i>
                    </label>
                    <content>
                        <smss-input
                            ng-model="form.tempPixel.manualOptions"
                        ></smss-input>
                    </content>
                </smss-field>
                <smss-field
                    ng-show="form.tempPixel.type === 'data' && !form.showValuePixel"
                >
                    <label> Set a default value: </label>
                    <content>
                        <smss-input
                            ng-model="form.tempPixel.defaultValue"
                        ></smss-input>
                    </content>
                </smss-field>
                <smss-field
                    ng-show="(!form.showManualOptions || form.showValuePixel) && form.tempPixel.type === 'data'"
                    ng-show="form.tempPixel.type === 'data' && form.dataVariableList.length > 0"
                >
                    <label> Select Dependencies: </label>
                    <content>
                        <smss-checklist
                            options="form.dataVariableList"
                            class="form-builder__list-height"
                            display="name"
                            value="name"
                            model="form.tempPixel.dependsOn"
                            multiple
                        >
                        </smss-checklist>
                    </content>
                </smss-field>
            </div>
        </smss-overlay-body>
        <smss-overlay-footer>
            <div ng-if="form.tempPixel.type">
                <smss-btn
                    class="smss-btn--text"
                    ng-click="form.exitEditBinding()"
                >
                    Cancel
                </smss-btn>
                <smss-btn ng-click="form.addBinding(form.tempPixel);">
                    <span ng-if="form.tempPixel.isNew">Add</span>
                    <span ng-if="!form.tempPixel.isNew">Update</span>
                </smss-btn>
            </div>
        </smss-overlay-footer>
    </smss-overlay>

    <smss-overlay
        class="form-builder__preview"
        open="form.showPreview"
        ng-if="form.showPreview"
        size="lg"
    >
        <smss-overlay-header>Preview</smss-overlay-header>
        <smss-overlay-body>
            <form-builder json="form.previewJSON" mode="preview">
                <form-loader></form-loader>
            </form-builder>
        </smss-overlay-body>
    </smss-overlay>

    <!-- <smss-btn ng-click="form.toggleSource()"
              title="Toggle Source"
              class="form-builder__generate">
        <i class="fa fa-code"></i>
    </smss-btn> -->
</div>
<!-- placeholder needed as testing ground to traverse the nodes from source code -->
<div id="form-builder__placeholder"></div>
<div class="form-loader" ng-if="form.mode !== 'build'">
    <form-loader json="form.loaderJSON"></form-loader>
</div>
